{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DanielGarc\\xEDaCarabelo\\\\Downloads\\\\pag web boda 2.0\\\\html\\\\webreact\\\\src\\\\components\\\\Game.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\n\n// Juego moderno: pareja camino a la iglesia, con narrativa cada 30s\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Game() {\n  _s();\n  const containerRef = useRef(null);\n  const canvasRef = useRef(null);\n\n  // Estado principal\n  const [status, setStatus] = useState('menu'); // menu | intro | playing | paused | win | gameover\n  const [muted, setMuted] = useState(false);\n\n  // Configuración de juego\n  const GAME_DURATION = 300; // 5 min\n  const SCORE = useRef(0);\n  const TIMELEFT = useRef(GAME_DURATION);\n  const INTRO_SHOWN = useRef(false);\n\n  // Intro estilo Star Wars\n  const INTRO = useRef({\n    offset: 320,\n    speed: 40,\n    // más lento para una intro más larga\n    lines: ['En una galaxia muy, muy cercana...', 'Dos estrellas destinadas a unirse brillan con fuerza.', 'El gran día ha llegado y todos esperan en la iglesia.', 'Ayuda a la pareja a llegar a tiempo sorteando obstáculos...', 'Controles: ↑ o ESPACIO para saltar, ↓ para agacharte o caer rápido.', 'Pulsa P para pausar. R para reiniciar.', '¡Que la fuerza del amor te acompañe!']\n  });\n\n  // Momentos clave (cada 30s)\n  const STORY_MOMENTS = useRef([{\n    text: 'Ana y Dani en la Facultad de Derecho de la USC 🏛️',\n    timeStart: 0\n  }, {\n    text: 'Ana preparando las oposiciones para Jueza ⚖️',\n    timeStart: 30\n  }, {\n    text: 'Dani cursando el Máster de Abogacía 📖',\n    timeStart: 60\n  }, {\n    text: 'Dani empezando a trabajar como abogado 💼',\n    timeStart: 90\n  }, {\n    text: 'Dani trabajando en Porriño 🏢',\n    timeStart: 120\n  }, {\n    text: 'Dani mudándose a Carballiño 🏠',\n    timeStart: 150\n  }, {\n    text: 'Ana trabajando en Ponteareas 🏛️',\n    timeStart: 180\n  }, {\n    text: 'Ana aprobando la oposición en Pontevedra 🎉',\n    timeStart: 210\n  }, {\n    text: 'Ana y Dani viviendo juntos en Pontevedra 💕',\n    timeStart: 240\n  }, {\n    text: 'La pedida en la Torre de Hércules 💍',\n    timeStart: 270\n  }, {\n    text: '¡Y hoy... la boda! 👰💒🤵',\n    timeStart: 300\n  }]);\n\n  // Narrativa actual con banner animado\n  const STORY = useRef({\n    index: -1,\n    bannerText: '',\n    bannerAlpha: 0,\n    bannerTimer: 0\n  });\n  const [currentStoryMoment, setCurrentStoryMoment] = useState(null);\n  // Buffers para optimizar render de textos/gradientes\n  const BUFFERS = useRef({\n    width: 0,\n    height: 0,\n    text: '',\n    watermark: null,\n    banner: null\n  });\n  // Capas prerenderizadas para parallax\n  const LAYERS = useRef({\n    width: 0,\n    height: 0,\n    city: null,\n    hills: null\n  });\n\n  // Reconstruir buffers de watermark y banner cuando cambie el texto o el tamaño\n  const rebuildStoryBuffers = text => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const width = canvas.width,\n      height = canvas.height;\n    const sameSize = BUFFERS.current.width === width && BUFFERS.current.height === height;\n    const sameText = BUFFERS.current.text === text;\n    if (sameSize && sameText && BUFFERS.current.watermark && BUFFERS.current.banner) return;\n    BUFFERS.current.width = width;\n    BUFFERS.current.height = height;\n    BUFFERS.current.text = text;\n\n    // Watermark prerender\n    const wm = document.createElement('canvas');\n    wm.width = width;\n    wm.height = height;\n    const wctx = wm.getContext('2d');\n    wctx.globalAlpha = 0.12;\n    const gradient = wctx.createRadialGradient(width / 2, height / 2, 0, width / 2, height / 2, width * 0.9);\n    gradient.addColorStop(0, '#fbbf24');\n    gradient.addColorStop(0.5, '#f59e0b');\n    gradient.addColorStop(1, 'transparent');\n    wctx.fillStyle = gradient;\n    wctx.fillRect(0, 0, width, height);\n    wctx.globalAlpha = 0.22;\n    wctx.fillStyle = '#92400e';\n    wctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n    wctx.textAlign = 'center';\n    wctx.textBaseline = 'middle';\n    const lines = wrapText(wctx, text, width * 0.7);\n    const lh = 40;\n    const sy = height / 2 - (lines.length - 1) * lh / 2;\n    for (let i = 0; i < lines.length; i++) wctx.fillText(lines[i], width / 2, sy + i * lh);\n    BUFFERS.current.watermark = wm;\n\n    // Banner prerender\n    const pad = 12;\n    wctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n    const fullText = '💕 ' + text + ' 💕';\n    const textW = wctx.measureText(fullText).width;\n    const boxW = Math.min(width - 24, textW + pad * 2 + 40);\n    const boxH = 42;\n    const bn = document.createElement('canvas');\n    bn.width = Math.ceil(boxW);\n    bn.height = boxH;\n    const bctx = bn.getContext('2d');\n    bctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\n    roundRect(bctx, 0, 0, boxW, boxH, 10);\n    bctx.fill();\n    bctx.strokeStyle = '#d97706';\n    bctx.lineWidth = 2;\n    bctx.stroke();\n    bctx.fillStyle = '#92400e';\n    bctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n    bctx.textAlign = 'center';\n    bctx.textBaseline = 'middle';\n    bctx.fillText(fullText, boxW / 2, boxH / 2);\n    BUFFERS.current.banner = bn;\n  };\n\n  // Prerender de capas city/hills para parallax\n  const rebuildParallaxLayers = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const width = canvas.width,\n      height = canvas.height;\n    if (LAYERS.current.width === width && LAYERS.current.height === height && LAYERS.current.city && LAYERS.current.hills) return;\n    LAYERS.current.width = width;\n    LAYERS.current.height = height;\n\n    // City layer\n    const city = document.createElement('canvas');\n    city.width = width + 200;\n    city.height = height;\n    const cctx = city.getContext('2d');\n    cctx.fillStyle = '#c7d2fe';\n    const baseY = 180;\n    const steps = Math.ceil((city.width + 200) / 90);\n    for (let i = 0; i < steps; i++) {\n      const w = 40 + i % 3 * 10;\n      const h = 30 + i % 5 * 18;\n      const x = -100 + i * 90;\n      roundRect(cctx, x, baseY - h, w, h, 4);\n      cctx.fill();\n    }\n    LAYERS.current.city = city;\n\n    // Hills layer\n    const hills = document.createElement('canvas');\n    hills.width = width + 300;\n    hills.height = height;\n    const hctx = hills.getContext('2d');\n    hctx.fillStyle = '#93c5fd';\n    const hSteps = Math.ceil((hills.width + 300) / 260);\n    for (let i = 0; i < hSteps; i++) {\n      const x = -150 + i * 260;\n      hctx.beginPath();\n      hctx.ellipse(x, 220, 180, 36, 0, 0, Math.PI * 2);\n      hctx.fill();\n    }\n    LAYERS.current.hills = hills;\n  };\n\n  // Redibujar buffers al redimensionar\n  useEffect(() => {\n    const onResize = () => {\n      const txt = currentStoryMoment || STORY_MOMENTS.current[0].text;\n      rebuildStoryBuffers(txt);\n      // forzar rebuild de layers\n      LAYERS.current.width = 0;\n      LAYERS.current.height = 0;\n      rebuildParallaxLayers();\n    };\n    window.addEventListener('resize', onResize);\n    onResize();\n    return () => window.removeEventListener('resize', onResize);\n  }, [currentStoryMoment]);\n\n  // Reset limpio\n  const resetWorld = () => {\n    SCORE.current = 0;\n    TIMELEFT.current = GAME_DURATION;\n    STORY.current = {\n      index: -1,\n      bannerText: '',\n      bannerAlpha: 0,\n      bannerTimer: 0\n    };\n    setCurrentStoryMoment(null);\n    const w = WORLD.current;\n    w.worldX = 0;\n    w.lastTs = 0;\n    w.startTs = 0;\n    w.speed = 240;\n    w.spawnInterval = 1.3;\n    w.spawnTimer = 0.8;\n    w.obstacles = [];\n    w.parallax.skyShift = 0;\n    w.parallax.cityShift = 0;\n    w.parallax.hillShift = 0;\n    w.player = {\n      x: 100,\n      y: w.groundY - 48,\n      w: 70,\n      h: 48,\n      vy: 0,\n      onGround: true,\n      crouching: false\n    };\n  };\n  useEffect(() => {\n    resetWorld();\n    INTRO.current.offset = 320;\n  }, []);\n\n  // Bucle de juego\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    let rafId;\n    const loop = ts => {\n      const w = WORLD.current;\n      if (!w.lastTs) {\n        w.lastTs = ts;\n        if (!w.startTs && status === 'playing') w.startTs = ts;\n      }\n      const dt = Math.min(0.032, (ts - w.lastTs) / 1000);\n      w.lastTs = ts;\n      update(dt, ts);\n      render(ctx, canvas);\n      rafId = requestAnimationFrame(loop);\n    };\n    rafId = requestAnimationFrame(loop);\n    return () => cancelAnimationFrame(rafId);\n  }, [status]);\n\n  // Reiniciar intro al entrar\n  useEffect(() => {\n    if (status === 'intro') INTRO.current.offset = 320;\n  }, [status]);\n\n  // Entradas\n  useEffect(() => {\n    const onKeyDown = e => {\n      if (e.repeat) return;\n      if ((e.code === 'Space' || e.code === 'ArrowUp') && status === 'playing') jump();\n      if (e.code === 'ArrowDown' && status === 'playing') crouch(true);\n      if (e.code === 'KeyR' && (status === 'playing' || status === 'gameover' || status === 'win' || status === 'paused')) {\n        resetWorld();\n        setStatus('menu');\n      }\n      if (e.code === 'KeyP' && (status === 'playing' || status === 'paused')) togglePause();\n      if (e.code === 'Enter' && status === 'menu') handlePlayFullscreen();\n      if (e.code === 'Enter' && status === 'intro') startPlaying();\n    };\n    const onKeyUp = e => {\n      if (e.code === 'ArrowDown') crouch(false);\n    };\n    window.addEventListener('keydown', onKeyDown);\n    window.addEventListener('keyup', onKeyUp);\n    return () => {\n      window.removeEventListener('keydown', onKeyDown);\n      window.removeEventListener('keyup', onKeyUp);\n    };\n  }, [status]);\n  const togglePause = () => {\n    if (status === 'playing') setStatus('paused');else if (status === 'paused') setStatus('playing');\n  };\n  const jump = () => {\n    const p = WORLD.current.player;\n    if (p.onGround) {\n      p.vy = -WORLD.current.jumpV;\n      p.onGround = false;\n    }\n  };\n  const crouch = on => {\n    const p = WORLD.current.player;\n    if (on) {\n      if (!p.onGround) p.vy += WORLD.current.fastFallBoost * 0.04; // caída rápida\n      else if (!p.crouching) {\n        p.crouching = true;\n        const prevBottom = p.y + p.h;\n        p.h = 32; // reducir un poco la altura\n        p.y = prevBottom - p.h;\n      }\n    } else if (p.crouching) {\n      const prevBottom = p.y + p.h;\n      p.h = 48;\n      p.y = prevBottom - p.h;\n      p.crouching = false;\n    }\n  };\n  const handlePlayFullscreen = async () => {\n    try {\n      var _containerRef$current;\n      if ((_containerRef$current = containerRef.current) !== null && _containerRef$current !== void 0 && _containerRef$current.requestFullscreen) await containerRef.current.requestFullscreen();\n    } catch {}\n    resetWorld();\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) {\n      audioEl.currentTime = 0;\n      audioEl.play();\n      audioEl.muted = muted;\n    }\n    if (!INTRO_SHOWN.current) {\n      setStatus('intro');\n      INTRO_SHOWN.current = true;\n    } else {\n      startPlaying();\n    }\n  };\n  const startPlaying = () => {\n    const w = WORLD.current;\n    w.lastTs = 0;\n    w.startTs = 0;\n    // Mostrar primer momento inmediatamente\n    STORY.current.index = 0;\n    STORY.current.bannerText = STORY_MOMENTS.current[0].text;\n    STORY.current.bannerTimer = 4.2; // mostrar 4.2s\n    STORY.current.bannerAlpha = 0; // animar fade-in\n    setCurrentStoryMoment(STORY.current.bannerText);\n    // construir buffers y capas\n    rebuildStoryBuffers(STORY.current.bannerText);\n    rebuildParallaxLayers();\n    setStatus('playing');\n  };\n  const handleRetry = () => {\n    resetWorld();\n    setCurrentStoryMoment(null);\n    startPlaying();\n  };\n  const update = (dt, ts) => {\n    const w = WORLD.current;\n    if (status === 'menu') return;\n    if (status === 'intro') {\n      INTRO.current.offset -= INTRO.current.speed * dt;\n      if (INTRO.current.offset < -140) startPlaying();\n      return;\n    }\n    if (status === 'paused') return;\n    if (status !== 'playing') return;\n\n    // Tiempo de juego\n    if (w.startTs === 0) w.startTs = ts;\n    const elapsed = (ts - w.startTs) / 1000;\n    const remaining = Math.max(0, GAME_DURATION - elapsed);\n    TIMELEFT.current = remaining;\n\n    // Narrativa basada en tiempo -> índice\n    const maxIndex = STORY_MOMENTS.current.length - 1;\n    const idx = Math.min(Math.floor(elapsed / 30), maxIndex);\n    if (idx !== STORY.current.index) {\n      STORY.current.index = idx;\n      STORY.current.bannerText = STORY_MOMENTS.current[idx].text;\n      STORY.current.bannerTimer = 4.2;\n      setCurrentStoryMoment(STORY.current.bannerText);\n      // reconstruir buffers en cada cambio de momento\n      rebuildStoryBuffers(STORY.current.bannerText);\n    }\n\n    // Animación del banner (fade in/out)\n    if (STORY.current.bannerTimer > 0) {\n      STORY.current.bannerTimer -= dt;\n      STORY.current.bannerAlpha = Math.min(1, STORY.current.bannerAlpha + dt * 3);\n    } else {\n      STORY.current.bannerAlpha = Math.max(0, STORY.current.bannerAlpha - dt * 2);\n    }\n    if (remaining <= 0.01) {\n      setStatus('win');\n      return;\n    }\n\n    // Progresión de dificultad\n    const tFactor = Math.min(1, elapsed / GAME_DURATION);\n    w.speed = 240 + (w.maxSpeed - 240) * tFactor;\n    w.spawnInterval = 1.3 - 0.8 * tFactor;\n\n    // Parallax scrolling\n    w.parallax.skyShift += w.speed * 0.08 * dt;\n    w.parallax.cityShift += w.speed * 0.25 * dt;\n    w.parallax.hillShift += w.speed * 0.45 * dt;\n\n    // Avance mundo\n    w.worldX += w.speed * dt;\n\n    // Física jugador\n    const p = w.player;\n    p.vy += w.gravity * dt;\n    p.y += p.vy * dt;\n    const groundY = w.groundY - p.h;\n    if (p.y >= groundY) {\n      p.y = groundY;\n      p.vy = 0;\n      p.onGround = true;\n    } else {\n      p.onGround = false;\n    }\n\n    // Spawn obstáculos\n    w.spawnTimer -= dt;\n    if (w.spawnTimer <= 0) {\n      spawnObstacle(w);\n      w.spawnTimer = w.spawnInterval * (0.9 + Math.random() * 0.4);\n    }\n\n    // Colisiones + puntuación\n    for (const o of w.obstacles) {\n      const sx = o.x - w.worldX + p.x;\n      o.screenX = sx;\n      if (!o.scored && sx + o.w < p.x) {\n        o.scored = true;\n        SCORE.current += 100;\n      }\n      const collide = rectOverlap(p.x, p.y, p.w, p.h, sx, o.y, o.w, o.h);\n      if (collide) {\n        setStatus('gameover');\n        break;\n      }\n    }\n\n    // Limpiar\n    w.obstacles = w.obstacles.filter(o => o.screenX > -140);\n    SCORE.current += Math.floor(w.speed * dt * 0.6);\n  };\n  const render = (ctx, canvas) => {\n    const w = WORLD.current;\n    const p = w.player;\n\n    // Asegurar capas\n    rebuildParallaxLayers();\n\n    // Fondo\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    if (status === 'intro') {\n      drawIntroBackground(ctx, canvas);\n      drawIntro(ctx, canvas, INTRO.current.lines, INTRO.current.offset);\n      drawSkipHint(ctx, canvas, 'Pulsa Enter para saltar');\n      return;\n    }\n\n    // Cielo (gradiente + nubes suaves)\n    drawSky(ctx, canvas, w.parallax.skyShift);\n    // Colinas y ciudad desde capas (tiled)\n    if (LAYERS.current.hills) drawLayerTiled(ctx, LAYERS.current.hills, w.parallax.hillShift);\n    if (LAYERS.current.city) drawLayerTiled(ctx, LAYERS.current.city, w.parallax.cityShift);\n\n    // Marca de agua narrativa sutil\n    const momentText = currentStoryMoment || STORY_MOMENTS.current[0].text;\n    if (BUFFERS.current.watermark) ctx.drawImage(BUFFERS.current.watermark, 0, 0);else drawStoryWatermark(ctx, canvas, momentText);\n\n    // Suelo\n    ctx.fillStyle = '#bfe3ff';\n    ctx.fillRect(0, w.groundY + 12, canvas.width, 4);\n\n    // Obstáculos\n    for (const o of w.obstacles) {\n      if (o.screenX < -80 || o.screenX > canvas.width + 120) continue;\n      if (o.type === 'low') drawObstacleLow(ctx, o.screenX, o.y, o.w, o.h);else drawObstacleHigh(ctx, o.screenX, o.y, o.w, o.h);\n    }\n\n    // Pareja (sticker conjunto)\n    drawCouple(ctx, p.x, p.y, p.w, p.h, !p.onGround, p.crouching);\n\n    // HUD\n    drawHUD(ctx, canvas, {\n      score: SCORE.current,\n      time: TIMELEFT.current,\n      status\n    });\n\n    // Banner de momento especial (animado)\n    if (STORY.current.bannerAlpha > 0) {\n      if (BUFFERS.current.banner) {\n        ctx.save();\n        ctx.globalAlpha = STORY.current.bannerAlpha;\n        const bx = (canvas.width - BUFFERS.current.banner.width) / 2;\n        const by = 6;\n        ctx.drawImage(BUFFERS.current.banner, bx, by);\n        ctx.restore();\n      } else {\n        drawStoryBanner(ctx, canvas, momentText, STORY.current.bannerAlpha);\n      }\n    }\n    if (status === 'paused') {\n      drawOverlay(ctx, canvas, 'Pausa ⏸', 'Pulsa P para continuar');\n      return;\n    }\n    if (status === 'gameover') {\n      drawOverlay(ctx, canvas, '¡Ups! Te has tropezado', 'Pulsa R para volver al menú');\n    } else if (status === 'win') {\n      drawOverlay(ctx, canvas, '¡Llegaste a tiempo! 💒', `Puntuación: ${Math.floor(SCORE.current)} · Pulsa R para menú`);\n    }\n  };\n  const toggleMute = () => {\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) {\n      audioEl.muted = !audioEl.muted;\n      setMuted(audioEl.muted);\n    } else setMuted(m => !m);\n  };\n  useEffect(() => () => {\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) audioEl.pause();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    style: {\n      maxWidth: 980,\n      margin: '0 auto',\n      padding: '1rem',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        textAlign: 'center',\n        marginBottom: '.5rem'\n      },\n      children: \"Camino a la iglesia\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 469,\n      columnNumber: 7\n    }, this), status === 'menu' && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        inset: 0,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'linear-gradient(135deg, rgba(255,255,255,.95), rgba(238,242,255,.95))',\n        zIndex: 5,\n        borderRadius: 12\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 'min(92%, 620px)',\n          padding: '1.25rem',\n          borderRadius: 12,\n          boxShadow: '0 8px 28px rgba(0,0,0,.18)',\n          background: 'white'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            marginTop: 0,\n            textAlign: 'center'\n          },\n          children: \"\\xA1Acompa\\xF1a a Ana y Dani!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: 'center',\n            color: '#64748b',\n            marginTop: 4\n          },\n          children: \"Esquiva obst\\xE1culos durante 5 minutos. La historia de la pareja aparecer\\xE1 como momentos especiales cada 30s.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '1rem',\n            justifyContent: 'center',\n            marginTop: '1rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handlePlayFullscreen,\n            style: primaryBtn,\n            children: \"\\u25B6 Jugar en pantalla completa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              resetWorld();\n              startPlaying();\n            },\n            style: secondaryBtn,\n            children: \"\\u25B7 Jugar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 480,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 473,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        borderRadius: 12,\n        overflow: 'hidden',\n        boxShadow: '0 6px 24px rgba(0,0,0,.12)',\n        background: 'white',\n        position: 'relative'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n        id: \"bg-music\",\n        src: \"/musica-boda.mp3\",\n        loop: true,\n        autoPlay: false,\n        style: {\n          display: 'none'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleMute,\n        \"aria-label\": muted ? 'Activar sonido' : 'Silenciar sonido',\n        style: {\n          position: 'absolute',\n          right: 8,\n          top: 8,\n          zIndex: 8,\n          background: 'rgba(0,0,0,.55)',\n          color: '#fff',\n          border: 0,\n          borderRadius: 999,\n          width: 36,\n          height: 36,\n          cursor: 'pointer'\n        },\n        children: muted ? '🔇' : '🔊'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 9\n      }, this), (status === 'playing' || status === 'paused') && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: togglePause,\n        style: {\n          position: 'absolute',\n          right: 52,\n          top: 8,\n          zIndex: 8,\n          background: 'rgba(0,0,0,.55)',\n          color: '#fff',\n          border: 0,\n          borderRadius: 999,\n          width: 36,\n          height: 36,\n          cursor: 'pointer'\n        },\n        children: status === 'paused' ? '▶' : '⏸'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 11\n      }, this), status === 'intro' && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startPlaying,\n        style: {\n          position: 'absolute',\n          right: 8,\n          bottom: 8,\n          zIndex: 8,\n          background: 'rgba(0,0,0,.55)',\n          color: '#fff',\n          border: 0,\n          borderRadius: 8,\n          padding: '.4rem .6rem',\n          cursor: 'pointer'\n        },\n        children: \"Saltar intro\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 493,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: 900,\n        height: 280,\n        style: {\n          width: '100%',\n          display: 'block',\n          background: status === 'intro' ? '#000' : 'linear-gradient(#eef2ff, #fff)'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 9\n      }, this), status === 'playing' && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          inset: 'auto 0 0 0',\n          display: 'flex',\n          justifyContent: 'space-between',\n          padding: '8px 10px',\n          pointerEvents: 'none'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onMouseDown: jump,\n          onTouchStart: jump,\n          style: touchBtn,\n          children: \"\\u2B9D Saltar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onMouseDown: () => crouch(true),\n          onMouseUp: () => crouch(false),\n          onTouchStart: () => crouch(true),\n          onTouchEnd: () => crouch(false),\n          style: touchBtn,\n          children: \"\\u2B9F Agachar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 11\n      }, this), (status === 'gameover' || status === 'win') && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          inset: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 7\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: 'rgba(17,24,39,.88)',\n            color: '#fff',\n            padding: '1rem 1.25rem',\n            borderRadius: 12,\n            boxShadow: '0 8px 28px rgba(0,0,0,.35)',\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: 700,\n              fontSize: 18,\n              marginBottom: 8\n            },\n            children: status === 'win' ? '¡Llegaste a tiempo! 💒' : '¡Ups! Te has tropezado'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: 14,\n              opacity: .9,\n              marginBottom: 12\n            },\n            children: [\"Puntuaci\\xF3n: \", Math.floor(SCORE.current)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleRetry,\n            style: {\n              background: '#22c55e',\n              color: '#0b1a0f',\n              border: 0,\n              padding: '.5rem 1rem',\n              borderRadius: 10,\n              fontWeight: 700,\n              cursor: 'pointer'\n            },\n            children: \"\\u21BB Reintentar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 486,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 468,\n    columnNumber: 5\n  }, this);\n}\n\n// Estilos de botones\n_s(Game, \"odvvUUiMi1h0FK2sTSjnFCS6noc=\");\n_c = Game;\nconst primaryBtn = {\n  background: 'linear-gradient(135deg, #6366f1, #8b5cf6)',\n  color: 'white',\n  border: 0,\n  padding: '.75rem 1.25rem',\n  borderRadius: 10,\n  fontWeight: 700,\n  cursor: 'pointer',\n  boxShadow: '0 6px 18px rgba(99,102,241,.35)'\n};\nconst secondaryBtn = {\n  background: '#111827',\n  color: 'white',\n  border: 0,\n  padding: '.75rem 1.25rem',\n  borderRadius: 10,\n  fontWeight: 700,\n  cursor: 'pointer'\n};\nconst touchBtn = {\n  pointerEvents: 'auto',\n  background: 'rgba(0,0,0,.55)',\n  color: '#fff',\n  border: 0,\n  borderRadius: 10,\n  padding: '.5rem .75rem',\n  fontWeight: 700\n};\n\n// Utilidades\nfunction rectOverlap(ax, ay, aw, ah, bx, by, bw, bh) {\n  return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;\n}\nfunction formatTime(t) {\n  const s = Math.max(0, Math.floor(t));\n  const mm = String(Math.floor(s / 60)).padStart(2, '0');\n  const ss = String(s % 60).padStart(2, '0');\n  return `${mm}:${ss}`;\n}\nfunction wrapText(ctx, text, maxWidth) {\n  const words = text.split(' ');\n  let lines = [],\n    current = '';\n  for (const w of words) {\n    const test = current ? current + ' ' + w : w;\n    if (ctx.measureText(test).width > maxWidth && current) {\n      lines.push(current);\n      current = w;\n    } else current = test;\n  }\n  if (current) lines.push(current);\n  return lines;\n}\nfunction spawnObstacle(w) {\n  const type = Math.random() < 0.55 ? 'low' : 'high';\n  if (type === 'low') {\n    const width = 28 + Math.random() * 18;\n    const height = 22 + Math.random() * 22;\n    const x = w.worldX + 900 + Math.random() * 120;\n    const y = w.groundY - height;\n    w.obstacles.push({\n      type,\n      x,\n      y,\n      w: width,\n      h: height,\n      scored: false,\n      screenX: 0\n    });\n  } else {\n    const width = 84 + Math.random() * 70;\n    const height = 18;\n    const x = w.worldX + 900 + Math.random() * 120;\n    const y = w.groundY - (48 + 12);\n    w.obstacles.push({\n      type,\n      x,\n      y,\n      w: width,\n      h: height,\n      scored: false,\n      screenX: 0\n    });\n  }\n}\n\n// Dibujo UI\nfunction drawHUD(ctx, canvas, {\n  score,\n  time,\n  status\n}) {\n  ctx.save();\n  // Barra superior\n  ctx.globalAlpha = 0.9;\n  ctx.fillStyle = 'rgba(255,255,255,0.9)';\n  roundRect(ctx, 8, 8, canvas.width - 16, 34, 8);\n  ctx.fill();\n\n  // Puntuación\n  ctx.fillStyle = '#334155';\n  ctx.font = 'bold 12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'left';\n  ctx.fillText(`Puntos: ${Math.floor(score)}`, 16, 30);\n\n  // Tiempo restante + barra\n  ctx.textAlign = 'right';\n  ctx.fillText(`Tiempo: ${formatTime(time)}`, canvas.width - 16, 30);\n  const pct = Math.max(0, Math.min(1, time / 300));\n  const barW = (canvas.width - 16) * pct;\n  ctx.globalAlpha = 1;\n  ctx.fillStyle = '#22c55e';\n  roundRect(ctx, 8, 46, barW, 6, 3);\n  ctx.fill();\n  ctx.restore();\n}\nfunction drawIntroBackground(ctx, canvas) {\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\n  g.addColorStop(0, '#000');\n  g.addColorStop(1, '#1f2937');\n  ctx.fillStyle = g;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n}\nfunction drawIntro(ctx, canvas, lines, offset) {\n  ctx.save();\n  ctx.fillStyle = '#10b981';\n  ctx.textAlign = 'center';\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  const centerX = canvas.width / 2;\n  let y = canvas.height + offset;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const scale = 1 - i * 0.05;\n    ctx.save();\n    ctx.translate(centerX, y);\n    ctx.scale(scale, scale);\n    ctx.fillText(line, 0, 0);\n    ctx.restore();\n    y += 36;\n  }\n  ctx.restore();\n}\nfunction drawSkipHint(ctx, canvas, text) {\n  ctx.save();\n  ctx.fillStyle = 'rgba(255,255,255,0.2)';\n  roundRect(ctx, canvas.width - 165, canvas.height - 36, 156, 26, 8);\n  ctx.fill();\n  ctx.fillStyle = '#e5e7eb';\n  ctx.font = '12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'right';\n  ctx.fillText(text, canvas.width - 12, canvas.height - 18);\n  ctx.restore();\n}\nfunction drawSky(ctx, canvas, shift) {\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\n  g.addColorStop(0, '#e8f0ff');\n  g.addColorStop(1, '#ffffff');\n  ctx.fillStyle = g;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  // nubes suaves\n  ctx.save();\n  ctx.globalAlpha = 0.25;\n  ctx.fillStyle = '#ffffff';\n  for (let i = 0; i < 6; i++) {\n    const x = (i * 180 - shift * 0.3 % (canvas.width + 200) + canvas.width + 200) % (canvas.width + 200) - 100;\n    ctx.beginPath();\n    ctx.ellipse(x, 60 + i % 2 * 18, 70, 20, 0, 0, Math.PI * 2);\n    ctx.fill();\n  }\n  ctx.restore();\n}\nfunction drawCity(ctx, canvas, shift) {/* deprecated by prerendered layers */}\nfunction drawHills(ctx, canvas, shift) {/* deprecated by prerendered layers */}\nfunction drawLayerTiled(ctx, layerCanvas, shift) {\n  const w = layerCanvas.width;\n  let offset = -(shift % w);\n  if (offset > 0) offset -= w;\n  ctx.drawImage(layerCanvas, offset, 0);\n  ctx.drawImage(layerCanvas, offset + w, 0);\n}\nfunction drawObstacleLow(ctx, x, y, w, h) {\n  ctx.save();\n  ctx.fillStyle = '#94a3b8';\n  ctx.strokeStyle = '#475569';\n  ctx.lineWidth = 2;\n  roundRect(ctx, x, y, w, h, 6);\n  ctx.fill();\n  ctx.stroke();\n  ctx.restore();\n}\nfunction drawObstacleHigh(ctx, x, y, w, h) {\n  ctx.save();\n  ctx.fillStyle = '#9ca3af';\n  roundRect(ctx, x, y + h - 30, 4, 30, 2);\n  roundRect(ctx, x + w - 4, y + h - 30, 4, 30, 2);\n  ctx.fill();\n  ctx.fillStyle = '#22c55e';\n  roundRect(ctx, x, y, w, h, 6);\n  ctx.fill();\n  ctx.restore();\n}\n\n// Sticker conjunto: novio + novia cogidos de la mano\nfunction drawCouple(ctx, x, y, w, h, jumping, crouching) {\n  ctx.save();\n  // Sombra\n  if (jumping) {\n    ctx.globalAlpha = 0.2;\n    ctx.fillStyle = '#000';\n    ctx.beginPath();\n    ctx.ellipse(x + w * 0.5, y + h + 10, w * 0.7, 5, 0, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.globalAlpha = 1;\n  }\n\n  // Novia (izquierda)\n  const nx = x - 16;\n  const ny = y;\n  const nw = Math.floor(w * 0.48);\n  const nh = h;\n  ctx.fillStyle = '#f8fafc';\n  roundRect(ctx, nx - 2, ny + nh * 0.35, nw + 4, nh * 0.65, 10); // vestido\n  ctx.fill();\n  ctx.fillStyle = '#e5e7eb';\n  roundRect(ctx, nx, ny, nw, nh * 0.45, 8); // torso\n  ctx.fill();\n  ctx.fillStyle = '#fde68a';\n  ctx.beginPath();\n  ctx.arc(nx + nw / 2, crouching ? ny - 4 : ny - 6, 10, 0, Math.PI * 2); // cabeza\n  ctx.fill();\n  // velo\n  ctx.globalAlpha = 0.6;\n  ctx.fillStyle = '#e0f2fe';\n  roundRect(ctx, nx - 6, ny - 6, nw + 12, 16, 8);\n  ctx.fill();\n  ctx.globalAlpha = 1;\n\n  // Novio (derecha)\n  const gx = x + nw - 4;\n  const gy = y;\n  const gw = Math.floor(w * 0.52);\n  const gh = h;\n  ctx.fillStyle = '#1f2937';\n  roundRect(ctx, gx, gy, gw, gh, 8);\n  ctx.fill(); // traje\n  ctx.fillStyle = '#fde68a';\n  ctx.beginPath();\n  ctx.arc(gx + gw / 2, crouching ? gy - 4 : gy - 6, 10, 0, Math.PI * 2);\n  ctx.fill(); // cabeza\n  ctx.fillStyle = '#ef4444';\n  ctx.fillRect(gx + gw / 2 - 3, gy + 10, 6, 10); // corbata\n\n  // Manos unidas (corazón pequeño)\n  ctx.fillStyle = '#ef4444';\n  ctx.beginPath();\n  const mx = gx - 4;\n  const my = y + h * 0.48;\n  ctx.arc(mx - 3, my, 3, 0, Math.PI * 2);\n  ctx.arc(mx + 3, my, 3, 0, Math.PI * 2);\n  ctx.moveTo(mx - 6, my);\n  ctx.lineTo(mx, my + 6);\n  ctx.lineTo(mx + 6, my);\n  ctx.fill();\n  ctx.restore();\n}\nfunction drawStoryWatermark(ctx, canvas, momentText) {\n  ctx.save();\n  ctx.globalAlpha = 0.12;\n  const gradient = ctx.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width * 0.9);\n  gradient.addColorStop(0, '#fbbf24');\n  gradient.addColorStop(0.5, '#f59e0b');\n  gradient.addColorStop(1, 'transparent');\n  ctx.fillStyle = gradient;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  // Texto grande sutil\n  ctx.globalAlpha = 0.22;\n  ctx.fillStyle = '#92400e';\n  ctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  const words = momentText.split(' ');\n  let lines = [];\n  let currentLine = '';\n  for (const word of words) {\n    const test = currentLine + (currentLine ? ' ' : '') + word;\n    if (ctx.measureText(test).width > canvas.width * 0.7 && currentLine) {\n      lines.push(currentLine);\n      currentLine = word;\n    } else currentLine = test;\n  }\n  if (currentLine) lines.push(currentLine);\n  const lineHeight = 40;\n  const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;\n  for (let i = 0; i < lines.length; i++) ctx.fillText(lines[i], canvas.width / 2, startY + i * lineHeight);\n  ctx.restore();\n}\nfunction drawStoryBanner(ctx, canvas, text, alpha) {\n  ctx.save();\n  ctx.globalAlpha = Math.max(0, Math.min(1, alpha));\n  ctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\n  const padding = 12;\n  ctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  const textW = ctx.measureText(text).width;\n  const boxW = Math.min(canvas.width - 24, textW + padding * 2 + 40);\n  const boxH = 42;\n  const boxX = (canvas.width - boxW) / 2;\n  const boxY = 6; // elevado\n  roundRect(ctx, boxX, boxY, boxW, boxH, 10);\n  ctx.fill();\n  ctx.strokeStyle = '#d97706';\n  ctx.lineWidth = 2;\n  ctx.stroke();\n  ctx.fillStyle = '#92400e';\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.fillText('💕 ' + text + ' 💕', canvas.width / 2, boxY + boxH / 2);\n  ctx.restore();\n}\nfunction drawOverlay(ctx, canvas, title, subtitle) {\n  ctx.save();\n  ctx.fillStyle = 'rgba(0,0,0,0.45)';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = '#fff';\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.fillText(title, canvas.width / 2, canvas.height / 2 - 6);\n  ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.fillText(subtitle, canvas.width / 2, canvas.height / 2 + 18);\n  ctx.restore();\n}\nfunction roundRect(ctx, x, y, w, h, r) {\n  ctx.beginPath();\n  ctx.moveTo(x + r, y);\n  ctx.arcTo(x + w, y, x + w, y + h, r);\n  ctx.arcTo(x + w, y + h, x, y + h, r);\n  ctx.arcTo(x, y + h, x, y, r);\n  ctx.arcTo(x, y, x + w, y, r);\n  ctx.closePath();\n}\nvar _c;\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","Game","_s","containerRef","canvasRef","status","setStatus","muted","setMuted","GAME_DURATION","SCORE","TIMELEFT","INTRO_SHOWN","INTRO","offset","speed","lines","STORY_MOMENTS","text","timeStart","STORY","index","bannerText","bannerAlpha","bannerTimer","currentStoryMoment","setCurrentStoryMoment","BUFFERS","width","height","watermark","banner","LAYERS","city","hills","rebuildStoryBuffers","canvas","current","sameSize","sameText","wm","document","createElement","wctx","getContext","globalAlpha","gradient","createRadialGradient","addColorStop","fillStyle","fillRect","font","textAlign","textBaseline","wrapText","lh","sy","length","i","fillText","pad","fullText","textW","measureText","boxW","Math","min","boxH","bn","ceil","bctx","roundRect","fill","strokeStyle","lineWidth","stroke","rebuildParallaxLayers","cctx","baseY","steps","w","h","x","hctx","hSteps","beginPath","ellipse","PI","onResize","txt","window","addEventListener","removeEventListener","resetWorld","WORLD","worldX","lastTs","startTs","spawnInterval","spawnTimer","obstacles","parallax","skyShift","cityShift","hillShift","player","y","groundY","vy","onGround","crouching","ctx","rafId","loop","ts","dt","update","render","requestAnimationFrame","cancelAnimationFrame","onKeyDown","e","repeat","code","jump","crouch","togglePause","handlePlayFullscreen","startPlaying","onKeyUp","p","jumpV","on","fastFallBoost","prevBottom","_containerRef$current","requestFullscreen","audioEl","getElementById","currentTime","play","handleRetry","elapsed","remaining","max","maxIndex","idx","floor","tFactor","maxSpeed","gravity","spawnObstacle","random","o","sx","screenX","scored","collide","rectOverlap","filter","clearRect","drawIntroBackground","drawIntro","drawSkipHint","drawSky","drawLayerTiled","momentText","drawImage","drawStoryWatermark","type","drawObstacleLow","drawObstacleHigh","drawCouple","drawHUD","score","time","save","bx","by","restore","drawStoryBanner","drawOverlay","toggleMute","m","pause","ref","style","maxWidth","margin","padding","position","children","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","inset","display","alignItems","justifyContent","background","zIndex","borderRadius","boxShadow","marginTop","color","gap","onClick","primaryBtn","secondaryBtn","overflow","id","src","autoPlay","right","top","border","cursor","bottom","pointerEvents","onMouseDown","onTouchStart","touchBtn","onMouseUp","onTouchEnd","fontWeight","fontSize","opacity","_c","ax","ay","aw","ah","bw","bh","formatTime","t","s","mm","String","padStart","ss","words","split","test","push","pct","barW","g","createLinearGradient","centerX","line","scale","translate","shift","drawCity","drawHills","layerCanvas","jumping","nx","ny","nw","nh","arc","gx","gy","gw","gh","mx","my","moveTo","lineTo","currentLine","word","lineHeight","startY","alpha","boxX","boxY","title","subtitle","r","arcTo","closePath","$RefreshReg$"],"sources":["C:/Users/DanielGarcíaCarabelo/Downloads/pag web boda 2.0/html/webreact/src/components/Game.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\n\r\n// Juego moderno: pareja camino a la iglesia, con narrativa cada 30s\r\nexport default function Game() {\r\n  const containerRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n\r\n  // Estado principal\r\n  const [status, setStatus] = useState('menu'); // menu | intro | playing | paused | win | gameover\r\n  const [muted, setMuted] = useState(false);\r\n\r\n  // Configuración de juego\r\n  const GAME_DURATION = 300; // 5 min\r\n  const SCORE = useRef(0);\r\n  const TIMELEFT = useRef(GAME_DURATION);\r\n  const INTRO_SHOWN = useRef(false);\r\n\r\n  // Intro estilo Star Wars\r\n  const INTRO = useRef({\r\n    offset: 320,\r\n    speed: 40, // más lento para una intro más larga\r\n    lines: [\r\n      'En una galaxia muy, muy cercana...',\r\n      'Dos estrellas destinadas a unirse brillan con fuerza.',\r\n      'El gran día ha llegado y todos esperan en la iglesia.',\r\n      'Ayuda a la pareja a llegar a tiempo sorteando obstáculos...',\r\n      'Controles: ↑ o ESPACIO para saltar, ↓ para agacharte o caer rápido.',\r\n      'Pulsa P para pausar. R para reiniciar.',\r\n      '¡Que la fuerza del amor te acompañe!'\r\n    ]\r\n  });\r\n\r\n  // Momentos clave (cada 30s)\r\n  const STORY_MOMENTS = useRef([\r\n    { text: 'Ana y Dani en la Facultad de Derecho de la USC 🏛️', timeStart: 0 },\r\n    { text: 'Ana preparando las oposiciones para Jueza ⚖️', timeStart: 30 },\r\n    { text: 'Dani cursando el Máster de Abogacía 📖', timeStart: 60 },\r\n    { text: 'Dani empezando a trabajar como abogado 💼', timeStart: 90 },\r\n    { text: 'Dani trabajando en Porriño 🏢', timeStart: 120 },\r\n    { text: 'Dani mudándose a Carballiño 🏠', timeStart: 150 },\r\n    { text: 'Ana trabajando en Ponteareas 🏛️', timeStart: 180 },\r\n    { text: 'Ana aprobando la oposición en Pontevedra 🎉', timeStart: 210 },\r\n    { text: 'Ana y Dani viviendo juntos en Pontevedra 💕', timeStart: 240 },\r\n    { text: 'La pedida en la Torre de Hércules 💍', timeStart: 270 },\r\n    { text: '¡Y hoy... la boda! 👰💒🤵', timeStart: 300 }\r\n  ]);\r\n\r\n  // Narrativa actual con banner animado\r\n  const STORY = useRef({ index: -1, bannerText: '', bannerAlpha: 0, bannerTimer: 0 });\r\n  const [currentStoryMoment, setCurrentStoryMoment] = useState(null);\r\n  // Buffers para optimizar render de textos/gradientes\r\n  const BUFFERS = useRef({ width: 0, height: 0, text: '', watermark: null, banner: null });\r\n  // Capas prerenderizadas para parallax\r\n  const LAYERS = useRef({ width: 0, height: 0, city: null, hills: null });\r\n\r\n  // Reconstruir buffers de watermark y banner cuando cambie el texto o el tamaño\r\n  const rebuildStoryBuffers = (text) => {\r\n    const canvas = canvasRef.current; if (!canvas) return;\r\n    const width = canvas.width, height = canvas.height;\r\n    const sameSize = BUFFERS.current.width === width && BUFFERS.current.height === height;\r\n    const sameText = BUFFERS.current.text === text;\r\n    if (sameSize && sameText && BUFFERS.current.watermark && BUFFERS.current.banner) return;\r\n\r\n    BUFFERS.current.width = width; BUFFERS.current.height = height; BUFFERS.current.text = text;\r\n\r\n    // Watermark prerender\r\n    const wm = document.createElement('canvas'); wm.width = width; wm.height = height;\r\n    const wctx = wm.getContext('2d');\r\n    wctx.globalAlpha = 0.12;\r\n    const gradient = wctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, width*0.9);\r\n    gradient.addColorStop(0, '#fbbf24'); gradient.addColorStop(0.5, '#f59e0b'); gradient.addColorStop(1, 'transparent');\r\n    wctx.fillStyle = gradient; wctx.fillRect(0,0,width,height);\r\n    wctx.globalAlpha = 0.22; wctx.fillStyle = '#92400e';\r\n    wctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n    wctx.textAlign = 'center'; wctx.textBaseline = 'middle';\r\n    const lines = wrapText(wctx, text, width * 0.7);\r\n    const lh = 40; const sy = height/2 - (lines.length - 1) * lh / 2;\r\n    for (let i = 0; i < lines.length; i++) wctx.fillText(lines[i], width/2, sy + i * lh);\r\n    BUFFERS.current.watermark = wm;\r\n\r\n    // Banner prerender\r\n    const pad = 12;\r\n    wctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n    const fullText = '💕 ' + text + ' 💕';\r\n    const textW = wctx.measureText(fullText).width;\r\n    const boxW = Math.min(width - 24, textW + pad * 2 + 40);\r\n    const boxH = 42;\r\n    const bn = document.createElement('canvas'); bn.width = Math.ceil(boxW); bn.height = boxH;\r\n    const bctx = bn.getContext('2d');\r\n    bctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\r\n    roundRect(bctx, 0, 0, boxW, boxH, 10); bctx.fill();\r\n    bctx.strokeStyle = '#d97706'; bctx.lineWidth = 2; bctx.stroke();\r\n    bctx.fillStyle = '#92400e';\r\n    bctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n    bctx.textAlign = 'center'; bctx.textBaseline = 'middle';\r\n    bctx.fillText(fullText, boxW / 2, boxH / 2);\r\n    BUFFERS.current.banner = bn;\r\n  };\r\n\r\n  // Prerender de capas city/hills para parallax\r\n  const rebuildParallaxLayers = () => {\r\n    const canvas = canvasRef.current; if (!canvas) return;\r\n    const width = canvas.width, height = canvas.height;\r\n    if (LAYERS.current.width === width && LAYERS.current.height === height && LAYERS.current.city && LAYERS.current.hills) return;\r\n    LAYERS.current.width = width; LAYERS.current.height = height;\r\n\r\n    // City layer\r\n    const city = document.createElement('canvas');\r\n    city.width = width + 200; city.height = height;\r\n    const cctx = city.getContext('2d');\r\n    cctx.fillStyle = '#c7d2fe';\r\n    const baseY = 180;\r\n    const steps = Math.ceil((city.width + 200) / 90);\r\n    for (let i = 0; i < steps; i++) {\r\n      const w = 40 + (i % 3) * 10;\r\n      const h = 30 + (i % 5) * 18;\r\n      const x = -100 + i * 90;\r\n      roundRect(cctx, x, baseY - h, w, h, 4);\r\n      cctx.fill();\r\n    }\r\n    LAYERS.current.city = city;\r\n\r\n    // Hills layer\r\n    const hills = document.createElement('canvas');\r\n    hills.width = width + 300; hills.height = height;\r\n    const hctx = hills.getContext('2d');\r\n    hctx.fillStyle = '#93c5fd';\r\n    const hSteps = Math.ceil((hills.width + 300) / 260);\r\n    for (let i = 0; i < hSteps; i++) {\r\n      const x = -150 + i * 260;\r\n      hctx.beginPath();\r\n      hctx.ellipse(x, 220, 180, 36, 0, 0, Math.PI * 2);\r\n      hctx.fill();\r\n    }\r\n    LAYERS.current.hills = hills;\r\n  };\r\n\r\n  // Redibujar buffers al redimensionar\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      const txt = currentStoryMoment || STORY_MOMENTS.current[0].text;\r\n      rebuildStoryBuffers(txt);\r\n      // forzar rebuild de layers\r\n      LAYERS.current.width = 0; LAYERS.current.height = 0;\r\n      rebuildParallaxLayers();\r\n    };\r\n    window.addEventListener('resize', onResize);\r\n    onResize();\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, [currentStoryMoment]);\r\n\r\n  // Reset limpio\r\n  const resetWorld = () => {\r\n    SCORE.current = 0;\r\n    TIMELEFT.current = GAME_DURATION;\r\n    STORY.current = { index: -1, bannerText: '', bannerAlpha: 0, bannerTimer: 0 };\r\n    setCurrentStoryMoment(null);\r\n\r\n    const w = WORLD.current;\r\n    w.worldX = 0;\r\n    w.lastTs = 0;\r\n    w.startTs = 0;\r\n    w.speed = 240;\r\n    w.spawnInterval = 1.3;\r\n    w.spawnTimer = 0.8;\r\n    w.obstacles = [];\r\n    w.parallax.skyShift = 0;\r\n    w.parallax.cityShift = 0;\r\n    w.parallax.hillShift = 0;\r\n    w.player = { x: 100, y: w.groundY - 48, w: 70, h: 48, vy: 0, onGround: true, crouching: false };\r\n  };\r\n\r\n  useEffect(() => {\r\n    resetWorld();\r\n    INTRO.current.offset = 320;\r\n  }, []);\r\n\r\n  // Bucle de juego\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    let rafId;\r\n    const loop = (ts) => {\r\n      const w = WORLD.current;\r\n      if (!w.lastTs) {\r\n        w.lastTs = ts;\r\n        if (!w.startTs && status === 'playing') w.startTs = ts;\r\n      }\r\n      const dt = Math.min(0.032, (ts - w.lastTs) / 1000);\r\n      w.lastTs = ts;\r\n\r\n      update(dt, ts);\r\n      render(ctx, canvas);\r\n      rafId = requestAnimationFrame(loop);\r\n    };\r\n\r\n    rafId = requestAnimationFrame(loop);\r\n    return () => cancelAnimationFrame(rafId);\r\n  }, [status]);\r\n\r\n  // Reiniciar intro al entrar\r\n  useEffect(() => {\r\n    if (status === 'intro') INTRO.current.offset = 320;\r\n  }, [status]);\r\n\r\n  // Entradas\r\n  useEffect(() => {\r\n    const onKeyDown = (e) => {\r\n      if (e.repeat) return;\r\n      if ((e.code === 'Space' || e.code === 'ArrowUp') && status === 'playing') jump();\r\n      if (e.code === 'ArrowDown' && status === 'playing') crouch(true);\r\n      if (e.code === 'KeyR' && (status === 'playing' || status === 'gameover' || status === 'win' || status === 'paused')) {\r\n        resetWorld();\r\n        setStatus('menu');\r\n      }\r\n      if (e.code === 'KeyP' && (status === 'playing' || status === 'paused')) togglePause();\r\n      if (e.code === 'Enter' && status === 'menu') handlePlayFullscreen();\r\n      if (e.code === 'Enter' && status === 'intro') startPlaying();\r\n    };\r\n    const onKeyUp = (e) => {\r\n      if (e.code === 'ArrowDown') crouch(false);\r\n    };\r\n\r\n    window.addEventListener('keydown', onKeyDown);\r\n    window.addEventListener('keyup', onKeyUp);\r\n    return () => {\r\n      window.removeEventListener('keydown', onKeyDown);\r\n      window.removeEventListener('keyup', onKeyUp);\r\n    };\r\n  }, [status]);\r\n\r\n  const togglePause = () => {\r\n    if (status === 'playing') setStatus('paused');\r\n    else if (status === 'paused') setStatus('playing');\r\n  };\r\n\r\n  const jump = () => {\r\n    const p = WORLD.current.player;\r\n    if (p.onGround) {\r\n      p.vy = -WORLD.current.jumpV;\r\n      p.onGround = false;\r\n    }\r\n  };\r\n\r\n  const crouch = (on) => {\r\n    const p = WORLD.current.player;\r\n    if (on) {\r\n      if (!p.onGround) p.vy += WORLD.current.fastFallBoost * 0.04; // caída rápida\r\n      else if (!p.crouching) {\r\n        p.crouching = true;\r\n        const prevBottom = p.y + p.h;\r\n        p.h = 32; // reducir un poco la altura\r\n        p.y = prevBottom - p.h;\r\n      }\r\n    } else if (p.crouching) {\r\n      const prevBottom = p.y + p.h;\r\n      p.h = 48;\r\n      p.y = prevBottom - p.h;\r\n      p.crouching = false;\r\n    }\r\n  };\r\n\r\n  const handlePlayFullscreen = async () => {\r\n    try { if (containerRef.current?.requestFullscreen) await containerRef.current.requestFullscreen(); } catch {}\r\n    resetWorld();\r\n\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) { audioEl.currentTime = 0; audioEl.play(); audioEl.muted = muted; }\r\n\r\n    if (!INTRO_SHOWN.current) { setStatus('intro'); INTRO_SHOWN.current = true; }\r\n    else { startPlaying(); }\r\n  };\r\n\r\n  const startPlaying = () => {\r\n    const w = WORLD.current;\r\n    w.lastTs = 0;\r\n    w.startTs = 0;\r\n    // Mostrar primer momento inmediatamente\r\n    STORY.current.index = 0;\r\n    STORY.current.bannerText = STORY_MOMENTS.current[0].text;\r\n    STORY.current.bannerTimer = 4.2; // mostrar 4.2s\r\n    STORY.current.bannerAlpha = 0; // animar fade-in\r\n    setCurrentStoryMoment(STORY.current.bannerText);\r\n    // construir buffers y capas\r\n    rebuildStoryBuffers(STORY.current.bannerText);\r\n    rebuildParallaxLayers();\r\n    setStatus('playing');\r\n  };\r\n\r\n  const handleRetry = () => {\r\n    resetWorld();\r\n    setCurrentStoryMoment(null);\r\n    startPlaying();\r\n  };\r\n\r\n  const update = (dt, ts) => {\r\n    const w = WORLD.current;\r\n\r\n    if (status === 'menu') return;\r\n\r\n    if (status === 'intro') {\r\n      INTRO.current.offset -= INTRO.current.speed * dt;\r\n      if (INTRO.current.offset < -140) startPlaying();\r\n      return;\r\n    }\r\n\r\n    if (status === 'paused') return;\r\n    if (status !== 'playing') return;\r\n\r\n    // Tiempo de juego\r\n    if (w.startTs === 0) w.startTs = ts;\r\n    const elapsed = (ts - w.startTs) / 1000;\r\n    const remaining = Math.max(0, GAME_DURATION - elapsed);\r\n    TIMELEFT.current = remaining;\r\n\r\n    // Narrativa basada en tiempo -> índice\r\n    const maxIndex = STORY_MOMENTS.current.length - 1;\r\n    const idx = Math.min(Math.floor(elapsed / 30), maxIndex);\r\n    if (idx !== STORY.current.index) {\r\n      STORY.current.index = idx;\r\n      STORY.current.bannerText = STORY_MOMENTS.current[idx].text;\r\n      STORY.current.bannerTimer = 4.2;\r\n      setCurrentStoryMoment(STORY.current.bannerText);\r\n      // reconstruir buffers en cada cambio de momento\r\n      rebuildStoryBuffers(STORY.current.bannerText);\r\n    }\r\n\r\n    // Animación del banner (fade in/out)\r\n    if (STORY.current.bannerTimer > 0) {\r\n      STORY.current.bannerTimer -= dt;\r\n      STORY.current.bannerAlpha = Math.min(1, STORY.current.bannerAlpha + dt * 3);\r\n    } else {\r\n      STORY.current.bannerAlpha = Math.max(0, STORY.current.bannerAlpha - dt * 2);\r\n    }\r\n\r\n    if (remaining <= 0.01) { setStatus('win'); return; }\r\n\r\n    // Progresión de dificultad\r\n    const tFactor = Math.min(1, elapsed / GAME_DURATION);\r\n    w.speed = 240 + (w.maxSpeed - 240) * tFactor;\r\n    w.spawnInterval = 1.3 - 0.8 * tFactor;\r\n\r\n    // Parallax scrolling\r\n    w.parallax.skyShift += w.speed * 0.08 * dt;\r\n    w.parallax.cityShift += w.speed * 0.25 * dt;\r\n    w.parallax.hillShift += w.speed * 0.45 * dt;\r\n\r\n    // Avance mundo\r\n    w.worldX += w.speed * dt;\r\n\r\n    // Física jugador\r\n    const p = w.player;\r\n    p.vy += w.gravity * dt;\r\n    p.y += p.vy * dt;\r\n    const groundY = w.groundY - p.h;\r\n    if (p.y >= groundY) { p.y = groundY; p.vy = 0; p.onGround = true; } else { p.onGround = false; }\r\n\r\n    // Spawn obstáculos\r\n    w.spawnTimer -= dt;\r\n    if (w.spawnTimer <= 0) {\r\n      spawnObstacle(w);\r\n      w.spawnTimer = w.spawnInterval * (0.9 + Math.random() * 0.4);\r\n    }\r\n\r\n    // Colisiones + puntuación\r\n    for (const o of w.obstacles) {\r\n      const sx = o.x - w.worldX + p.x;\r\n      o.screenX = sx;\r\n      if (!o.scored && sx + o.w < p.x) { o.scored = true; SCORE.current += 100; }\r\n      const collide = rectOverlap(p.x, p.y, p.w, p.h, sx, o.y, o.w, o.h);\r\n      if (collide) { setStatus('gameover'); break; }\r\n    }\r\n\r\n    // Limpiar\r\n    w.obstacles = w.obstacles.filter((o) => o.screenX > -140);\r\n    SCORE.current += Math.floor(w.speed * dt * 0.6);\r\n  };\r\n\r\n  const render = (ctx, canvas) => {\r\n    const w = WORLD.current;\r\n    const p = w.player;\r\n\r\n    // Asegurar capas\r\n    rebuildParallaxLayers();\r\n\r\n    // Fondo\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    if (status === 'intro') {\r\n      drawIntroBackground(ctx, canvas);\r\n      drawIntro(ctx, canvas, INTRO.current.lines, INTRO.current.offset);\r\n      drawSkipHint(ctx, canvas, 'Pulsa Enter para saltar');\r\n      return;\r\n    }\r\n\r\n    // Cielo (gradiente + nubes suaves)\r\n    drawSky(ctx, canvas, w.parallax.skyShift);\r\n    // Colinas y ciudad desde capas (tiled)\r\n    if (LAYERS.current.hills) drawLayerTiled(ctx, LAYERS.current.hills, w.parallax.hillShift);\r\n    if (LAYERS.current.city) drawLayerTiled(ctx, LAYERS.current.city, w.parallax.cityShift);\r\n\r\n    // Marca de agua narrativa sutil\r\n    const momentText = currentStoryMoment || STORY_MOMENTS.current[0].text;\r\n    if (BUFFERS.current.watermark) ctx.drawImage(BUFFERS.current.watermark, 0, 0);\r\n    else drawStoryWatermark(ctx, canvas, momentText);\r\n\r\n    // Suelo\r\n    ctx.fillStyle = '#bfe3ff';\r\n    ctx.fillRect(0, w.groundY + 12, canvas.width, 4);\r\n\r\n    // Obstáculos\r\n    for (const o of w.obstacles) {\r\n      if (o.screenX < -80 || o.screenX > canvas.width + 120) continue;\r\n      if (o.type === 'low') drawObstacleLow(ctx, o.screenX, o.y, o.w, o.h);\r\n      else drawObstacleHigh(ctx, o.screenX, o.y, o.w, o.h);\r\n    }\r\n\r\n    // Pareja (sticker conjunto)\r\n    drawCouple(ctx, p.x, p.y, p.w, p.h, !p.onGround, p.crouching);\r\n\r\n    // HUD\r\n    drawHUD(ctx, canvas, {\r\n      score: SCORE.current,\r\n      time: TIMELEFT.current,\r\n      status\r\n    });\r\n\r\n    // Banner de momento especial (animado)\r\n    if (STORY.current.bannerAlpha > 0) {\r\n      if (BUFFERS.current.banner) {\r\n        ctx.save();\r\n        ctx.globalAlpha = STORY.current.bannerAlpha;\r\n        const bx = (canvas.width - BUFFERS.current.banner.width) / 2;\r\n        const by = 6;\r\n        ctx.drawImage(BUFFERS.current.banner, bx, by);\r\n        ctx.restore();\r\n      } else {\r\n        drawStoryBanner(ctx, canvas, momentText, STORY.current.bannerAlpha);\r\n      }\r\n    }\r\n\r\n    if (status === 'paused') {\r\n      drawOverlay(ctx, canvas, 'Pausa ⏸', 'Pulsa P para continuar');\r\n      return;\r\n    }\r\n\r\n    if (status === 'gameover') {\r\n      drawOverlay(ctx, canvas, '¡Ups! Te has tropezado', 'Pulsa R para volver al menú');\r\n    } else if (status === 'win') {\r\n      drawOverlay(ctx, canvas, '¡Llegaste a tiempo! 💒', `Puntuación: ${Math.floor(SCORE.current)} · Pulsa R para menú`);\r\n    }\r\n  };\r\n\r\n  const toggleMute = () => {\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) { audioEl.muted = !audioEl.muted; setMuted(audioEl.muted); }\r\n    else setMuted((m) => !m);\r\n  };\r\n\r\n  useEffect(() => () => {\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) audioEl.pause();\r\n  }, []);\r\n\r\n  return (\r\n    <div ref={containerRef} style={{ maxWidth: 980, margin: '0 auto', padding: '1rem', position: 'relative' }}>\r\n      <h2 style={{ textAlign: 'center', marginBottom: '.5rem' }}>Camino a la iglesia</h2>\r\n\r\n      {status === 'menu' && (\r\n        <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', background: 'linear-gradient(135deg, rgba(255,255,255,.95), rgba(238,242,255,.95))', zIndex: 5, borderRadius: 12 }}>\r\n          <div style={{ width: 'min(92%, 620px)', padding: '1.25rem', borderRadius: 12, boxShadow: '0 8px 28px rgba(0,0,0,.18)', background: 'white' }}>\r\n            <h3 style={{ marginTop: 0, textAlign: 'center' }}>¡Acompaña a Ana y Dani!</h3>\r\n            <p style={{ textAlign: 'center', color: '#64748b', marginTop: 4 }}>\r\n              Esquiva obstáculos durante 5 minutos. La historia de la pareja aparecerá como momentos especiales cada 30s.\r\n            </p>\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center', marginTop: '1rem' }}>\r\n              <button onClick={handlePlayFullscreen} style={primaryBtn}>▶ Jugar en pantalla completa</button>\r\n              <button onClick={() => { resetWorld(); startPlaying(); }} style={secondaryBtn}>▷ Jugar</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div style={{ borderRadius: 12, overflow: 'hidden', boxShadow: '0 6px 24px rgba(0,0,0,.12)', background: 'white', position: 'relative' }}>\r\n        <audio id=\"bg-music\" src=\"/musica-boda.mp3\" loop autoPlay={false} style={{ display: 'none' }} />\r\n        <button onClick={toggleMute} aria-label={muted ? 'Activar sonido' : 'Silenciar sonido'} style={{ position: 'absolute', right: 8, top: 8, zIndex: 8, background: 'rgba(0,0,0,.55)', color: '#fff', border: 0, borderRadius: 999, width: 36, height: 36, cursor: 'pointer' }}>{muted ? '🔇' : '🔊'}</button>\r\n        {(status === 'playing' || status === 'paused') && (\r\n          <button onClick={togglePause} style={{ position: 'absolute', right: 52, top: 8, zIndex: 8, background: 'rgba(0,0,0,.55)', color: '#fff', border: 0, borderRadius: 999, width: 36, height: 36, cursor: 'pointer' }}>{status === 'paused' ? '▶' : '⏸'}</button>\r\n        )}\r\n        {status === 'intro' && (\r\n          <button onClick={startPlaying} style={{ position: 'absolute', right: 8, bottom: 8, zIndex: 8, background: 'rgba(0,0,0,.55)', color: '#fff', border: 0, borderRadius: 8, padding: '.4rem .6rem', cursor: 'pointer' }}>Saltar intro</button>\r\n        )}\r\n        <canvas ref={canvasRef} width={900} height={280} style={{ width: '100%', display: 'block', background: status === 'intro' ? '#000' : 'linear-gradient(#eef2ff, #fff)' }} />\r\n\r\n        {/* Controles táctiles */}\r\n        {status === 'playing' && (\r\n          <div style={{ position: 'absolute', inset: 'auto 0 0 0', display: 'flex', justifyContent: 'space-between', padding: '8px 10px', pointerEvents: 'none' }}>\r\n            <button onMouseDown={jump} onTouchStart={jump} style={touchBtn}>⮝ Saltar</button>\r\n            <button onMouseDown={() => crouch(true)} onMouseUp={() => crouch(false)} onTouchStart={() => crouch(true)} onTouchEnd={() => crouch(false)} style={touchBtn}>⮟ Agachar</button>\r\n          </div>\r\n        )}\r\n\r\n        {(status === 'gameover' || status === 'win') && (\r\n          <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 7 }}>\r\n            <div style={{ background: 'rgba(17,24,39,.88)', color: '#fff', padding: '1rem 1.25rem', borderRadius: 12, boxShadow: '0 8px 28px rgba(0,0,0,.35)', textAlign: 'center' }}>\r\n              <div style={{ fontWeight: 700, fontSize: 18, marginBottom: 8 }}>\r\n                {status === 'win' ? '¡Llegaste a tiempo! 💒' : '¡Ups! Te has tropezado'}\r\n              </div>\r\n              <div style={{ fontSize: 14, opacity: .9, marginBottom: 12 }}>\r\n                Puntuación: {Math.floor(SCORE.current)}\r\n              </div>\r\n              <button onClick={handleRetry} style={{ background: '#22c55e', color: '#0b1a0f', border: 0, padding: '.5rem 1rem', borderRadius: 10, fontWeight: 700, cursor: 'pointer' }}>↻ Reintentar</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Estilos de botones\r\nconst primaryBtn = {\r\n  background: 'linear-gradient(135deg, #6366f1, #8b5cf6)',\r\n  color: 'white', border: 0, padding: '.75rem 1.25rem',\r\n  borderRadius: 10, fontWeight: 700, cursor: 'pointer',\r\n  boxShadow: '0 6px 18px rgba(99,102,241,.35)'\r\n};\r\nconst secondaryBtn = {\r\n  background: '#111827', color: 'white', border: 0,\r\n  padding: '.75rem 1.25rem', borderRadius: 10,\r\n  fontWeight: 700, cursor: 'pointer'\r\n};\r\nconst touchBtn = {\r\n  pointerEvents: 'auto',\r\n  background: 'rgba(0,0,0,.55)', color: '#fff', border: 0,\r\n  borderRadius: 10, padding: '.5rem .75rem', fontWeight: 700\r\n};\r\n\r\n// Utilidades\r\nfunction rectOverlap(ax, ay, aw, ah, bx, by, bw, bh) {\r\n  return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;\r\n}\r\nfunction formatTime(t) {\r\n  const s = Math.max(0, Math.floor(t));\r\n  const mm = String(Math.floor(s / 60)).padStart(2, '0');\r\n  const ss = String(s % 60).padStart(2, '0');\r\n  return `${mm}:${ss}`;\r\n}\r\nfunction wrapText(ctx, text, maxWidth) {\r\n  const words = text.split(' ');\r\n  let lines = [], current = '';\r\n  for (const w of words) {\r\n    const test = current ? current + ' ' + w : w;\r\n    if (ctx.measureText(test).width > maxWidth && current) { lines.push(current); current = w; }\r\n    else current = test;\r\n  }\r\n  if (current) lines.push(current);\r\n  return lines;\r\n}\r\n\r\nfunction spawnObstacle(w) {\r\n  const type = Math.random() < 0.55 ? 'low' : 'high';\r\n  if (type === 'low') {\r\n    const width = 28 + Math.random() * 18;\r\n    const height = 22 + Math.random() * 22;\r\n    const x = w.worldX + 900 + Math.random() * 120;\r\n    const y = w.groundY - height;\r\n    w.obstacles.push({ type, x, y, w: width, h: height, scored: false, screenX: 0 });\r\n  } else {\r\n    const width = 84 + Math.random() * 70;\r\n    const height = 18;\r\n    const x = w.worldX + 900 + Math.random() * 120;\r\n    const y = w.groundY - (48 + 12);\r\n    w.obstacles.push({ type, x, y, w: width, h: height, scored: false, screenX: 0 });\r\n  }\r\n}\r\n\r\n// Dibujo UI\r\nfunction drawHUD(ctx, canvas, { score, time, status }) {\r\n  ctx.save();\r\n  // Barra superior\r\n  ctx.globalAlpha = 0.9;\r\n  ctx.fillStyle = 'rgba(255,255,255,0.9)';\r\n  roundRect(ctx, 8, 8, canvas.width - 16, 34, 8);\r\n  ctx.fill();\r\n\r\n  // Puntuación\r\n  ctx.fillStyle = '#334155';\r\n  ctx.font = 'bold 12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'left';\r\n  ctx.fillText(`Puntos: ${Math.floor(score)}`, 16, 30);\r\n\r\n  // Tiempo restante + barra\r\n  ctx.textAlign = 'right';\r\n  ctx.fillText(`Tiempo: ${formatTime(time)}`, canvas.width - 16, 30);\r\n  const pct = Math.max(0, Math.min(1, time / 300));\r\n  const barW = (canvas.width - 16) * pct;\r\n  ctx.globalAlpha = 1;\r\n  ctx.fillStyle = '#22c55e';\r\n  roundRect(ctx, 8, 46, barW, 6, 3);\r\n  ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawIntroBackground(ctx, canvas) {\r\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n  g.addColorStop(0, '#000');\r\n  g.addColorStop(1, '#1f2937');\r\n  ctx.fillStyle = g;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n}\r\n\r\nfunction drawIntro(ctx, canvas, lines, offset) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#10b981';\r\n  ctx.textAlign = 'center';\r\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  const centerX = canvas.width / 2;\r\n  let y = canvas.height + offset;\r\n  for (let i = 0; i < lines.length; i++) {\r\n    const line = lines[i];\r\n    const scale = 1 - i * 0.05;\r\n    ctx.save();\r\n    ctx.translate(centerX, y);\r\n    ctx.scale(scale, scale);\r\n    ctx.fillText(line, 0, 0);\r\n    ctx.restore();\r\n    y += 36;\r\n  }\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawSkipHint(ctx, canvas, text) {\r\n  ctx.save();\r\n  ctx.fillStyle = 'rgba(255,255,255,0.2)';\r\n  roundRect(ctx, canvas.width - 165, canvas.height - 36, 156, 26, 8);\r\n  ctx.fill();\r\n  ctx.fillStyle = '#e5e7eb';\r\n  ctx.font = '12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'right';\r\n  ctx.fillText(text, canvas.width - 12, canvas.height - 18);\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawSky(ctx, canvas, shift) {\r\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n  g.addColorStop(0, '#e8f0ff');\r\n  g.addColorStop(1, '#ffffff');\r\n  ctx.fillStyle = g;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  // nubes suaves\r\n  ctx.save();\r\n  ctx.globalAlpha = 0.25;\r\n  ctx.fillStyle = '#ffffff';\r\n  for (let i = 0; i < 6; i++) {\r\n    const x = ((i * 180 - (shift * 0.3) % (canvas.width + 200)) + canvas.width + 200) % (canvas.width + 200) - 100;\r\n    ctx.beginPath();\r\n    ctx.ellipse(x, 60 + (i % 2) * 18, 70, 20, 0, 0, Math.PI * 2);\r\n    ctx.fill();\r\n  }\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawCity(ctx, canvas, shift) { /* deprecated by prerendered layers */ }\r\n\r\nfunction drawHills(ctx, canvas, shift) { /* deprecated by prerendered layers */ }\r\n\r\nfunction drawLayerTiled(ctx, layerCanvas, shift) {\r\n  const w = layerCanvas.width;\r\n  let offset = - (shift % w);\r\n  if (offset > 0) offset -= w;\r\n  ctx.drawImage(layerCanvas, offset, 0);\r\n  ctx.drawImage(layerCanvas, offset + w, 0);\r\n}\r\n\r\nfunction drawObstacleLow(ctx, x, y, w, h) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#94a3b8';\r\n  ctx.strokeStyle = '#475569';\r\n  ctx.lineWidth = 2;\r\n  roundRect(ctx, x, y, w, h, 6);\r\n  ctx.fill();\r\n  ctx.stroke();\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawObstacleHigh(ctx, x, y, w, h) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#9ca3af';\r\n  roundRect(ctx, x, y + h - 30, 4, 30, 2);\r\n  roundRect(ctx, x + w - 4, y + h - 30, 4, 30, 2);\r\n  ctx.fill();\r\n  ctx.fillStyle = '#22c55e';\r\n  roundRect(ctx, x, y, w, h, 6);\r\n  ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\n// Sticker conjunto: novio + novia cogidos de la mano\r\nfunction drawCouple(ctx, x, y, w, h, jumping, crouching) {\r\n  ctx.save();\r\n  // Sombra\r\n  if (jumping) {\r\n    ctx.globalAlpha = 0.2;\r\n    ctx.fillStyle = '#000';\r\n    ctx.beginPath();\r\n    ctx.ellipse(x + w * 0.5, y + h + 10, w * 0.7, 5, 0, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.globalAlpha = 1;\r\n  }\r\n\r\n  // Novia (izquierda)\r\n  const nx = x - 16; const ny = y; const nw = Math.floor(w * 0.48); const nh = h;\r\n  ctx.fillStyle = '#f8fafc';\r\n  roundRect(ctx, nx - 2, ny + nh * 0.35, nw + 4, nh * 0.65, 10); // vestido\r\n  ctx.fill();\r\n  ctx.fillStyle = '#e5e7eb';\r\n  roundRect(ctx, nx, ny, nw, nh * 0.45, 8); // torso\r\n  ctx.fill();\r\n  ctx.fillStyle = '#fde68a';\r\n  ctx.beginPath();\r\n  ctx.arc(nx + nw / 2, crouching ? ny - 4 : ny - 6, 10, 0, Math.PI * 2); // cabeza\r\n  ctx.fill();\r\n  // velo\r\n  ctx.globalAlpha = 0.6; ctx.fillStyle = '#e0f2fe'; roundRect(ctx, nx - 6, ny - 6, nw + 12, 16, 8); ctx.fill(); ctx.globalAlpha = 1;\r\n\r\n  // Novio (derecha)\r\n  const gx = x + nw - 4; const gy = y; const gw = Math.floor(w * 0.52); const gh = h;\r\n  ctx.fillStyle = '#1f2937'; roundRect(ctx, gx, gy, gw, gh, 8); ctx.fill(); // traje\r\n  ctx.fillStyle = '#fde68a'; ctx.beginPath(); ctx.arc(gx + gw / 2, crouching ? gy - 4 : gy - 6, 10, 0, Math.PI * 2); ctx.fill(); // cabeza\r\n  ctx.fillStyle = '#ef4444'; ctx.fillRect(gx + gw / 2 - 3, gy + 10, 6, 10); // corbata\r\n\r\n  // Manos unidas (corazón pequeño)\r\n  ctx.fillStyle = '#ef4444';\r\n  ctx.beginPath();\r\n  const mx = gx - 4; const my = y + h * 0.48;\r\n  ctx.arc(mx - 3, my, 3, 0, Math.PI * 2);\r\n  ctx.arc(mx + 3, my, 3, 0, Math.PI * 2);\r\n  ctx.moveTo(mx - 6, my); ctx.lineTo(mx, my + 6); ctx.lineTo(mx + 6, my);\r\n  ctx.fill();\r\n\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawStoryWatermark(ctx, canvas, momentText) {\r\n  ctx.save();\r\n  ctx.globalAlpha = 0.12;\r\n  const gradient = ctx.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width * 0.9);\r\n  gradient.addColorStop(0, '#fbbf24');\r\n  gradient.addColorStop(0.5, '#f59e0b');\r\n  gradient.addColorStop(1, 'transparent');\r\n  ctx.fillStyle = gradient;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n  // Texto grande sutil\r\n  ctx.globalAlpha = 0.22;\r\n  ctx.fillStyle = '#92400e';\r\n  ctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n\r\n  const words = momentText.split(' ');\r\n  let lines = []; let currentLine = '';\r\n  for (const word of words) {\r\n    const test = currentLine + (currentLine ? ' ' : '') + word;\r\n    if (ctx.measureText(test).width > canvas.width * 0.7 && currentLine) { lines.push(currentLine); currentLine = word; }\r\n    else currentLine = test;\r\n  }\r\n  if (currentLine) lines.push(currentLine);\r\n\r\n  const lineHeight = 40;\r\n  const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;\r\n  for (let i = 0; i < lines.length; i++) ctx.fillText(lines[i], canvas.width / 2, startY + i * lineHeight);\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawStoryBanner(ctx, canvas, text, alpha) {\r\n  ctx.save();\r\n  ctx.globalAlpha = Math.max(0, Math.min(1, alpha));\r\n  ctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\r\n  const padding = 12;\r\n  ctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  const textW = ctx.measureText(text).width;\r\n  const boxW = Math.min(canvas.width - 24, textW + padding * 2 + 40);\r\n  const boxH = 42;\r\n  const boxX = (canvas.width - boxW) / 2;\r\n  const boxY = 6; // elevado\r\n  roundRect(ctx, boxX, boxY, boxW, boxH, 10);\r\n  ctx.fill();\r\n  ctx.strokeStyle = '#d97706'; ctx.lineWidth = 2; ctx.stroke();\r\n  ctx.fillStyle = '#92400e';\r\n  ctx.textAlign = 'center'; ctx.textBaseline = 'middle';\r\n  ctx.fillText('💕 ' + text + ' 💕', canvas.width / 2, boxY + boxH / 2);\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawOverlay(ctx, canvas, title, subtitle) {\r\n  ctx.save();\r\n  ctx.fillStyle = 'rgba(0,0,0,0.45)';\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  ctx.fillStyle = '#fff';\r\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.fillText(title, canvas.width / 2, canvas.height / 2 - 6);\r\n  ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.fillText(subtitle, canvas.width / 2, canvas.height / 2 + 18);\r\n  ctx.restore();\r\n}\r\n\r\nfunction roundRect(ctx, x, y, w, h, r) {\r\n  ctx.beginPath();\r\n  ctx.moveTo(x + r, y);\r\n  ctx.arcTo(x + w, y, x + w, y + h, r);\r\n  ctx.arcTo(x + w, y + h, x, y + h, r);\r\n  ctx.arcTo(x, y + h, x, y, r);\r\n  ctx.arcTo(x, y, x + w, y, r);\r\n  ctx.closePath();\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}