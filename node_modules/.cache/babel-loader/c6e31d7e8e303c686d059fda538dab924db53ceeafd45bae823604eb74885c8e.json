{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DanielGarc\\xEDaCarabelo\\\\Downloads\\\\pag web boda 2.0\\\\html\\\\webreact\\\\src\\\\components\\\\Game.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\n\n// Minijuego 2D: El novio/la novia quiere llegar a la iglesia esquivando obstáculos\n// Controles: Space o Flecha ↑ para saltar. Mantén Flecha ↓ para agacharte (en el aire: caída rápida). R para reiniciar.\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Game() {\n  _s();\n  const containerRef = useRef(null);\n  const canvasRef = useRef(null);\n\n  // Estados de juego: menu | intro | playing | win | gameover\n  const [status, setStatus] = useState('menu');\n  const [skin, setSkin] = useState('novio'); // 'novio' | 'novia'\n  const [score, setScore] = useState(0);\n  const [timeLeft, setTimeLeft] = useState(300); // 5 minutos\n\n  const GAME_DURATION = 300; // 5 min gameplay (la intro no consume tiempo)\n\n  // NUEVO: refs para evitar valores congelados en el canvas\n  const SCORE = useRef(0);\n  const TIMELEFT = useRef(GAME_DURATION);\n  // NUEVO: mostrar la intro solo una vez\n  const INTRO_SHOWN = useRef(false);\n\n  // Estado de mute para el audio\n  const [muted, setMuted] = useState(false);\n\n  // Intro tipo \"Star Wars\"\n  const INTRO = useRef({\n    offset: 0,\n    speed: 60,\n    // px/s desplazamiento hacia arriba\n    lines: ['En una galaxia muy, muy cercana...', 'Dos estrellas destinadas a unirse brillan con fuerza.', 'El gran día ha llegado y todos esperan en la iglesia.', 'Ayuda a la pareja a llegar a tiempo sorteando obstáculos...', 'Controles: ↑ o ESPACIO para saltar, ↓ para agacharte o caer rápido.', '¡Que la fuerza del amor te acompañe!']\n  });\n\n  // Momentos clave de la pareja (cada 30 segundos)\n  const STORY_MOMENTS = useRef([{\n    text: \"Ana y Dani en la Facultad de Derecho de la USC 🏛️\",\n    icon: \"📚\",\n    timeStart: 0\n  }, {\n    text: \"Ana preparando las oposiciones para Jueza ⚖️\",\n    icon: \"👩‍⚖️\",\n    timeStart: 30\n  }, {\n    text: \"Dani cursando el Máster de Abogacía 📖\",\n    icon: \"🎓\",\n    timeStart: 60\n  }, {\n    text: \"Dani empezando a trabajar como abogado 💼\",\n    icon: \"👨‍💼\",\n    timeStart: 90\n  }, {\n    text: \"Dani trabajando en Porriño 🏢\",\n    icon: \"⚖️\",\n    timeStart: 120\n  }, {\n    text: \"Dani mudándose a Carballiño 🏠\",\n    icon: \"📦\",\n    timeStart: 150\n  }, {\n    text: \"Ana trabajando en Ponteareas 🏛️\",\n    icon: \"👩‍💼\",\n    timeStart: 180\n  }, {\n    text: \"Ana aprobando la oposición en Pontevedra! 🎉\",\n    icon: \"🏆\",\n    timeStart: 210\n  }, {\n    text: \"Ana y Dani viviendo juntos en Pontevedra 💕\",\n    icon: \"🏡\",\n    timeStart: 240\n  }, {\n    text: \"La pedida de mano en la Torre de Hércules 💍\",\n    icon: \"💒\",\n    timeStart: 270\n  }, {\n    text: \"¡Y hoy... la boda! 👰💒🤵\",\n    icon: \"💖\",\n    timeStart: 300\n  }]);\n  const [currentStoryMoment, setCurrentStoryMoment] = useState(null);\n\n  // Estado del mundo\n  const WORLD = useRef({\n    speed: 220,\n    maxSpeed: 380,\n    gravity: 1700,\n    jumpV: 620,\n    fastFallBoost: 2200,\n    groundY: 220,\n    player: {\n      x: 80,\n      y: 0,\n      w: 32,\n      h: 42,\n      vy: 0,\n      onGround: true,\n      crouching: false\n    },\n    worldX: 0,\n    obstacles: [],\n    startTs: 0,\n    lastTs: 0,\n    spawnTimer: 0,\n    spawnInterval: 1.4\n  });\n\n  // Reset base (sin cambiar estado)\n  const resetWorld = () => {\n    setScore(0);\n    setTimeLeft(GAME_DURATION);\n    WORLD.current.worldX = 0;\n    WORLD.current.lastTs = 0;\n    WORLD.current.startTs = 0;\n    WORLD.current.speed = 220;\n    WORLD.current.spawnInterval = 1.4;\n    WORLD.current.spawnTimer = 0.8;\n    WORLD.current.obstacles = [];\n    WORLD.current.player = {\n      x: 80,\n      y: WORLD.current.groundY - 42,\n      w: 32,\n      h: 42,\n      vy: 0,\n      onGround: true,\n      crouching: false\n    };\n    // NUEVO: sincronizar refs\n    SCORE.current = 0;\n    TIMELEFT.current = GAME_DURATION;\n  };\n  useEffect(() => {\n    // init: mostrar menú\n    resetWorld();\n    INTRO.current.offset = 320; // arranca fuera de la pantalla por abajo\n  }, []);\n\n  // Bucle de juego y render\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    let rafId;\n    const loop = ts => {\n      if (!WORLD.current.lastTs) {\n        WORLD.current.lastTs = ts;\n        if (!WORLD.current.startTs && status === 'playing') WORLD.current.startTs = ts;\n      }\n      const dt = Math.min(0.032, (ts - WORLD.current.lastTs) / 1000);\n      WORLD.current.lastTs = ts;\n      update(dt, ts);\n      render(ctx, canvas);\n      rafId = requestAnimationFrame(loop);\n    };\n    rafId = requestAnimationFrame(loop);\n    return () => cancelAnimationFrame(rafId);\n  }, [status]);\n\n  // NUEVO: cada vez que entramos en intro, reiniciar offset para que se vea siempre\n  useEffect(() => {\n    if (status === 'intro') {\n      INTRO.current.offset = 320;\n    }\n  }, [status]);\n\n  // Entradas\n  useEffect(() => {\n    const onKeyDown = e => {\n      if (e.repeat) return;\n      if ((e.code === 'Space' || e.code === 'ArrowUp') && status === 'playing') jump();\n      if (e.code === 'ArrowDown') {\n        if (status === 'playing') crouch(true);\n      }\n      if (e.code === 'KeyR') {\n        if (status === 'playing' || status === 'gameover' || status === 'win') {\n          resetWorld();\n          setStatus('menu');\n        }\n      }\n    };\n    const onKeyUp = e => {\n      if (e.code === 'ArrowDown') crouch(false);\n    };\n    const onClick = () => {\n      if (status === 'playing') jump();\n    };\n    window.addEventListener('keydown', onKeyDown);\n    window.addEventListener('keyup', onKeyUp);\n    window.addEventListener('touchstart', onClick, {\n      passive: true\n    });\n    window.addEventListener('mousedown', onClick);\n    return () => {\n      window.removeEventListener('keydown', onKeyDown);\n      window.removeEventListener('keyup', onKeyUp);\n      window.removeEventListener('touchstart', onClick);\n      window.removeEventListener('mousedown', onClick);\n    };\n  }, [status]);\n  const jump = () => {\n    const p = WORLD.current.player;\n    if (p.onGround) {\n      p.vy = -WORLD.current.jumpV;\n      p.onGround = false;\n    }\n  };\n  const crouch = on => {\n    const p = WORLD.current.player;\n    if (on) {\n      if (!p.onGround) {\n        p.vy += WORLD.current.fastFallBoost * 0.04; // caída rápida\n      } else if (!p.crouching) {\n        p.crouching = true;\n        const prevBottom = p.y + p.h;\n        p.h = 26;\n        p.y = prevBottom - p.h;\n      }\n    } else {\n      if (p.crouching) {\n        const prevBottom = p.y + p.h;\n        p.h = 42;\n        p.y = prevBottom - p.h;\n        p.crouching = false;\n      }\n    }\n  };\n\n  // Acciones de UI\n  const handlePlayFullscreen = async () => {\n    try {\n      var _containerRef$current;\n      if ((_containerRef$current = containerRef.current) !== null && _containerRef$current !== void 0 && _containerRef$current.requestFullscreen) {\n        await containerRef.current.requestFullscreen();\n      }\n    } catch (e) {/* noop */}\n    // Limpiar mundo antes de jugar\n    resetWorld();\n\n    // Iniciar música en la interacción de usuario\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) {\n      audioEl.currentTime = 0;\n      audioEl.play();\n      audioEl.muted = muted;\n    }\n    if (!INTRO_SHOWN.current) {\n      INTRO.current.offset = 320; // preparar intro\n      setStatus('intro');\n      INTRO_SHOWN.current = true; // marcar intro mostrada\n    } else {\n      startPlaying();\n    }\n  };\n  const startPlaying = () => {\n    // Reset de marcas de tiempo para que el cronómetro cuente desde ahora\n    WORLD.current.lastTs = 0;\n    WORLD.current.startTs = 0;\n    setStatus('playing');\n  };\n\n  // NUEVO: reintentar sin repetir la intro\n  const handleRetry = () => {\n    resetWorld();\n    setCurrentStoryMoment(null); // resetear momento de la historia\n    startPlaying();\n  };\n  const update = (dt, ts) => {\n    if (status === 'menu') return; // nada\n\n    if (status === 'intro') {\n      INTRO.current.offset -= INTRO.current.speed * dt;\n      // tras ~7-8s o cuando el texto sale por arriba, comenzamos\n      if (INTRO.current.offset < -120) startPlaying();\n      return;\n    }\n    if (status !== 'playing') return;\n\n    // Tiempo de juego\n    if (WORLD.current.startTs === 0) WORLD.current.startTs = ts;\n    const elapsed = (ts - WORLD.current.startTs) / 1000;\n    const remaining = Math.max(0, GAME_DURATION - elapsed);\n    // setTimeLeft(remaining);\n    TIMELEFT.current = remaining; // usar ref para el HUD del canvas\n\n    // Actualizar momento de la historia cada 30 segundos\n    const storyMoment = STORY_MOMENTS.current.find(moment => elapsed >= moment.duration - 30 && elapsed < moment.duration);\n    if (storyMoment && currentStoryMoment !== storyMoment.text) {\n      setCurrentStoryMoment(storyMoment.text);\n    }\n    if (remaining <= 0.01) {\n      setStatus('win');\n      return;\n    }\n    const w = WORLD.current;\n    const p = w.player;\n\n    // Aceleración progresiva (cada vez más rápido)\n    const tFactor = Math.min(1, elapsed / GAME_DURATION);\n    w.speed = 220 + (w.maxSpeed - 220) * tFactor;\n    w.spawnInterval = 1.4 - 0.8 * tFactor;\n\n    // Avance del \"mundo\"\n    w.worldX += w.speed * dt;\n\n    // Física del jugador\n    p.vy += w.gravity * dt;\n    p.y += p.vy * dt;\n\n    // Suelo\n    const groundY = w.groundY - p.h;\n    if (p.y >= groundY) {\n      p.y = groundY;\n      p.vy = 0;\n      p.onGround = true;\n    } else {\n      p.onGround = false;\n    }\n\n    // Spawning de obstáculos\n    w.spawnTimer -= dt;\n    if (w.spawnTimer <= 0) {\n      spawnObstacle(w);\n      w.spawnTimer = w.spawnInterval * (0.9 + Math.random() * 0.4);\n    }\n\n    // Colisiones + puntuación\n    for (const o of w.obstacles) {\n      const sx = o.x - w.worldX + p.x;\n      o.screenX = sx;\n      if (!o.scored && sx + o.w < p.x) {\n        o.scored = true;\n        // setScore((s) => s + 100);\n        SCORE.current += 100;\n      }\n      const px1 = p.x,\n        px2 = p.x + p.w;\n      const py1 = p.y,\n        py2 = p.y + p.h;\n      const ox1 = sx,\n        ox2 = sx + o.w;\n      const oy1 = o.y,\n        oy2 = o.y + o.h;\n      const collide = px1 < ox2 && px2 > ox1 && py1 < oy2 && py2 > oy1;\n      if (collide) {\n        setStatus('gameover');\n        break;\n      }\n    }\n\n    // Limpiar obstáculos fuera de pantalla\n    w.obstacles = w.obstacles.filter(o => o.screenX > -120);\n\n    // Puntuación por distancia\n    // setScore((s) => s + Math.floor(w.speed * dt * 0.5));\n    SCORE.current += Math.floor(w.speed * dt * 0.5);\n  };\n  const render = (ctx, canvas) => {\n    const w = WORLD.current;\n    const p = w.player;\n\n    // FONDO base (cielo) o negro en intro\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    if (status === 'intro') {\n      ctx.fillStyle = '#000';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      drawIntro(ctx, canvas, INTRO.current.lines, INTRO.current.offset);\n      return;\n    }\n\n    // Fondo cielo\n    const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\n    g.addColorStop(0, '#e8f0ff');\n    g.addColorStop(1, '#ffffff');\n    ctx.fillStyle = g;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    // Mostrar momento de la historia como elemento de fondo si está jugando\n    if (status === 'playing' && currentStoryMoment) {\n      drawStoryBackground(ctx, canvas, currentStoryMoment);\n    }\n\n    // Suelo\n    ctx.fillStyle = '#c7d2fe';\n    ctx.fillRect(0, w.groundY + 10, canvas.width, 4);\n\n    // Obstáculos\n    for (const o of w.obstacles) {\n      if (o.screenX < -60 || o.screenX > canvas.width + 120) continue;\n      if (o.type === 'low') drawObstacleLow(ctx, o.screenX, o.y, o.w, o.h);else drawObstacleHigh(ctx, o.screenX, o.y, o.w, o.h);\n    }\n\n    // Jugador\n    drawGroom(ctx, p.x, p.y, p.w, p.h, !p.onGround, p.crouching, skin);\n\n    // HUD\n    if (status === 'playing') {\n      ctx.fillStyle = '#334155';\n      ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n      ctx.fillText(`Puntos: ${Math.floor(SCORE.current)}`, 12, 18);\n      ctx.fillText(`Tiempo: ${formatTime(TIMELEFT.current)}`, 12, 36);\n    }\n    if (status === 'gameover') {\n      drawOverlay(ctx, canvas, '¡Ups! Te has tropezado', 'Pulsa R para volver al menú');\n    } else if (status === 'win') {\n      drawOverlay(ctx, canvas, `¡Llegaste a tiempo! 💒`, `Puntuación: ${Math.floor(SCORE.current)}. Pulsa R para volver al menú`);\n    }\n  };\n\n  // Botón mute para audio HTML5\n  const toggleMute = () => {\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) {\n      audioEl.muted = !audioEl.muted;\n      setMuted(audioEl.muted);\n    } else {\n      setMuted(m => !m);\n    }\n  };\n\n  // Limpieza: pausa música al desmontar\n  useEffect(() => {\n    return () => {\n      const audioEl = document.getElementById('bg-music');\n      if (audioEl) audioEl.pause();\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    style: {\n      maxWidth: 860,\n      margin: '0 auto',\n      padding: '1rem',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        textAlign: 'center',\n        marginBottom: '.5rem'\n      },\n      children: \"Camino a la iglesia\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 7\n    }, this), status === 'menu' && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        inset: 0,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'linear-gradient(135deg, rgba(255,255,255,.95), rgba(238,242,255,.95))',\n        zIndex: 5,\n        borderRadius: 12\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 'min(92%, 560px)',\n          padding: '1.25rem',\n          borderRadius: 12,\n          boxShadow: '0 8px 28px rgba(0,0,0,.18)',\n          background: 'white'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            marginTop: 0,\n            textAlign: 'center'\n          },\n          children: \"Elige tu personaje\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '1rem',\n            justifyContent: 'center',\n            marginBottom: '1rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSkin('novio'),\n            className: skin === 'novio' ? 'active' : '',\n            style: skinBtnStyle(skin === 'novio'),\n            children: \"\\uD83E\\uDD35 Novio\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSkin('novia'),\n            className: skin === 'novia' ? 'active' : '',\n            style: skinBtnStyle(skin === 'novia'),\n            children: \"\\uD83D\\uDC70 Novia\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: 'center',\n            color: '#64748b',\n            marginTop: 0\n          },\n          children: \"Llega a la iglesia esquivando obst\\xE1culos en 5 minutos. El juego acelerar\\xE1 poco a poco.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'center'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handlePlayFullscreen,\n            style: {\n              background: 'linear-gradient(135deg, #6366f1, #8b5cf6)',\n              color: 'white',\n              border: 0,\n              padding: '.75rem 1.25rem',\n              borderRadius: 10,\n              fontWeight: 700,\n              cursor: 'pointer',\n              boxShadow: '0 6px 18px rgba(99,102,241,.35)'\n            },\n            children: \"\\u25B6 Jugar en pantalla completa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        borderRadius: 12,\n        overflow: 'hidden',\n        boxShadow: '0 6px 24px rgba(0,0,0,.12)',\n        background: 'white',\n        position: 'relative'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n        id: \"bg-music\",\n        src: \"/musica-boda.mp3\",\n        loop: true,\n        autoPlay: false,\n        style: {\n          display: 'none'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleMute,\n        \"aria-label\": muted ? 'Activar sonido' : 'Silenciar sonido',\n        style: {\n          position: 'absolute',\n          right: 8,\n          top: 8,\n          zIndex: 8,\n          background: 'rgba(0,0,0,.55)',\n          color: '#fff',\n          border: 0,\n          borderRadius: 999,\n          width: 36,\n          height: 36,\n          cursor: 'pointer'\n        },\n        children: muted ? '🔇' : '🔊'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 448,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: 800,\n        height: 260,\n        style: {\n          width: '100%',\n          display: 'block',\n          background: status === 'intro' ? '#000' : 'linear-gradient(#eef2ff, #fff)'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 9\n      }, this), (status === 'gameover' || status === 'win') && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          inset: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 7\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: 'rgba(17,24,39,.88)',\n            color: '#fff',\n            padding: '1rem 1.25rem',\n            borderRadius: 12,\n            boxShadow: '0 8px 28px rgba(0,0,0,.35)',\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: 700,\n              fontSize: 18,\n              marginBottom: 8\n            },\n            children: status === 'win' ? '¡Llegaste a tiempo! 💒' : '¡Ups! Te has tropezado'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 462,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: 14,\n              opacity: .9,\n              marginBottom: 12\n            },\n            children: [\"Puntuaci\\xF3n: \", Math.floor(SCORE.current)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleRetry,\n            style: {\n              background: '#22c55e',\n              color: '#0b1a0f',\n              border: 0,\n              padding: '.5rem 1rem',\n              borderRadius: 10,\n              fontWeight: 700,\n              cursor: 'pointer'\n            },\n            children: \"\\u21BB Reintentar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 398,\n    columnNumber: 5\n  }, this);\n}\n_s(Game, \"65C3vyvZX9fGklNC0LyioNCiFbQ=\");\n_c = Game;\nfunction skinBtnStyle(active) {\n  return {\n    background: active ? '#111827' : '#f3f4f6',\n    color: active ? 'white' : '#111827',\n    border: '1px solid ' + (active ? '#111827' : '#e5e7eb'),\n    padding: '.6rem 1rem',\n    borderRadius: 10,\n    cursor: 'pointer',\n    minWidth: 120,\n    fontWeight: 600\n  };\n}\nfunction spawnObstacle(w) {\n  // Dos tipos: low (bloque en el suelo) y high (barra elevada)\n  const type = Math.random() < 0.55 ? 'low' : 'high';\n  if (type === 'low') {\n    const width = 26 + Math.random() * 16;\n    const height = 22 + Math.random() * 20;\n    const x = w.worldX + 900 + Math.random() * 80;\n    const y = w.groundY - height;\n    w.obstacles.push({\n      type,\n      x,\n      y,\n      w: width,\n      h: height,\n      scored: false,\n      screenX: 0\n    });\n  } else {\n    const width = 80 + Math.random() * 60;\n    const height = 18;\n    const x = w.worldX + 900 + Math.random() * 80;\n    // altura que obliga a agacharse (por encima de altura de pie)\n    const y = w.groundY - (42 + 12);\n    w.obstacles.push({\n      type,\n      x,\n      y,\n      w: width,\n      h: height,\n      scored: false,\n      screenX: 0\n    });\n  }\n}\nfunction formatTime(t) {\n  const s = Math.max(0, Math.floor(t));\n  const mm = String(Math.floor(s / 60)).padStart(2, '0');\n  const ss = String(s % 60).padStart(2, '0');\n  return `${mm}:${ss}`;\n}\nfunction drawObstacleLow(ctx, x, y, w, h) {\n  ctx.save();\n  ctx.fillStyle = '#94a3b8';\n  ctx.strokeStyle = '#475569';\n  ctx.lineWidth = 2;\n  roundRect(ctx, x, y, w, h, 6);\n  ctx.fill();\n  ctx.stroke();\n  ctx.restore();\n}\nfunction drawObstacleHigh(ctx, x, y, w, h) {\n  ctx.save();\n  // postes laterales\n  ctx.fillStyle = '#9ca3af';\n  roundRect(ctx, x, y + h - 30, 4, 30, 2);\n  roundRect(ctx, x + w - 4, y + h - 30, 4, 30, 2);\n  ctx.fill();\n  // barra (verde temática)\n  ctx.fillStyle = '#22c55e';\n  roundRect(ctx, x, y, w, h, 6);\n  ctx.fill();\n  ctx.restore();\n}\nfunction drawGroom(ctx, x, y, w, h, jumping, crouching, skin) {\n  ctx.save();\n  if (skin === 'novia') {\n    // vestido\n    ctx.fillStyle = '#f8fafc';\n    roundRect(ctx, x - 2, y + h * 0.35, w + 4, h * 0.65, 10);\n    ctx.fill();\n    // torso\n    ctx.fillStyle = '#e5e7eb';\n    roundRect(ctx, x, y, w, h * 0.45, 8);\n    ctx.fill();\n    // cabeza\n    ctx.fillStyle = '#fde68a';\n    ctx.beginPath();\n    const headY = crouching ? y - 6 : y - 8;\n    ctx.arc(x + w / 2, headY, 10, 0, Math.PI * 2);\n    ctx.fill();\n    // velo\n    ctx.globalAlpha = 0.6;\n    ctx.fillStyle = '#e0f2fe';\n    roundRect(ctx, x - 6, y - 6, w + 12, 16, 8);\n    ctx.fill();\n    ctx.globalAlpha = 1;\n  } else {\n    // traje\n    ctx.fillStyle = '#1f2937';\n    roundRect(ctx, x, y, w, h, 8);\n    ctx.fill();\n    // cabeza\n    ctx.fillStyle = '#fde68a';\n    ctx.beginPath();\n    const headY = crouching ? y - 6 : y - 8;\n    ctx.arc(x + w / 2, headY, 10, 0, Math.PI * 2);\n    ctx.fill();\n    // corbata\n    ctx.fillStyle = '#ef4444';\n    ctx.fillRect(x + w / 2 - 3, y + 10, 6, 10);\n  }\n  // sombra al saltar\n  if (jumping) {\n    ctx.globalAlpha = 0.2;\n    ctx.fillStyle = '#000';\n    ctx.beginPath();\n    ctx.ellipse(x + w / 2, y + h + 10, w * 0.6, 4, 0, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.globalAlpha = 1;\n  }\n  ctx.restore();\n}\nfunction drawStoryMoment(ctx, canvas, momentText) {\n  ctx.save();\n\n  // Fondo semitransparente para el texto\n  ctx.fillStyle = 'rgba(255, 255, 255, 0.85)';\n  const textWidth = ctx.measureText(momentText).width + 40;\n  const boxHeight = 50;\n  const x = (canvas.width - textWidth) / 2;\n  const y = 20;\n  roundRect(ctx, x, y, textWidth, boxHeight, 12);\n  ctx.fill();\n\n  // Borde sutil\n  ctx.strokeStyle = 'rgba(99, 102, 241, 0.3)';\n  ctx.lineWidth = 2;\n  ctx.stroke();\n\n  // Texto del momento\n  ctx.fillStyle = '#1f2937';\n  ctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.fillText(momentText, canvas.width / 2, y + boxHeight / 2 + 5);\n  ctx.restore();\n}\nfunction drawStoryBackground(ctx, canvas, momentText) {\n  ctx.save();\n\n  // Crear un efecto de fondo grande y sutil\n  ctx.globalAlpha = 0.15;\n\n  // Fondo degradado temático para el momento\n  const gradient = ctx.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width * 0.8);\n  gradient.addColorStop(0, '#fbbf24'); // dorado\n  gradient.addColorStop(0.5, '#f59e0b'); // oro más intenso\n  gradient.addColorStop(1, 'transparent');\n  ctx.fillStyle = gradient;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  // Texto del momento como marca de agua en el fondo\n  ctx.globalAlpha = 0.25;\n  ctx.fillStyle = '#92400e';\n  ctx.font = 'bold 36px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n\n  // Dividir el texto en líneas si es muy largo\n  const words = momentText.split(' ');\n  let lines = [];\n  let currentLine = '';\n  for (const word of words) {\n    const testLine = currentLine + (currentLine ? ' ' : '') + word;\n    const metrics = ctx.measureText(testLine);\n    if (metrics.width > canvas.width * 0.7 && currentLine) {\n      lines.push(currentLine);\n      currentLine = word;\n    } else {\n      currentLine = testLine;\n    }\n  }\n  if (currentLine) lines.push(currentLine);\n\n  // Dibujar líneas centradas\n  const lineHeight = 40;\n  const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;\n  for (let i = 0; i < lines.length; i++) {\n    ctx.fillText(lines[i], canvas.width / 2, startY + i * lineHeight);\n  }\n\n  // Pequeña caja informativa arriba\n  ctx.globalAlpha = 0.9;\n  ctx.fillStyle = 'rgba(251, 191, 36, 0.9)';\n  const boxWidth = 300;\n  const boxHeight = 35;\n  const boxX = (canvas.width - boxWidth) / 2;\n  const boxY = 15;\n  roundRect(ctx, boxX, boxY, boxWidth, boxHeight, 8);\n  ctx.fill();\n\n  // Texto de la caja\n  ctx.fillStyle = '#92400e';\n  ctx.font = 'bold 12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.fillText('💕 Momento especial de Ana y Dani 💕', canvas.width / 2, boxY + boxHeight / 2);\n  ctx.restore();\n}\nfunction drawIntro(ctx, canvas, lines, offset) {\n  ctx.save();\n  ctx.fillStyle = '#10b981'; // verde\n  ctx.textAlign = 'center';\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  const centerX = canvas.width / 2;\n  let y = canvas.height + offset;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const scale = 1 - i * 0.05; // ligera perspectiva\n    ctx.save();\n    ctx.translate(centerX, y);\n    ctx.scale(scale, scale);\n    ctx.fillText(line, 0, 0);\n    ctx.restore();\n    y += 36;\n  }\n  ctx.restore();\n}\nfunction drawOverlay(ctx, canvas, title, subtitle) {\n  ctx.save();\n  ctx.fillStyle = 'rgba(0,0,0,0.45)';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = '#fff';\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.fillText(title, canvas.width / 2, canvas.height / 2 - 6);\n  ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.fillText(subtitle, canvas.width / 2, canvas.height / 2 + 18);\n  ctx.restore();\n}\nfunction roundRect(ctx, x, y, w, h, r) {\n  ctx.beginPath();\n  ctx.moveTo(x + r, y);\n  ctx.arcTo(x + w, y, x + w, y + h, r);\n  ctx.arcTo(x + w, y + h, x, y + h, r);\n  ctx.arcTo(x, y + h, x, y, r);\n  ctx.arcTo(x, y, x + w, y, r);\n  ctx.closePath();\n}\nvar _c;\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","Game","_s","containerRef","canvasRef","status","setStatus","skin","setSkin","score","setScore","timeLeft","setTimeLeft","GAME_DURATION","SCORE","TIMELEFT","INTRO_SHOWN","muted","setMuted","INTRO","offset","speed","lines","STORY_MOMENTS","text","icon","timeStart","currentStoryMoment","setCurrentStoryMoment","WORLD","maxSpeed","gravity","jumpV","fastFallBoost","groundY","player","x","y","w","h","vy","onGround","crouching","worldX","obstacles","startTs","lastTs","spawnTimer","spawnInterval","resetWorld","current","canvas","ctx","getContext","rafId","loop","ts","dt","Math","min","update","render","requestAnimationFrame","cancelAnimationFrame","onKeyDown","e","repeat","code","jump","crouch","onKeyUp","onClick","window","addEventListener","passive","removeEventListener","p","on","prevBottom","handlePlayFullscreen","_containerRef$current","requestFullscreen","audioEl","document","getElementById","currentTime","play","startPlaying","handleRetry","elapsed","remaining","max","storyMoment","find","moment","duration","tFactor","spawnObstacle","random","o","sx","screenX","scored","px1","px2","py1","py2","ox1","ox2","oy1","oy2","collide","filter","floor","clearRect","width","height","fillStyle","fillRect","drawIntro","g","createLinearGradient","addColorStop","drawStoryBackground","type","drawObstacleLow","drawObstacleHigh","drawGroom","font","fillText","formatTime","drawOverlay","toggleMute","m","pause","ref","style","maxWidth","margin","padding","position","children","textAlign","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","inset","display","alignItems","justifyContent","background","zIndex","borderRadius","boxShadow","marginTop","gap","className","skinBtnStyle","color","border","fontWeight","cursor","overflow","id","src","autoPlay","right","top","fontSize","opacity","_c","active","minWidth","push","t","s","mm","String","padStart","ss","save","strokeStyle","lineWidth","roundRect","fill","stroke","restore","jumping","beginPath","headY","arc","PI","globalAlpha","ellipse","drawStoryMoment","momentText","textWidth","measureText","boxHeight","gradient","createRadialGradient","textBaseline","words","split","currentLine","word","testLine","metrics","lineHeight","startY","length","i","boxWidth","boxX","boxY","centerX","line","scale","translate","title","subtitle","r","moveTo","arcTo","closePath","$RefreshReg$"],"sources":["C:/Users/DanielGarcíaCarabelo/Downloads/pag web boda 2.0/html/webreact/src/components/Game.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\n\r\n// Minijuego 2D: El novio/la novia quiere llegar a la iglesia esquivando obstáculos\r\n// Controles: Space o Flecha ↑ para saltar. Mantén Flecha ↓ para agacharte (en el aire: caída rápida). R para reiniciar.\r\nexport default function Game() {\r\n  const containerRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n\r\n  // Estados de juego: menu | intro | playing | win | gameover\r\n  const [status, setStatus] = useState('menu');\r\n  const [skin, setSkin] = useState('novio'); // 'novio' | 'novia'\r\n  const [score, setScore] = useState(0);\r\n  const [timeLeft, setTimeLeft] = useState(300); // 5 minutos\r\n\r\n  const GAME_DURATION = 300; // 5 min gameplay (la intro no consume tiempo)\r\n\r\n  // NUEVO: refs para evitar valores congelados en el canvas\r\n  const SCORE = useRef(0);\r\n  const TIMELEFT = useRef(GAME_DURATION);\r\n  // NUEVO: mostrar la intro solo una vez\r\n  const INTRO_SHOWN = useRef(false);\r\n\r\n  // Estado de mute para el audio\r\n  const [muted, setMuted] = useState(false);\r\n\r\n  // Intro tipo \"Star Wars\"\r\n  const INTRO = useRef({\r\n    offset: 0,\r\n    speed: 60, // px/s desplazamiento hacia arriba\r\n    lines: [\r\n      'En una galaxia muy, muy cercana...',\r\n      'Dos estrellas destinadas a unirse brillan con fuerza.',\r\n      'El gran día ha llegado y todos esperan en la iglesia.',\r\n      'Ayuda a la pareja a llegar a tiempo sorteando obstáculos...',\r\n      'Controles: ↑ o ESPACIO para saltar, ↓ para agacharte o caer rápido.',\r\n      '¡Que la fuerza del amor te acompañe!'\r\n    ],\r\n  });\r\n\r\n  // Momentos clave de la pareja (cada 30 segundos)\r\n  const STORY_MOMENTS = useRef([\r\n    { text: \"Ana y Dani en la Facultad de Derecho de la USC 🏛️\", icon: \"📚\", timeStart: 0 },\r\n    { text: \"Ana preparando las oposiciones para Jueza ⚖️\", icon: \"👩‍⚖️\", timeStart: 30 },\r\n    { text: \"Dani cursando el Máster de Abogacía 📖\", icon: \"🎓\", timeStart: 60 },\r\n    { text: \"Dani empezando a trabajar como abogado 💼\", icon: \"👨‍💼\", timeStart: 90 },\r\n    { text: \"Dani trabajando en Porriño 🏢\", icon: \"⚖️\", timeStart: 120 },\r\n    { text: \"Dani mudándose a Carballiño 🏠\", icon: \"📦\", timeStart: 150 },\r\n    { text: \"Ana trabajando en Ponteareas 🏛️\", icon: \"👩‍💼\", timeStart: 180 },\r\n    { text: \"Ana aprobando la oposición en Pontevedra! 🎉\", icon: \"🏆\", timeStart: 210 },\r\n    { text: \"Ana y Dani viviendo juntos en Pontevedra 💕\", icon: \"🏡\", timeStart: 240 },\r\n    { text: \"La pedida de mano en la Torre de Hércules 💍\", icon: \"💒\", timeStart: 270 },\r\n    { text: \"¡Y hoy... la boda! 👰💒🤵\", icon: \"💖\", timeStart: 300 }\r\n  ]);\r\n\r\n  const [currentStoryMoment, setCurrentStoryMoment] = useState(null);\r\n\r\n  // Estado del mundo\r\n  const WORLD = useRef({\r\n    speed: 220,\r\n    maxSpeed: 380,\r\n    gravity: 1700,\r\n    jumpV: 620,\r\n    fastFallBoost: 2200,\r\n    groundY: 220,\r\n    player: { x: 80, y: 0, w: 32, h: 42, vy: 0, onGround: true, crouching: false },\r\n    worldX: 0,\r\n    obstacles: [],\r\n    startTs: 0,\r\n    lastTs: 0,\r\n    spawnTimer: 0,\r\n    spawnInterval: 1.4,\r\n  });\r\n\r\n  // Reset base (sin cambiar estado)\r\n  const resetWorld = () => {\r\n    setScore(0);\r\n    setTimeLeft(GAME_DURATION);\r\n    WORLD.current.worldX = 0;\r\n    WORLD.current.lastTs = 0;\r\n    WORLD.current.startTs = 0;\r\n    WORLD.current.speed = 220;\r\n    WORLD.current.spawnInterval = 1.4;\r\n    WORLD.current.spawnTimer = 0.8;\r\n    WORLD.current.obstacles = [];\r\n    WORLD.current.player = { x: 80, y: WORLD.current.groundY - 42, w: 32, h: 42, vy: 0, onGround: true, crouching: false };\r\n    // NUEVO: sincronizar refs\r\n    SCORE.current = 0;\r\n    TIMELEFT.current = GAME_DURATION;\r\n  };\r\n\r\n  useEffect(() => {\r\n    // init: mostrar menú\r\n    resetWorld();\r\n    INTRO.current.offset = 320; // arranca fuera de la pantalla por abajo\r\n  }, []);\r\n\r\n  // Bucle de juego y render\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    let rafId;\r\n    const loop = (ts) => {\r\n      if (!WORLD.current.lastTs) {\r\n        WORLD.current.lastTs = ts;\r\n        if (!WORLD.current.startTs && status === 'playing') WORLD.current.startTs = ts;\r\n      }\r\n      const dt = Math.min(0.032, (ts - WORLD.current.lastTs) / 1000);\r\n      WORLD.current.lastTs = ts;\r\n\r\n      update(dt, ts);\r\n      render(ctx, canvas);\r\n      rafId = requestAnimationFrame(loop);\r\n    };\r\n\r\n    rafId = requestAnimationFrame(loop);\r\n    return () => cancelAnimationFrame(rafId);\r\n  }, [status]);\r\n\r\n  // NUEVO: cada vez que entramos en intro, reiniciar offset para que se vea siempre\r\n  useEffect(() => {\r\n    if (status === 'intro') {\r\n      INTRO.current.offset = 320;\r\n    }\r\n  }, [status]);\r\n\r\n  // Entradas\r\n  useEffect(() => {\r\n    const onKeyDown = (e) => {\r\n      if (e.repeat) return;\r\n      if ((e.code === 'Space' || e.code === 'ArrowUp') && status === 'playing') jump();\r\n      if (e.code === 'ArrowDown') {\r\n        if (status === 'playing') crouch(true);\r\n      }\r\n      if (e.code === 'KeyR') {\r\n        if (status === 'playing' || status === 'gameover' || status === 'win') {\r\n          resetWorld();\r\n          setStatus('menu');\r\n        }\r\n      }\r\n    };\r\n    const onKeyUp = (e) => {\r\n      if (e.code === 'ArrowDown') crouch(false);\r\n    };\r\n    const onClick = () => { if (status === 'playing') jump(); };\r\n\r\n    window.addEventListener('keydown', onKeyDown);\r\n    window.addEventListener('keyup', onKeyUp);\r\n    window.addEventListener('touchstart', onClick, { passive: true });\r\n    window.addEventListener('mousedown', onClick);\r\n    return () => {\r\n      window.removeEventListener('keydown', onKeyDown);\r\n      window.removeEventListener('keyup', onKeyUp);\r\n      window.removeEventListener('touchstart', onClick);\r\n      window.removeEventListener('mousedown', onClick);\r\n    };\r\n  }, [status]);\r\n\r\n  const jump = () => {\r\n    const p = WORLD.current.player;\r\n    if (p.onGround) {\r\n      p.vy = -WORLD.current.jumpV;\r\n      p.onGround = false;\r\n    }\r\n  };\r\n\r\n  const crouch = (on) => {\r\n    const p = WORLD.current.player;\r\n    if (on) {\r\n      if (!p.onGround) {\r\n        p.vy += WORLD.current.fastFallBoost * 0.04; // caída rápida\r\n      } else if (!p.crouching) {\r\n        p.crouching = true;\r\n        const prevBottom = p.y + p.h;\r\n        p.h = 26;\r\n        p.y = prevBottom - p.h;\r\n      }\r\n    } else {\r\n      if (p.crouching) {\r\n        const prevBottom = p.y + p.h;\r\n        p.h = 42;\r\n        p.y = prevBottom - p.h;\r\n        p.crouching = false;\r\n      }\r\n    }\r\n  };\r\n\r\n  // Acciones de UI\r\n  const handlePlayFullscreen = async () => {\r\n    try {\r\n      if (containerRef.current?.requestFullscreen) {\r\n        await containerRef.current.requestFullscreen();\r\n      }\r\n    } catch (e) { /* noop */ }\r\n    // Limpiar mundo antes de jugar\r\n    resetWorld();\r\n\r\n    // Iniciar música en la interacción de usuario\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) {\r\n      audioEl.currentTime = 0;\r\n      audioEl.play();\r\n      audioEl.muted = muted;\r\n    }\r\n\r\n    if (!INTRO_SHOWN.current) {\r\n      INTRO.current.offset = 320; // preparar intro\r\n      setStatus('intro');\r\n      INTRO_SHOWN.current = true; // marcar intro mostrada\r\n    } else {\r\n      startPlaying();\r\n    }\r\n  };\r\n\r\n  const startPlaying = () => {\r\n    // Reset de marcas de tiempo para que el cronómetro cuente desde ahora\r\n    WORLD.current.lastTs = 0;\r\n    WORLD.current.startTs = 0;\r\n    setStatus('playing');\r\n  };\r\n\r\n  // NUEVO: reintentar sin repetir la intro\r\n  const handleRetry = () => {\r\n    resetWorld();\r\n    setCurrentStoryMoment(null); // resetear momento de la historia\r\n    startPlaying();\r\n  };\r\n\r\n  const update = (dt, ts) => {\r\n    if (status === 'menu') return; // nada\r\n\r\n    if (status === 'intro') {\r\n      INTRO.current.offset -= INTRO.current.speed * dt;\r\n      // tras ~7-8s o cuando el texto sale por arriba, comenzamos\r\n      if (INTRO.current.offset < -120) startPlaying();\r\n      return;\r\n    }\r\n\r\n    if (status !== 'playing') return;\r\n\r\n    // Tiempo de juego\r\n    if (WORLD.current.startTs === 0) WORLD.current.startTs = ts;\r\n    const elapsed = (ts - WORLD.current.startTs) / 1000;\r\n    const remaining = Math.max(0, GAME_DURATION - elapsed);\r\n    // setTimeLeft(remaining);\r\n    TIMELEFT.current = remaining; // usar ref para el HUD del canvas\r\n    \r\n    // Actualizar momento de la historia cada 30 segundos\r\n    const storyMoment = STORY_MOMENTS.current.find(moment => \r\n      elapsed >= (moment.duration - 30) && elapsed < moment.duration\r\n    );\r\n    if (storyMoment && currentStoryMoment !== storyMoment.text) {\r\n      setCurrentStoryMoment(storyMoment.text);\r\n    }\r\n    \r\n    if (remaining <= 0.01) {\r\n      setStatus('win');\r\n      return;\r\n    }\r\n\r\n    const w = WORLD.current;\r\n    const p = w.player;\r\n\r\n    // Aceleración progresiva (cada vez más rápido)\r\n    const tFactor = Math.min(1, elapsed / GAME_DURATION);\r\n    w.speed = 220 + (w.maxSpeed - 220) * tFactor;\r\n    w.spawnInterval = 1.4 - 0.8 * tFactor;\r\n\r\n    // Avance del \"mundo\"\r\n    w.worldX += w.speed * dt;\r\n\r\n    // Física del jugador\r\n    p.vy += w.gravity * dt;\r\n    p.y += p.vy * dt;\r\n\r\n    // Suelo\r\n    const groundY = w.groundY - p.h;\r\n    if (p.y >= groundY) {\r\n      p.y = groundY;\r\n      p.vy = 0;\r\n      p.onGround = true;\r\n    } else {\r\n      p.onGround = false;\r\n    }\r\n\r\n    // Spawning de obstáculos\r\n    w.spawnTimer -= dt;\r\n    if (w.spawnTimer <= 0) {\r\n      spawnObstacle(w);\r\n      w.spawnTimer = w.spawnInterval * (0.9 + Math.random() * 0.4);\r\n    }\r\n\r\n    // Colisiones + puntuación\r\n    for (const o of w.obstacles) {\r\n      const sx = o.x - w.worldX + p.x;\r\n      o.screenX = sx;\r\n\r\n      if (!o.scored && sx + o.w < p.x) {\r\n        o.scored = true;\r\n        // setScore((s) => s + 100);\r\n        SCORE.current += 100;\r\n      }\r\n\r\n      const px1 = p.x, px2 = p.x + p.w;\r\n      const py1 = p.y, py2 = p.y + p.h;\r\n      const ox1 = sx, ox2 = sx + o.w;\r\n      const oy1 = o.y, oy2 = o.y + o.h;\r\n      const collide = px1 < ox2 && px2 > ox1 && py1 < oy2 && py2 > oy1;\r\n      if (collide) {\r\n        setStatus('gameover');\r\n        break;\r\n      }\r\n    }\r\n\r\n    // Limpiar obstáculos fuera de pantalla\r\n    w.obstacles = w.obstacles.filter((o) => o.screenX > -120);\r\n\r\n    // Puntuación por distancia\r\n    // setScore((s) => s + Math.floor(w.speed * dt * 0.5));\r\n    SCORE.current += Math.floor(w.speed * dt * 0.5);\r\n  };\r\n\r\n  const render = (ctx, canvas) => {\r\n    const w = WORLD.current;\r\n    const p = w.player;\r\n\r\n    // FONDO base (cielo) o negro en intro\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    if (status === 'intro') {\r\n      ctx.fillStyle = '#000';\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n      drawIntro(ctx, canvas, INTRO.current.lines, INTRO.current.offset);\r\n      return;\r\n    }\r\n\r\n    // Fondo cielo\r\n    const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n    g.addColorStop(0, '#e8f0ff');\r\n    g.addColorStop(1, '#ffffff');\r\n    ctx.fillStyle = g;\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n    // Mostrar momento de la historia como elemento de fondo si está jugando\r\n    if (status === 'playing' && currentStoryMoment) {\r\n      drawStoryBackground(ctx, canvas, currentStoryMoment);\r\n    }\r\n\r\n    // Suelo\r\n    ctx.fillStyle = '#c7d2fe';\r\n    ctx.fillRect(0, w.groundY + 10, canvas.width, 4);\r\n\r\n    // Obstáculos\r\n    for (const o of w.obstacles) {\r\n      if (o.screenX < -60 || o.screenX > canvas.width + 120) continue;\r\n      if (o.type === 'low') drawObstacleLow(ctx, o.screenX, o.y, o.w, o.h);\r\n      else drawObstacleHigh(ctx, o.screenX, o.y, o.w, o.h);\r\n    }\r\n\r\n    // Jugador\r\n    drawGroom(ctx, p.x, p.y, p.w, p.h, !p.onGround, p.crouching, skin);\r\n\r\n    // HUD\r\n    if (status === 'playing') {\r\n      ctx.fillStyle = '#334155';\r\n      ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n      ctx.fillText(`Puntos: ${Math.floor(SCORE.current)}`, 12, 18);\r\n      ctx.fillText(`Tiempo: ${formatTime(TIMELEFT.current)}`, 12, 36);\r\n    }\r\n\r\n    if (status === 'gameover') {\r\n      drawOverlay(ctx, canvas, '¡Ups! Te has tropezado', 'Pulsa R para volver al menú');\r\n    } else if (status === 'win') {\r\n      drawOverlay(ctx, canvas, `¡Llegaste a tiempo! 💒`, `Puntuación: ${Math.floor(SCORE.current)}. Pulsa R para volver al menú`);\r\n    }\r\n  };\r\n\r\n  // Botón mute para audio HTML5\r\n  const toggleMute = () => {\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) {\r\n      audioEl.muted = !audioEl.muted;\r\n      setMuted(audioEl.muted);\r\n    } else {\r\n      setMuted((m) => !m);\r\n    }\r\n  };\r\n\r\n  // Limpieza: pausa música al desmontar\r\n  useEffect(() => {\r\n    return () => {\r\n      const audioEl = document.getElementById('bg-music');\r\n      if (audioEl) audioEl.pause();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div ref={containerRef} style={{ maxWidth: 860, margin: '0 auto', padding: '1rem', position: 'relative' }}>\r\n      <h2 style={{ textAlign: 'center', marginBottom: '.5rem' }}>Camino a la iglesia</h2>\r\n      {/* Panel de control/menú */}\r\n      {status === 'menu' && (\r\n        <div style={{\r\n          position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n          background: 'linear-gradient(135deg, rgba(255,255,255,.95), rgba(238,242,255,.95))',\r\n          zIndex: 5, borderRadius: 12\r\n        }}>\r\n          <div style={{ width: 'min(92%, 560px)', padding: '1.25rem', borderRadius: 12, boxShadow: '0 8px 28px rgba(0,0,0,.18)', background: 'white' }}>\r\n            <h3 style={{ marginTop: 0, textAlign: 'center' }}>Elige tu personaje</h3>\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center', marginBottom: '1rem' }}>\r\n              <button\r\n                onClick={() => setSkin('novio')}\r\n                className={skin === 'novio' ? 'active' : ''}\r\n                style={skinBtnStyle(skin === 'novio')}\r\n              >\r\n                🤵 Novio\r\n              </button>\r\n              <button\r\n                onClick={() => setSkin('novia')}\r\n                className={skin === 'novia' ? 'active' : ''}\r\n                style={skinBtnStyle(skin === 'novia')}\r\n              >\r\n                👰 Novia\r\n              </button>\r\n            </div>\r\n            <p style={{ textAlign: 'center', color: '#64748b', marginTop: 0 }}>\r\n              Llega a la iglesia esquivando obstáculos en 5 minutos. El juego acelerará poco a poco.\r\n            </p>\r\n            <div style={{ display: 'flex', justifyContent: 'center' }}>\r\n              <button onClick={handlePlayFullscreen} style={{\r\n                background: 'linear-gradient(135deg, #6366f1, #8b5cf6)', color: 'white', border: 0, padding: '.75rem 1.25rem',\r\n                borderRadius: 10, fontWeight: 700, cursor: 'pointer', boxShadow: '0 6px 18px rgba(99,102,241,.35)'\r\n              }}>▶ Jugar en pantalla completa</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div style={{ borderRadius: 12, overflow: 'hidden', boxShadow: '0 6px 24px rgba(0,0,0,.12)', background: 'white', position: 'relative' }}>\r\n        {/* Audio de fondo personalizado */}\r\n        <audio\r\n          id=\"bg-music\"\r\n          src=\"/musica-boda.mp3\"\r\n          loop\r\n          autoPlay={false}\r\n          style={{ display: 'none' }}\r\n        />\r\n        {/* Botón de Mute */}\r\n        <button onClick={toggleMute} aria-label={muted ? 'Activar sonido' : 'Silenciar sonido'}\r\n          style={{ position: 'absolute', right: 8, top: 8, zIndex: 8, background: 'rgba(0,0,0,.55)', color: '#fff', border: 0, borderRadius: 999, width: 36, height: 36, cursor: 'pointer' }}>\r\n          {muted ? '🔇' : '🔊'}\r\n        </button>\r\n        <canvas\r\n          ref={canvasRef}\r\n          width={800}\r\n          height={260}\r\n          style={{ width: '100%', display: 'block', background: status === 'intro' ? '#000' : 'linear-gradient(#eef2ff, #fff)' }}\r\n        />\r\n        {/* NUEVO: overlay con botón Reintentar al terminar */}\r\n        {(status === 'gameover' || status === 'win') && (\r\n          <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 7 }}>\r\n            <div style={{ background: 'rgba(17,24,39,.88)', color: '#fff', padding: '1rem 1.25rem', borderRadius: 12, boxShadow: '0 8px 28px rgba(0,0,0,.35)', textAlign: 'center' }}>\r\n              <div style={{ fontWeight: 700, fontSize: 18, marginBottom: 8 }}>\r\n                {status === 'win' ? '¡Llegaste a tiempo! 💒' : '¡Ups! Te has tropezado'}\r\n              </div>\r\n              <div style={{ fontSize: 14, opacity: .9, marginBottom: 12 }}>\r\n                Puntuación: {Math.floor(SCORE.current)}\r\n              </div>\r\n              <button onClick={handleRetry} style={{ background: '#22c55e', color: '#0b1a0f', border: 0, padding: '.5rem 1rem', borderRadius: 10, fontWeight: 700, cursor: 'pointer' }}>↻ Reintentar</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction skinBtnStyle(active) {\r\n  return {\r\n    background: active ? '#111827' : '#f3f4f6',\r\n    color: active ? 'white' : '#111827',\r\n    border: '1px solid ' + (active ? '#111827' : '#e5e7eb'),\r\n    padding: '.6rem 1rem',\r\n    borderRadius: 10,\r\n    cursor: 'pointer',\r\n    minWidth: 120,\r\n    fontWeight: 600,\r\n  };\r\n}\r\n\r\nfunction spawnObstacle(w) {\r\n  // Dos tipos: low (bloque en el suelo) y high (barra elevada)\r\n  const type = Math.random() < 0.55 ? 'low' : 'high';\r\n  if (type === 'low') {\r\n    const width = 26 + Math.random() * 16;\r\n    const height = 22 + Math.random() * 20;\r\n    const x = w.worldX + 900 + Math.random() * 80;\r\n    const y = w.groundY - height;\r\n    w.obstacles.push({ type, x, y, w: width, h: height, scored: false, screenX: 0 });\r\n  } else {\r\n    const width = 80 + Math.random() * 60;\r\n    const height = 18;\r\n    const x = w.worldX + 900 + Math.random() * 80;\r\n    // altura que obliga a agacharse (por encima de altura de pie)\r\n    const y = w.groundY - (42 + 12);\r\n    w.obstacles.push({ type, x, y, w: width, h: height, scored: false, screenX: 0 });\r\n  }\r\n}\r\n\r\nfunction formatTime(t) {\r\n  const s = Math.max(0, Math.floor(t));\r\n  const mm = String(Math.floor(s / 60)).padStart(2, '0');\r\n  const ss = String(s % 60).padStart(2, '0');\r\n  return `${mm}:${ss}`;\r\n}\r\n\r\nfunction drawObstacleLow(ctx, x, y, w, h) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#94a3b8';\r\n  ctx.strokeStyle = '#475569';\r\n  ctx.lineWidth = 2;\r\n  roundRect(ctx, x, y, w, h, 6);\r\n  ctx.fill();\r\n  ctx.stroke();\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawObstacleHigh(ctx, x, y, w, h) {\r\n  ctx.save();\r\n  // postes laterales\r\n  ctx.fillStyle = '#9ca3af';\r\n  roundRect(ctx, x, y + h - 30, 4, 30, 2);\r\n  roundRect(ctx, x + w - 4, y + h - 30, 4, 30, 2);\r\n  ctx.fill();\r\n  // barra (verde temática)\r\n  ctx.fillStyle = '#22c55e';\r\n  roundRect(ctx, x, y, w, h, 6);\r\n  ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawGroom(ctx, x, y, w, h, jumping, crouching, skin) {\r\n  ctx.save();\r\n  if (skin === 'novia') {\r\n    // vestido\r\n    ctx.fillStyle = '#f8fafc';\r\n    roundRect(ctx, x - 2, y + h * 0.35, w + 4, h * 0.65, 10);\r\n    ctx.fill();\r\n    // torso\r\n    ctx.fillStyle = '#e5e7eb';\r\n    roundRect(ctx, x, y, w, h * 0.45, 8);\r\n    ctx.fill();\r\n    // cabeza\r\n    ctx.fillStyle = '#fde68a';\r\n    ctx.beginPath();\r\n    const headY = crouching ? y - 6 : y - 8;\r\n    ctx.arc(x + w / 2, headY, 10, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    // velo\r\n    ctx.globalAlpha = 0.6;\r\n    ctx.fillStyle = '#e0f2fe';\r\n    roundRect(ctx, x - 6, y - 6, w + 12, 16, 8);\r\n    ctx.fill();\r\n    ctx.globalAlpha = 1;\r\n  } else {\r\n    // traje\r\n    ctx.fillStyle = '#1f2937';\r\n    roundRect(ctx, x, y, w, h, 8);\r\n    ctx.fill();\r\n    // cabeza\r\n    ctx.fillStyle = '#fde68a';\r\n    ctx.beginPath();\r\n    const headY = crouching ? y - 6 : y - 8;\r\n    ctx.arc(x + w / 2, headY, 10, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    // corbata\r\n    ctx.fillStyle = '#ef4444';\r\n    ctx.fillRect(x + w / 2 - 3, y + 10, 6, 10);\r\n  }\r\n  // sombra al saltar\r\n  if (jumping) {\r\n    ctx.globalAlpha = 0.2;\r\n    ctx.fillStyle = '#000';\r\n    ctx.beginPath();\r\n    ctx.ellipse(x + w / 2, y + h + 10, w * 0.6, 4, 0, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.globalAlpha = 1;\r\n  }\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawStoryMoment(ctx, canvas, momentText) {\r\n  ctx.save();\r\n  \r\n  // Fondo semitransparente para el texto\r\n  ctx.fillStyle = 'rgba(255, 255, 255, 0.85)';\r\n  const textWidth = ctx.measureText(momentText).width + 40;\r\n  const boxHeight = 50;\r\n  const x = (canvas.width - textWidth) / 2;\r\n  const y = 20;\r\n  \r\n  roundRect(ctx, x, y, textWidth, boxHeight, 12);\r\n  ctx.fill();\r\n  \r\n  // Borde sutil\r\n  ctx.strokeStyle = 'rgba(99, 102, 241, 0.3)';\r\n  ctx.lineWidth = 2;\r\n  ctx.stroke();\r\n  \r\n  // Texto del momento\r\n  ctx.fillStyle = '#1f2937';\r\n  ctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.fillText(momentText, canvas.width / 2, y + boxHeight / 2 + 5);\r\n  \r\n  ctx.restore();\r\n}\r\n\r\nfunction drawStoryBackground(ctx, canvas, momentText) {\r\n  ctx.save();\r\n  \r\n  // Crear un efecto de fondo grande y sutil\r\n  ctx.globalAlpha = 0.15;\r\n  \r\n  // Fondo degradado temático para el momento\r\n  const gradient = ctx.createRadialGradient(\r\n    canvas.width / 2, canvas.height / 2, 0,\r\n    canvas.width / 2, canvas.height / 2, canvas.width * 0.8\r\n  );\r\n  gradient.addColorStop(0, '#fbbf24'); // dorado\r\n  gradient.addColorStop(0.5, '#f59e0b'); // oro más intenso\r\n  gradient.addColorStop(1, 'transparent');\r\n  \r\n  ctx.fillStyle = gradient;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  \r\n  // Texto del momento como marca de agua en el fondo\r\n  ctx.globalAlpha = 0.25;\r\n  ctx.fillStyle = '#92400e';\r\n  ctx.font = 'bold 36px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n  \r\n  // Dividir el texto en líneas si es muy largo\r\n  const words = momentText.split(' ');\r\n  let lines = [];\r\n  let currentLine = '';\r\n  \r\n  for (const word of words) {\r\n    const testLine = currentLine + (currentLine ? ' ' : '') + word;\r\n    const metrics = ctx.measureText(testLine);\r\n    \r\n    if (metrics.width > canvas.width * 0.7 && currentLine) {\r\n      lines.push(currentLine);\r\n      currentLine = word;\r\n    } else {\r\n      currentLine = testLine;\r\n    }\r\n  }\r\n  if (currentLine) lines.push(currentLine);\r\n  \r\n  // Dibujar líneas centradas\r\n  const lineHeight = 40;\r\n  const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;\r\n  \r\n  for (let i = 0; i < lines.length; i++) {\r\n    ctx.fillText(lines[i], canvas.width / 2, startY + i * lineHeight);\r\n  }\r\n  \r\n  // Pequeña caja informativa arriba\r\n  ctx.globalAlpha = 0.9;\r\n  ctx.fillStyle = 'rgba(251, 191, 36, 0.9)';\r\n  const boxWidth = 300;\r\n  const boxHeight = 35;\r\n  const boxX = (canvas.width - boxWidth) / 2;\r\n  const boxY = 15;\r\n  \r\n  roundRect(ctx, boxX, boxY, boxWidth, boxHeight, 8);\r\n  ctx.fill();\r\n  \r\n  // Texto de la caja\r\n  ctx.fillStyle = '#92400e';\r\n  ctx.font = 'bold 12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n  ctx.fillText('💕 Momento especial de Ana y Dani 💕', canvas.width / 2, boxY + boxHeight / 2);\r\n  \r\n  ctx.restore();\r\n}\r\n\r\nfunction drawIntro(ctx, canvas, lines, offset) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#10b981'; // verde\r\n  ctx.textAlign = 'center';\r\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  const centerX = canvas.width / 2;\r\n  let y = canvas.height + offset;\r\n  for (let i = 0; i < lines.length; i++) {\r\n    const line = lines[i];\r\n    const scale = 1 - i * 0.05; // ligera perspectiva\r\n    ctx.save();\r\n    ctx.translate(centerX, y);\r\n    ctx.scale(scale, scale);\r\n    ctx.fillText(line, 0, 0);\r\n    ctx.restore();\r\n    y += 36;\r\n  }\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawOverlay(ctx, canvas, title, subtitle) {\r\n  ctx.save();\r\n  ctx.fillStyle = 'rgba(0,0,0,0.45)';\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  ctx.fillStyle = '#fff';\r\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.fillText(title, canvas.width / 2, canvas.height / 2 - 6);\r\n  ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.fillText(subtitle, canvas.width / 2, canvas.height / 2 + 18);\r\n  ctx.restore();\r\n}\r\n\r\nfunction roundRect(ctx, x, y, w, h, r) {\r\n  ctx.beginPath();\r\n  ctx.moveTo(x + r, y);\r\n  ctx.arcTo(x + w, y, x + w, y + h, r);\r\n  ctx.arcTo(x + w, y + h, x, y + h, r);\r\n  ctx.arcTo(x, y + h, x, y, r);\r\n  ctx.arcTo(x, y, x + w, y, r);\r\n  ctx.closePath();\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}