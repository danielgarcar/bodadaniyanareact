{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DanielGarc\\xEDaCarabelo\\\\Downloads\\\\pag web boda 2.0\\\\html\\\\webreact\\\\src\\\\components\\\\Game.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\n\n// Juego moderno: pareja camino a la iglesia, con narrativa cada 30s\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Game() {\n  _s();\n  const containerRef = useRef(null);\n  const canvasRef = useRef(null);\n\n  // Estado principal\n  const [status, setStatus] = useState('menu'); // menu | intro | playing | paused | win | gameover\n  const [muted, setMuted] = useState(false);\n\n  // ConfiguraciÃ³n de juego\n  const GAME_DURATION = 300; // 5 min\n  const SCORE = useRef(0);\n  const TIMELEFT = useRef(GAME_DURATION);\n  const INTRO_SHOWN = useRef(false);\n\n  // Intro estilo Star Wars\n  const INTRO = useRef({\n    offset: 320,\n    speed: 40,\n    // mÃ¡s lento para una intro mÃ¡s larga\n    lines: ['En una galaxia muy, muy cercana...', 'Dos estrellas destinadas a unirse brillan con fuerza.', 'El gran dÃ­a ha llegado y todos esperan en la iglesia.', 'Ayuda a la pareja a llegar a tiempo sorteando obstÃ¡culos...', 'Controles: â†‘ o ESPACIO para saltar, â†“ para agacharte o caer rÃ¡pido.', 'Pulsa P para pausar. R para reiniciar.', 'Â¡Que la fuerza del amor te acompaÃ±e!']\n  });\n\n  // Momentos clave (cada 30s)\n  const STORY_MOMENTS = useRef([{\n    text: 'Ana y Dani en la Facultad de Derecho de la USC ðŸ›ï¸',\n    timeStart: 0\n  }, {\n    text: 'Ana preparando las oposiciones para Jueza âš–ï¸',\n    timeStart: 30\n  }, {\n    text: 'Dani cursando el MÃ¡ster de AbogacÃ­a ðŸ“–',\n    timeStart: 60\n  }, {\n    text: 'Dani empezando a trabajar como abogado ðŸ’¼',\n    timeStart: 90\n  }, {\n    text: 'Dani trabajando en PorriÃ±o ðŸ¢',\n    timeStart: 120\n  }, {\n    text: 'Dani mudÃ¡ndose a CarballiÃ±o ðŸ ',\n    timeStart: 150\n  }, {\n    text: 'Ana trabajando en Ponteareas ðŸ›ï¸',\n    timeStart: 180\n  }, {\n    text: 'Ana aprobando la oposiciÃ³n en Pontevedra ðŸŽ‰',\n    timeStart: 210\n  }, {\n    text: 'Ana y Dani viviendo juntos en Pontevedra ðŸ’•',\n    timeStart: 240\n  }, {\n    text: 'La pedida en la Torre de HÃ©rcules ðŸ’',\n    timeStart: 270\n  }, {\n    text: 'Â¡Y hoy... la boda! ðŸ‘°ðŸ’’ðŸ¤µ',\n    timeStart: 300\n  }]);\n\n  // Narrativa actual con banner animado\n  const STORY = useRef({\n    index: -1,\n    bannerText: '',\n    bannerAlpha: 0,\n    bannerTimer: 0\n  });\n  const [currentStoryMoment, setCurrentStoryMoment] = useState(null);\n  // Buffers para optimizar render de textos/gradientes\n  const BUFFERS = useRef({\n    width: 0,\n    height: 0,\n    text: '',\n    watermark: null,\n    banner: null\n  });\n  // Capas prerenderizadas para parallax\n  const LAYERS = useRef({\n    width: 0,\n    height: 0,\n    city: null,\n    hills: null\n  });\n\n  // Reconstruir buffers de watermark y banner cuando cambie el texto o el tamaÃ±o\n  const rebuildStoryBuffers = text => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const width = canvas.width,\n      height = canvas.height;\n    const sameSize = BUFFERS.current.width === width && BUFFERS.current.height === height;\n    const sameText = BUFFERS.current.text === text;\n    if (sameSize && sameText && BUFFERS.current.watermark && BUFFERS.current.banner) return;\n    BUFFERS.current.width = width;\n    BUFFERS.current.height = height;\n    BUFFERS.current.text = text;\n\n    // Watermark prerender\n    const wm = document.createElement('canvas');\n    wm.width = width;\n    wm.height = height;\n    const wctx = wm.getContext('2d');\n    wctx.globalAlpha = 0.12;\n    const gradient = wctx.createRadialGradient(width / 2, height / 2, 0, width / 2, height / 2, width * 0.9);\n    gradient.addColorStop(0, '#fbbf24');\n    gradient.addColorStop(0.5, '#f59e0b');\n    gradient.addColorStop(1, 'transparent');\n    wctx.fillStyle = gradient;\n    wctx.fillRect(0, 0, width, height);\n    wctx.globalAlpha = 0.22;\n    wctx.fillStyle = '#92400e';\n    wctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n    wctx.textAlign = 'center';\n    wctx.textBaseline = 'middle';\n    const lines = wrapText(wctx, text, width * 0.7);\n    const lh = 40;\n    const sy = height / 2 - (lines.length - 1) * lh / 2;\n    for (let i = 0; i < lines.length; i++) wctx.fillText(lines[i], width / 2, sy + i * lh);\n    BUFFERS.current.watermark = wm;\n\n    // Banner prerender\n    const pad = 12;\n    wctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n    const fullText = 'ðŸ’• ' + text + ' ðŸ’•';\n    const textW = wctx.measureText(fullText).width;\n    const boxW = Math.min(width - 24, textW + pad * 2 + 40);\n    const boxH = 42;\n    const bn = document.createElement('canvas');\n    bn.width = Math.ceil(boxW);\n    bn.height = boxH;\n    const bctx = bn.getContext('2d');\n    bctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\n    roundRect(bctx, 0, 0, boxW, boxH, 10);\n    bctx.fill();\n    bctx.strokeStyle = '#d97706';\n    bctx.lineWidth = 2;\n    bctx.stroke();\n    bctx.fillStyle = '#92400e';\n    bctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n    bctx.textAlign = 'center';\n    bctx.textBaseline = 'middle';\n    bctx.fillText(fullText, boxW / 2, boxH / 2);\n    BUFFERS.current.banner = bn;\n  };\n\n  // Prerender de capas city/hills para parallax\n  const rebuildParallaxLayers = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const width = canvas.width,\n      height = canvas.height;\n    if (LAYERS.current.width === width && LAYERS.current.height === height && LAYERS.current.city && LAYERS.current.hills) return;\n    LAYERS.current.width = width;\n    LAYERS.current.height = height;\n\n    // City layer\n    const city = document.createElement('canvas');\n    city.width = width + 200;\n    city.height = height;\n    const cctx = city.getContext('2d');\n    cctx.fillStyle = '#c7d2fe';\n    const baseY = 180;\n    const steps = Math.ceil((city.width + 200) / 90);\n    for (let i = 0; i < steps; i++) {\n      const w = 40 + i % 3 * 10;\n      const h = 30 + i % 5 * 18;\n      const x = -100 + i * 90;\n      roundRect(cctx, x, baseY - h, w, h, 4);\n      cctx.fill();\n    }\n    LAYERS.current.city = city;\n\n    // Hills layer\n    const hills = document.createElement('canvas');\n    hills.width = width + 300;\n    hills.height = height;\n    const hctx = hills.getContext('2d');\n    hctx.fillStyle = '#93c5fd';\n    const hSteps = Math.ceil((hills.width + 300) / 260);\n    for (let i = 0; i < hSteps; i++) {\n      const x = -150 + i * 260;\n      hctx.beginPath();\n      hctx.ellipse(x, 220, 180, 36, 0, 0, Math.PI * 2);\n      hctx.fill();\n    }\n    LAYERS.current.hills = hills;\n  };\n\n  // Redibujar buffers al redimensionar\n  useEffect(() => {\n    const onResize = () => {\n      const txt = currentStoryMoment || STORY_MOMENTS.current[0].text;\n      rebuildStoryBuffers(txt);\n      // forzar rebuild de layers\n      LAYERS.current.width = 0;\n      LAYERS.current.height = 0;\n      rebuildParallaxLayers();\n    };\n    window.addEventListener('resize', onResize);\n    onResize();\n    return () => window.removeEventListener('resize', onResize);\n  }, [currentStoryMoment]);\n\n  // Reset limpio\n  const resetWorld = () => {\n    var _WORLD;\n    // Guarda defensiva: en algunos ciclos de montaje (StrictMode) el cierre puede aÃºn no exponer WORLD\n    if (typeof WORLD === 'undefined' || !((_WORLD = WORLD) !== null && _WORLD !== void 0 && _WORLD.current)) {\n      console.warn('WORLD aÃºn no estÃ¡ listo para resetWorld');\n      return;\n    }\n    SCORE.current = 0;\n    TIMELEFT.current = GAME_DURATION;\n    STORY.current = {\n      index: -1,\n      bannerText: '',\n      bannerAlpha: 0,\n      bannerTimer: 0\n    };\n    setCurrentStoryMoment(null);\n    const w = WORLD.current;\n    w.worldX = 0;\n    w.lastTs = 0;\n    w.startTs = 0;\n    w.speed = 240;\n    w.spawnInterval = 1.3;\n    w.spawnTimer = 0.8;\n    w.obstacles = [];\n    w.parallax.skyShift = 0;\n    w.parallax.cityShift = 0;\n    w.parallax.hillShift = 0;\n    w.player = {\n      x: 100,\n      y: w.groundY - 48,\n      w: 70,\n      h: 48,\n      vy: 0,\n      onGround: true,\n      crouching: false\n    };\n  };\n  useEffect(() => {\n    resetWorld();\n    INTRO.current.offset = 320;\n  }, []);\n\n  // Bucle de juego\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    let rafId;\n    const loop = ts => {\n      const w = WORLD.current;\n      if (!w.lastTs) {\n        w.lastTs = ts;\n        if (!w.startTs && status === 'playing') w.startTs = ts;\n      }\n      const dt = Math.min(0.032, (ts - w.lastTs) / 1000);\n      w.lastTs = ts;\n      update(dt, ts);\n      render(ctx, canvas);\n      rafId = requestAnimationFrame(loop);\n    };\n    rafId = requestAnimationFrame(loop);\n    return () => cancelAnimationFrame(rafId);\n  }, [status]);\n\n  // Reiniciar intro al entrar\n  useEffect(() => {\n    if (status === 'intro') INTRO.current.offset = 320;\n  }, [status]);\n\n  // Entradas\n  useEffect(() => {\n    const onKeyDown = e => {\n      if (e.repeat) return;\n      if ((e.code === 'Space' || e.code === 'ArrowUp') && status === 'playing') jump();\n      if (e.code === 'ArrowDown' && status === 'playing') crouch(true);\n      if (e.code === 'KeyR' && (status === 'playing' || status === 'gameover' || status === 'win' || status === 'paused')) {\n        resetWorld();\n        setStatus('menu');\n      }\n      if (e.code === 'KeyP' && (status === 'playing' || status === 'paused')) togglePause();\n      if (e.code === 'Enter' && status === 'menu') handlePlayFullscreen();\n      if (e.code === 'Enter' && status === 'intro') startPlaying();\n    };\n    const onKeyUp = e => {\n      if (e.code === 'ArrowDown') crouch(false);\n    };\n    window.addEventListener('keydown', onKeyDown);\n    window.addEventListener('keyup', onKeyUp);\n    return () => {\n      window.removeEventListener('keydown', onKeyDown);\n      window.removeEventListener('keyup', onKeyUp);\n    };\n  }, [status]);\n  const togglePause = () => {\n    if (status === 'playing') setStatus('paused');else if (status === 'paused') setStatus('playing');\n  };\n  const jump = () => {\n    const p = WORLD.current.player;\n    if (p.onGround) {\n      p.vy = -WORLD.current.jumpV;\n      p.onGround = false;\n    }\n  };\n  const crouch = on => {\n    const p = WORLD.current.player;\n    if (on) {\n      if (!p.onGround) p.vy += WORLD.current.fastFallBoost * 0.04; // caÃ­da rÃ¡pida\n      else if (!p.crouching) {\n        p.crouching = true;\n        const prevBottom = p.y + p.h;\n        p.h = 32; // reducir un poco la altura\n        p.y = prevBottom - p.h;\n      }\n    } else if (p.crouching) {\n      const prevBottom = p.y + p.h;\n      p.h = 48;\n      p.y = prevBottom - p.h;\n      p.crouching = false;\n    }\n  };\n  const handlePlayFullscreen = async () => {\n    try {\n      var _containerRef$current;\n      if ((_containerRef$current = containerRef.current) !== null && _containerRef$current !== void 0 && _containerRef$current.requestFullscreen) await containerRef.current.requestFullscreen();\n    } catch {}\n    resetWorld();\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) {\n      audioEl.currentTime = 0;\n      audioEl.play();\n      audioEl.muted = muted;\n    }\n    if (!INTRO_SHOWN.current) {\n      setStatus('intro');\n      INTRO_SHOWN.current = true;\n    } else {\n      startPlaying();\n    }\n  };\n  const startPlaying = () => {\n    const w = WORLD.current;\n    w.lastTs = 0;\n    w.startTs = 0;\n    // Mostrar primer momento inmediatamente\n    STORY.current.index = 0;\n    STORY.current.bannerText = STORY_MOMENTS.current[0].text;\n    STORY.current.bannerTimer = 4.2; // mostrar 4.2s\n    STORY.current.bannerAlpha = 0; // animar fade-in\n    setCurrentStoryMoment(STORY.current.bannerText);\n    // construir buffers y capas\n    rebuildStoryBuffers(STORY.current.bannerText);\n    rebuildParallaxLayers();\n    setStatus('playing');\n  };\n  const handleRetry = () => {\n    resetWorld();\n    setCurrentStoryMoment(null);\n    startPlaying();\n  };\n  const update = (dt, ts) => {\n    const w = WORLD.current;\n    if (status === 'menu') return;\n    if (status === 'intro') {\n      INTRO.current.offset -= INTRO.current.speed * dt;\n      if (INTRO.current.offset < -140) startPlaying();\n      return;\n    }\n    if (status === 'paused') return;\n    if (status !== 'playing') return;\n\n    // Tiempo de juego\n    if (w.startTs === 0) w.startTs = ts;\n    const elapsed = (ts - w.startTs) / 1000;\n    const remaining = Math.max(0, GAME_DURATION - elapsed);\n    TIMELEFT.current = remaining;\n\n    // Narrativa basada en tiempo -> Ã­ndice\n    const maxIndex = STORY_MOMENTS.current.length - 1;\n    const idx = Math.min(Math.floor(elapsed / 30), maxIndex);\n    if (idx !== STORY.current.index) {\n      STORY.current.index = idx;\n      STORY.current.bannerText = STORY_MOMENTS.current[idx].text;\n      STORY.current.bannerTimer = 4.2;\n      setCurrentStoryMoment(STORY.current.bannerText);\n      // reconstruir buffers en cada cambio de momento\n      rebuildStoryBuffers(STORY.current.bannerText);\n    }\n\n    // AnimaciÃ³n del banner (fade in/out)\n    if (STORY.current.bannerTimer > 0) {\n      STORY.current.bannerTimer -= dt;\n      STORY.current.bannerAlpha = Math.min(1, STORY.current.bannerAlpha + dt * 3);\n    } else {\n      STORY.current.bannerAlpha = Math.max(0, STORY.current.bannerAlpha - dt * 2);\n    }\n    if (remaining <= 0.01) {\n      setStatus('win');\n      return;\n    }\n\n    // ProgresiÃ³n de dificultad\n    const tFactor = Math.min(1, elapsed / GAME_DURATION);\n    w.speed = 240 + (w.maxSpeed - 240) * tFactor;\n    w.spawnInterval = 1.3 - 0.8 * tFactor;\n\n    // Parallax scrolling\n    w.parallax.skyShift += w.speed * 0.08 * dt;\n    w.parallax.cityShift += w.speed * 0.25 * dt;\n    w.parallax.hillShift += w.speed * 0.45 * dt;\n\n    // Avance mundo\n    w.worldX += w.speed * dt;\n\n    // FÃ­sica jugador\n    const p = w.player;\n    p.vy += w.gravity * dt;\n    p.y += p.vy * dt;\n    const groundY = w.groundY - p.h;\n    if (p.y >= groundY) {\n      p.y = groundY;\n      p.vy = 0;\n      p.onGround = true;\n    } else {\n      p.onGround = false;\n    }\n\n    // Spawn obstÃ¡culos\n    w.spawnTimer -= dt;\n    if (w.spawnTimer <= 0) {\n      spawnObstacle(w);\n      w.spawnTimer = w.spawnInterval * (0.9 + Math.random() * 0.4);\n    }\n\n    // Colisiones + puntuaciÃ³n\n    for (const o of w.obstacles) {\n      const sx = o.x - w.worldX + p.x;\n      o.screenX = sx;\n      if (!o.scored && sx + o.w < p.x) {\n        o.scored = true;\n        SCORE.current += 100;\n      }\n      const collide = rectOverlap(p.x, p.y, p.w, p.h, sx, o.y, o.w, o.h);\n      if (collide) {\n        setStatus('gameover');\n        break;\n      }\n    }\n\n    // Limpiar\n    w.obstacles = w.obstacles.filter(o => o.screenX > -140);\n    SCORE.current += Math.floor(w.speed * dt * 0.6);\n  };\n  const render = (ctx, canvas) => {\n    const w = WORLD.current;\n    const p = w.player;\n\n    // Asegurar capas\n    rebuildParallaxLayers();\n\n    // Fondo\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    if (status === 'intro') {\n      drawIntroBackground(ctx, canvas);\n      drawIntro(ctx, canvas, INTRO.current.lines, INTRO.current.offset);\n      drawSkipHint(ctx, canvas, 'Pulsa Enter para saltar');\n      return;\n    }\n\n    // Cielo (gradiente + nubes suaves)\n    drawSky(ctx, canvas, w.parallax.skyShift);\n    // Colinas y ciudad desde capas (tiled)\n    if (LAYERS.current.hills) drawLayerTiled(ctx, LAYERS.current.hills, w.parallax.hillShift);\n    if (LAYERS.current.city) drawLayerTiled(ctx, LAYERS.current.city, w.parallax.cityShift);\n\n    // Marca de agua narrativa sutil\n    const momentText = currentStoryMoment || STORY_MOMENTS.current[0].text;\n    if (BUFFERS.current.watermark) ctx.drawImage(BUFFERS.current.watermark, 0, 0);else drawStoryWatermark(ctx, canvas, momentText);\n\n    // Suelo\n    ctx.fillStyle = '#bfe3ff';\n    ctx.fillRect(0, w.groundY + 12, canvas.width, 4);\n\n    // ObstÃ¡culos\n    for (const o of w.obstacles) {\n      if (o.screenX < -80 || o.screenX > canvas.width + 120) continue;\n      if (o.type === 'low') drawObstacleLow(ctx, o.screenX, o.y, o.w, o.h);else drawObstacleHigh(ctx, o.screenX, o.y, o.w, o.h);\n    }\n\n    // Pareja (sticker conjunto)\n    drawCouple(ctx, p.x, p.y, p.w, p.h, !p.onGround, p.crouching);\n\n    // HUD\n    drawHUD(ctx, canvas, {\n      score: SCORE.current,\n      time: TIMELEFT.current,\n      status\n    });\n\n    // Banner de momento especial (animado)\n    if (STORY.current.bannerAlpha > 0) {\n      if (BUFFERS.current.banner) {\n        ctx.save();\n        ctx.globalAlpha = STORY.current.bannerAlpha;\n        const bx = (canvas.width - BUFFERS.current.banner.width) / 2;\n        const by = 6;\n        ctx.drawImage(BUFFERS.current.banner, bx, by);\n        ctx.restore();\n      } else {\n        drawStoryBanner(ctx, canvas, momentText, STORY.current.bannerAlpha);\n      }\n    }\n    if (status === 'paused') {\n      drawOverlay(ctx, canvas, 'Pausa â¸', 'Pulsa P para continuar');\n      return;\n    }\n    if (status === 'gameover') {\n      drawOverlay(ctx, canvas, 'Â¡Ups! Te has tropezado', 'Pulsa R para volver al menÃº');\n    } else if (status === 'win') {\n      drawOverlay(ctx, canvas, 'Â¡Llegaste a tiempo! ðŸ’’', `PuntuaciÃ³n: ${Math.floor(SCORE.current)} Â· Pulsa R para menÃº`);\n    }\n  };\n  const toggleMute = () => {\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) {\n      audioEl.muted = !audioEl.muted;\n      setMuted(audioEl.muted);\n    } else setMuted(m => !m);\n  };\n  useEffect(() => () => {\n    const audioEl = document.getElementById('bg-music');\n    if (audioEl) audioEl.pause();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    style: {\n      maxWidth: 980,\n      margin: '0 auto',\n      padding: '1rem',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        textAlign: 'center',\n        marginBottom: '.5rem'\n      },\n      children: \"Camino a la iglesia\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 475,\n      columnNumber: 7\n    }, this), status === 'menu' && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        inset: 0,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'linear-gradient(135deg, rgba(255,255,255,.95), rgba(238,242,255,.95))',\n        zIndex: 5,\n        borderRadius: 12\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 'min(92%, 620px)',\n          padding: '1.25rem',\n          borderRadius: 12,\n          boxShadow: '0 8px 28px rgba(0,0,0,.18)',\n          background: 'white'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            marginTop: 0,\n            textAlign: 'center'\n          },\n          children: \"\\xA1Acompa\\xF1a a Ana y Dani!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: 'center',\n            color: '#64748b',\n            marginTop: 4\n          },\n          children: \"Esquiva obst\\xE1culos durante 5 minutos. La historia de la pareja aparecer\\xE1 como momentos especiales cada 30s.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '1rem',\n            justifyContent: 'center',\n            marginTop: '1rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handlePlayFullscreen,\n            style: primaryBtn,\n            children: \"\\u25B6 Jugar en pantalla completa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              resetWorld();\n              startPlaying();\n            },\n            style: secondaryBtn,\n            children: \"\\u25B7 Jugar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        borderRadius: 12,\n        overflow: 'hidden',\n        boxShadow: '0 6px 24px rgba(0,0,0,.12)',\n        background: 'white',\n        position: 'relative'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n        id: \"bg-music\",\n        src: \"/musica-boda.mp3\",\n        loop: true,\n        autoPlay: false,\n        style: {\n          display: 'none'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 493,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleMute,\n        \"aria-label\": muted ? 'Activar sonido' : 'Silenciar sonido',\n        style: {\n          position: 'absolute',\n          right: 8,\n          top: 8,\n          zIndex: 8,\n          background: 'rgba(0,0,0,.55)',\n          color: '#fff',\n          border: 0,\n          borderRadius: 999,\n          width: 36,\n          height: 36,\n          cursor: 'pointer'\n        },\n        children: muted ? 'ðŸ”‡' : 'ðŸ”Š'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 9\n      }, this), (status === 'playing' || status === 'paused') && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: togglePause,\n        style: {\n          position: 'absolute',\n          right: 52,\n          top: 8,\n          zIndex: 8,\n          background: 'rgba(0,0,0,.55)',\n          color: '#fff',\n          border: 0,\n          borderRadius: 999,\n          width: 36,\n          height: 36,\n          cursor: 'pointer'\n        },\n        children: status === 'paused' ? 'â–¶' : 'â¸'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 11\n      }, this), status === 'intro' && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startPlaying,\n        style: {\n          position: 'absolute',\n          right: 8,\n          bottom: 8,\n          zIndex: 8,\n          background: 'rgba(0,0,0,.55)',\n          color: '#fff',\n          border: 0,\n          borderRadius: 8,\n          padding: '.4rem .6rem',\n          cursor: 'pointer'\n        },\n        children: \"Saltar intro\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: 900,\n        height: 280,\n        style: {\n          width: '100%',\n          display: 'block',\n          background: status === 'intro' ? '#000' : 'linear-gradient(#eef2ff, #fff)'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 9\n      }, this), status === 'playing' && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          inset: 'auto 0 0 0',\n          display: 'flex',\n          justifyContent: 'space-between',\n          padding: '8px 10px',\n          pointerEvents: 'none'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onMouseDown: jump,\n          onTouchStart: jump,\n          style: touchBtn,\n          children: \"\\u2B9D Saltar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onMouseDown: () => crouch(true),\n          onMouseUp: () => crouch(false),\n          onTouchStart: () => crouch(true),\n          onTouchEnd: () => crouch(false),\n          style: touchBtn,\n          children: \"\\u2B9F Agachar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 11\n      }, this), (status === 'gameover' || status === 'win') && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          inset: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 7\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: 'rgba(17,24,39,.88)',\n            color: '#fff',\n            padding: '1rem 1.25rem',\n            borderRadius: 12,\n            boxShadow: '0 8px 28px rgba(0,0,0,.35)',\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: 700,\n              fontSize: 18,\n              marginBottom: 8\n            },\n            children: status === 'win' ? 'Â¡Llegaste a tiempo! ðŸ’’' : 'Â¡Ups! Te has tropezado'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: 14,\n              opacity: .9,\n              marginBottom: 12\n            },\n            children: [\"Puntuaci\\xF3n: \", Math.floor(SCORE.current)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 517,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleRetry,\n            style: {\n              background: '#22c55e',\n              color: '#0b1a0f',\n              border: 0,\n              padding: '.5rem 1rem',\n              borderRadius: 10,\n              fontWeight: 700,\n              cursor: 'pointer'\n            },\n            children: \"\\u21BB Reintentar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 474,\n    columnNumber: 5\n  }, this);\n}\n\n// Estilos de botones\n_s(Game, \"odvvUUiMi1h0FK2sTSjnFCS6noc=\");\n_c = Game;\nconst primaryBtn = {\n  background: 'linear-gradient(135deg, #6366f1, #8b5cf6)',\n  color: 'white',\n  border: 0,\n  padding: '.75rem 1.25rem',\n  borderRadius: 10,\n  fontWeight: 700,\n  cursor: 'pointer',\n  boxShadow: '0 6px 18px rgba(99,102,241,.35)'\n};\nconst secondaryBtn = {\n  background: '#111827',\n  color: 'white',\n  border: 0,\n  padding: '.75rem 1.25rem',\n  borderRadius: 10,\n  fontWeight: 700,\n  cursor: 'pointer'\n};\nconst touchBtn = {\n  pointerEvents: 'auto',\n  background: 'rgba(0,0,0,.55)',\n  color: '#fff',\n  border: 0,\n  borderRadius: 10,\n  padding: '.5rem .75rem',\n  fontWeight: 700\n};\n\n// Utilidades\nfunction rectOverlap(ax, ay, aw, ah, bx, by, bw, bh) {\n  return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;\n}\nfunction formatTime(t) {\n  const s = Math.max(0, Math.floor(t));\n  const mm = String(Math.floor(s / 60)).padStart(2, '0');\n  const ss = String(s % 60).padStart(2, '0');\n  return `${mm}:${ss}`;\n}\nfunction wrapText(ctx, text, maxWidth) {\n  const words = text.split(' ');\n  let lines = [],\n    current = '';\n  for (const w of words) {\n    const test = current ? current + ' ' + w : w;\n    if (ctx.measureText(test).width > maxWidth && current) {\n      lines.push(current);\n      current = w;\n    } else current = test;\n  }\n  if (current) lines.push(current);\n  return lines;\n}\nfunction spawnObstacle(w) {\n  const type = Math.random() < 0.55 ? 'low' : 'high';\n  if (type === 'low') {\n    const width = 28 + Math.random() * 18;\n    const height = 22 + Math.random() * 22;\n    const x = w.worldX + 900 + Math.random() * 120;\n    const y = w.groundY - height;\n    w.obstacles.push({\n      type,\n      x,\n      y,\n      w: width,\n      h: height,\n      scored: false,\n      screenX: 0\n    });\n  } else {\n    const width = 84 + Math.random() * 70;\n    const height = 18;\n    const x = w.worldX + 900 + Math.random() * 120;\n    const y = w.groundY - (48 + 12);\n    w.obstacles.push({\n      type,\n      x,\n      y,\n      w: width,\n      h: height,\n      scored: false,\n      screenX: 0\n    });\n  }\n}\n\n// Dibujo UI\nfunction drawHUD(ctx, canvas, {\n  score,\n  time,\n  status\n}) {\n  ctx.save();\n  // Barra superior\n  ctx.globalAlpha = 0.9;\n  ctx.fillStyle = 'rgba(255,255,255,0.9)';\n  roundRect(ctx, 8, 8, canvas.width - 16, 34, 8);\n  ctx.fill();\n\n  // PuntuaciÃ³n\n  ctx.fillStyle = '#334155';\n  ctx.font = 'bold 12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'left';\n  ctx.fillText(`Puntos: ${Math.floor(score)}`, 16, 30);\n\n  // Tiempo restante + barra\n  ctx.textAlign = 'right';\n  ctx.fillText(`Tiempo: ${formatTime(time)}`, canvas.width - 16, 30);\n  const pct = Math.max(0, Math.min(1, time / 300));\n  const barW = (canvas.width - 16) * pct;\n  ctx.globalAlpha = 1;\n  ctx.fillStyle = '#22c55e';\n  roundRect(ctx, 8, 46, barW, 6, 3);\n  ctx.fill();\n  ctx.restore();\n}\nfunction drawIntroBackground(ctx, canvas) {\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\n  g.addColorStop(0, '#000');\n  g.addColorStop(1, '#1f2937');\n  ctx.fillStyle = g;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n}\nfunction drawIntro(ctx, canvas, lines, offset) {\n  ctx.save();\n  ctx.fillStyle = '#10b981';\n  ctx.textAlign = 'center';\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  const centerX = canvas.width / 2;\n  let y = canvas.height + offset;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const scale = 1 - i * 0.05;\n    ctx.save();\n    ctx.translate(centerX, y);\n    ctx.scale(scale, scale);\n    ctx.fillText(line, 0, 0);\n    ctx.restore();\n    y += 36;\n  }\n  ctx.restore();\n}\nfunction drawSkipHint(ctx, canvas, text) {\n  ctx.save();\n  ctx.fillStyle = 'rgba(255,255,255,0.2)';\n  roundRect(ctx, canvas.width - 165, canvas.height - 36, 156, 26, 8);\n  ctx.fill();\n  ctx.fillStyle = '#e5e7eb';\n  ctx.font = '12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'right';\n  ctx.fillText(text, canvas.width - 12, canvas.height - 18);\n  ctx.restore();\n}\nfunction drawSky(ctx, canvas, shift) {\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\n  g.addColorStop(0, '#e8f0ff');\n  g.addColorStop(1, '#ffffff');\n  ctx.fillStyle = g;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  // nubes suaves\n  ctx.save();\n  ctx.globalAlpha = 0.25;\n  ctx.fillStyle = '#ffffff';\n  for (let i = 0; i < 6; i++) {\n    const x = (i * 180 - shift * 0.3 % (canvas.width + 200) + canvas.width + 200) % (canvas.width + 200) - 100;\n    ctx.beginPath();\n    ctx.ellipse(x, 60 + i % 2 * 18, 70, 20, 0, 0, Math.PI * 2);\n    ctx.fill();\n  }\n  ctx.restore();\n}\nfunction drawCity(ctx, canvas, shift) {/* deprecated by prerendered layers */}\nfunction drawHills(ctx, canvas, shift) {/* deprecated by prerendered layers */}\nfunction drawLayerTiled(ctx, layerCanvas, shift) {\n  const w = layerCanvas.width;\n  let offset = -(shift % w);\n  if (offset > 0) offset -= w;\n  ctx.drawImage(layerCanvas, offset, 0);\n  ctx.drawImage(layerCanvas, offset + w, 0);\n}\nfunction drawObstacleLow(ctx, x, y, w, h) {\n  ctx.save();\n  ctx.fillStyle = '#94a3b8';\n  ctx.strokeStyle = '#475569';\n  ctx.lineWidth = 2;\n  roundRect(ctx, x, y, w, h, 6);\n  ctx.fill();\n  ctx.stroke();\n  ctx.restore();\n}\nfunction drawObstacleHigh(ctx, x, y, w, h) {\n  ctx.save();\n  ctx.fillStyle = '#9ca3af';\n  roundRect(ctx, x, y + h - 30, 4, 30, 2);\n  roundRect(ctx, x + w - 4, y + h - 30, 4, 30, 2);\n  ctx.fill();\n  ctx.fillStyle = '#22c55e';\n  roundRect(ctx, x, y, w, h, 6);\n  ctx.fill();\n  ctx.restore();\n}\n\n// Sticker conjunto: novio + novia cogidos de la mano\nfunction drawCouple(ctx, x, y, w, h, jumping, crouching) {\n  ctx.save();\n  // Sombra\n  if (jumping) {\n    ctx.globalAlpha = 0.2;\n    ctx.fillStyle = '#000';\n    ctx.beginPath();\n    ctx.ellipse(x + w * 0.5, y + h + 10, w * 0.7, 5, 0, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.globalAlpha = 1;\n  }\n\n  // Novia (izquierda)\n  const nx = x - 16;\n  const ny = y;\n  const nw = Math.floor(w * 0.48);\n  const nh = h;\n  ctx.fillStyle = '#f8fafc';\n  roundRect(ctx, nx - 2, ny + nh * 0.35, nw + 4, nh * 0.65, 10); // vestido\n  ctx.fill();\n  ctx.fillStyle = '#e5e7eb';\n  roundRect(ctx, nx, ny, nw, nh * 0.45, 8); // torso\n  ctx.fill();\n  ctx.fillStyle = '#fde68a';\n  ctx.beginPath();\n  ctx.arc(nx + nw / 2, crouching ? ny - 4 : ny - 6, 10, 0, Math.PI * 2); // cabeza\n  ctx.fill();\n  // velo\n  ctx.globalAlpha = 0.6;\n  ctx.fillStyle = '#e0f2fe';\n  roundRect(ctx, nx - 6, ny - 6, nw + 12, 16, 8);\n  ctx.fill();\n  ctx.globalAlpha = 1;\n\n  // Novio (derecha)\n  const gx = x + nw - 4;\n  const gy = y;\n  const gw = Math.floor(w * 0.52);\n  const gh = h;\n  ctx.fillStyle = '#1f2937';\n  roundRect(ctx, gx, gy, gw, gh, 8);\n  ctx.fill(); // traje\n  ctx.fillStyle = '#fde68a';\n  ctx.beginPath();\n  ctx.arc(gx + gw / 2, crouching ? gy - 4 : gy - 6, 10, 0, Math.PI * 2);\n  ctx.fill(); // cabeza\n  ctx.fillStyle = '#ef4444';\n  ctx.fillRect(gx + gw / 2 - 3, gy + 10, 6, 10); // corbata\n\n  // Manos unidas (corazÃ³n pequeÃ±o)\n  ctx.fillStyle = '#ef4444';\n  ctx.beginPath();\n  const mx = gx - 4;\n  const my = y + h * 0.48;\n  ctx.arc(mx - 3, my, 3, 0, Math.PI * 2);\n  ctx.arc(mx + 3, my, 3, 0, Math.PI * 2);\n  ctx.moveTo(mx - 6, my);\n  ctx.lineTo(mx, my + 6);\n  ctx.lineTo(mx + 6, my);\n  ctx.fill();\n  ctx.restore();\n}\nfunction drawStoryWatermark(ctx, canvas, momentText) {\n  ctx.save();\n  ctx.globalAlpha = 0.12;\n  const gradient = ctx.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width * 0.9);\n  gradient.addColorStop(0, '#fbbf24');\n  gradient.addColorStop(0.5, '#f59e0b');\n  gradient.addColorStop(1, 'transparent');\n  ctx.fillStyle = gradient;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  // Texto grande sutil\n  ctx.globalAlpha = 0.22;\n  ctx.fillStyle = '#92400e';\n  ctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  const words = momentText.split(' ');\n  let lines = [];\n  let currentLine = '';\n  for (const word of words) {\n    const test = currentLine + (currentLine ? ' ' : '') + word;\n    if (ctx.measureText(test).width > canvas.width * 0.7 && currentLine) {\n      lines.push(currentLine);\n      currentLine = word;\n    } else currentLine = test;\n  }\n  if (currentLine) lines.push(currentLine);\n  const lineHeight = 40;\n  const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;\n  for (let i = 0; i < lines.length; i++) ctx.fillText(lines[i], canvas.width / 2, startY + i * lineHeight);\n  ctx.restore();\n}\nfunction drawStoryBanner(ctx, canvas, text, alpha) {\n  ctx.save();\n  ctx.globalAlpha = Math.max(0, Math.min(1, alpha));\n  ctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\n  const padding = 12;\n  ctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  const textW = ctx.measureText(text).width;\n  const boxW = Math.min(canvas.width - 24, textW + padding * 2 + 40);\n  const boxH = 42;\n  const boxX = (canvas.width - boxW) / 2;\n  const boxY = 6; // elevado\n  roundRect(ctx, boxX, boxY, boxW, boxH, 10);\n  ctx.fill();\n  ctx.strokeStyle = '#d97706';\n  ctx.lineWidth = 2;\n  ctx.stroke();\n  ctx.fillStyle = '#92400e';\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.fillText('ðŸ’• ' + text + ' ðŸ’•', canvas.width / 2, boxY + boxH / 2);\n  ctx.restore();\n}\nfunction drawOverlay(ctx, canvas, title, subtitle) {\n  ctx.save();\n  ctx.fillStyle = 'rgba(0,0,0,0.45)';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = '#fff';\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.textAlign = 'center';\n  ctx.fillText(title, canvas.width / 2, canvas.height / 2 - 6);\n  ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\n  ctx.fillText(subtitle, canvas.width / 2, canvas.height / 2 + 18);\n  ctx.restore();\n}\nfunction roundRect(ctx, x, y, w, h, r) {\n  ctx.beginPath();\n  ctx.moveTo(x + r, y);\n  ctx.arcTo(x + w, y, x + w, y + h, r);\n  ctx.arcTo(x + w, y + h, x, y + h, r);\n  ctx.arcTo(x, y + h, x, y, r);\n  ctx.arcTo(x, y, x + w, y, r);\n  ctx.closePath();\n}\nvar _c;\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","Game","_s","containerRef","canvasRef","status","setStatus","muted","setMuted","GAME_DURATION","SCORE","TIMELEFT","INTRO_SHOWN","INTRO","offset","speed","lines","STORY_MOMENTS","text","timeStart","STORY","index","bannerText","bannerAlpha","bannerTimer","currentStoryMoment","setCurrentStoryMoment","BUFFERS","width","height","watermark","banner","LAYERS","city","hills","rebuildStoryBuffers","canvas","current","sameSize","sameText","wm","document","createElement","wctx","getContext","globalAlpha","gradient","createRadialGradient","addColorStop","fillStyle","fillRect","font","textAlign","textBaseline","wrapText","lh","sy","length","i","fillText","pad","fullText","textW","measureText","boxW","Math","min","boxH","bn","ceil","bctx","roundRect","fill","strokeStyle","lineWidth","stroke","rebuildParallaxLayers","cctx","baseY","steps","w","h","x","hctx","hSteps","beginPath","ellipse","PI","onResize","txt","window","addEventListener","removeEventListener","resetWorld","_WORLD","WORLD","console","warn","worldX","lastTs","startTs","spawnInterval","spawnTimer","obstacles","parallax","skyShift","cityShift","hillShift","player","y","groundY","vy","onGround","crouching","ctx","rafId","loop","ts","dt","update","render","requestAnimationFrame","cancelAnimationFrame","onKeyDown","e","repeat","code","jump","crouch","togglePause","handlePlayFullscreen","startPlaying","onKeyUp","p","jumpV","on","fastFallBoost","prevBottom","_containerRef$current","requestFullscreen","audioEl","getElementById","currentTime","play","handleRetry","elapsed","remaining","max","maxIndex","idx","floor","tFactor","maxSpeed","gravity","spawnObstacle","random","o","sx","screenX","scored","collide","rectOverlap","filter","clearRect","drawIntroBackground","drawIntro","drawSkipHint","drawSky","drawLayerTiled","momentText","drawImage","drawStoryWatermark","type","drawObstacleLow","drawObstacleHigh","drawCouple","drawHUD","score","time","save","bx","by","restore","drawStoryBanner","drawOverlay","toggleMute","m","pause","ref","style","maxWidth","margin","padding","position","children","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","inset","display","alignItems","justifyContent","background","zIndex","borderRadius","boxShadow","marginTop","color","gap","onClick","primaryBtn","secondaryBtn","overflow","id","src","autoPlay","right","top","border","cursor","bottom","pointerEvents","onMouseDown","onTouchStart","touchBtn","onMouseUp","onTouchEnd","fontWeight","fontSize","opacity","_c","ax","ay","aw","ah","bw","bh","formatTime","t","s","mm","String","padStart","ss","words","split","test","push","pct","barW","g","createLinearGradient","centerX","line","scale","translate","shift","drawCity","drawHills","layerCanvas","jumping","nx","ny","nw","nh","arc","gx","gy","gw","gh","mx","my","moveTo","lineTo","currentLine","word","lineHeight","startY","alpha","boxX","boxY","title","subtitle","r","arcTo","closePath","$RefreshReg$"],"sources":["C:/Users/DanielGarcÃ­aCarabelo/Downloads/pag web boda 2.0/html/webreact/src/components/Game.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\n\r\n// Juego moderno: pareja camino a la iglesia, con narrativa cada 30s\r\nexport default function Game() {\r\n  const containerRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n\r\n  // Estado principal\r\n  const [status, setStatus] = useState('menu'); // menu | intro | playing | paused | win | gameover\r\n  const [muted, setMuted] = useState(false);\r\n\r\n  // ConfiguraciÃ³n de juego\r\n  const GAME_DURATION = 300; // 5 min\r\n  const SCORE = useRef(0);\r\n  const TIMELEFT = useRef(GAME_DURATION);\r\n  const INTRO_SHOWN = useRef(false);\r\n\r\n  // Intro estilo Star Wars\r\n  const INTRO = useRef({\r\n    offset: 320,\r\n    speed: 40, // mÃ¡s lento para una intro mÃ¡s larga\r\n    lines: [\r\n      'En una galaxia muy, muy cercana...',\r\n      'Dos estrellas destinadas a unirse brillan con fuerza.',\r\n      'El gran dÃ­a ha llegado y todos esperan en la iglesia.',\r\n      'Ayuda a la pareja a llegar a tiempo sorteando obstÃ¡culos...',\r\n      'Controles: â†‘ o ESPACIO para saltar, â†“ para agacharte o caer rÃ¡pido.',\r\n      'Pulsa P para pausar. R para reiniciar.',\r\n      'Â¡Que la fuerza del amor te acompaÃ±e!'\r\n    ]\r\n  });\r\n\r\n  // Momentos clave (cada 30s)\r\n  const STORY_MOMENTS = useRef([\r\n    { text: 'Ana y Dani en la Facultad de Derecho de la USC ðŸ›ï¸', timeStart: 0 },\r\n    { text: 'Ana preparando las oposiciones para Jueza âš–ï¸', timeStart: 30 },\r\n    { text: 'Dani cursando el MÃ¡ster de AbogacÃ­a ðŸ“–', timeStart: 60 },\r\n    { text: 'Dani empezando a trabajar como abogado ðŸ’¼', timeStart: 90 },\r\n    { text: 'Dani trabajando en PorriÃ±o ðŸ¢', timeStart: 120 },\r\n    { text: 'Dani mudÃ¡ndose a CarballiÃ±o ðŸ ', timeStart: 150 },\r\n    { text: 'Ana trabajando en Ponteareas ðŸ›ï¸', timeStart: 180 },\r\n    { text: 'Ana aprobando la oposiciÃ³n en Pontevedra ðŸŽ‰', timeStart: 210 },\r\n    { text: 'Ana y Dani viviendo juntos en Pontevedra ðŸ’•', timeStart: 240 },\r\n    { text: 'La pedida en la Torre de HÃ©rcules ðŸ’', timeStart: 270 },\r\n    { text: 'Â¡Y hoy... la boda! ðŸ‘°ðŸ’’ðŸ¤µ', timeStart: 300 }\r\n  ]);\r\n\r\n  // Narrativa actual con banner animado\r\n  const STORY = useRef({ index: -1, bannerText: '', bannerAlpha: 0, bannerTimer: 0 });\r\n  const [currentStoryMoment, setCurrentStoryMoment] = useState(null);\r\n  // Buffers para optimizar render de textos/gradientes\r\n  const BUFFERS = useRef({ width: 0, height: 0, text: '', watermark: null, banner: null });\r\n  // Capas prerenderizadas para parallax\r\n  const LAYERS = useRef({ width: 0, height: 0, city: null, hills: null });\r\n\r\n  // Reconstruir buffers de watermark y banner cuando cambie el texto o el tamaÃ±o\r\n  const rebuildStoryBuffers = (text) => {\r\n    const canvas = canvasRef.current; if (!canvas) return;\r\n    const width = canvas.width, height = canvas.height;\r\n    const sameSize = BUFFERS.current.width === width && BUFFERS.current.height === height;\r\n    const sameText = BUFFERS.current.text === text;\r\n    if (sameSize && sameText && BUFFERS.current.watermark && BUFFERS.current.banner) return;\r\n\r\n    BUFFERS.current.width = width; BUFFERS.current.height = height; BUFFERS.current.text = text;\r\n\r\n    // Watermark prerender\r\n    const wm = document.createElement('canvas'); wm.width = width; wm.height = height;\r\n    const wctx = wm.getContext('2d');\r\n    wctx.globalAlpha = 0.12;\r\n    const gradient = wctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, width*0.9);\r\n    gradient.addColorStop(0, '#fbbf24'); gradient.addColorStop(0.5, '#f59e0b'); gradient.addColorStop(1, 'transparent');\r\n    wctx.fillStyle = gradient; wctx.fillRect(0,0,width,height);\r\n    wctx.globalAlpha = 0.22; wctx.fillStyle = '#92400e';\r\n    wctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n    wctx.textAlign = 'center'; wctx.textBaseline = 'middle';\r\n    const lines = wrapText(wctx, text, width * 0.7);\r\n    const lh = 40; const sy = height/2 - (lines.length - 1) * lh / 2;\r\n    for (let i = 0; i < lines.length; i++) wctx.fillText(lines[i], width/2, sy + i * lh);\r\n    BUFFERS.current.watermark = wm;\r\n\r\n    // Banner prerender\r\n    const pad = 12;\r\n    wctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n    const fullText = 'ðŸ’• ' + text + ' ðŸ’•';\r\n    const textW = wctx.measureText(fullText).width;\r\n    const boxW = Math.min(width - 24, textW + pad * 2 + 40);\r\n    const boxH = 42;\r\n    const bn = document.createElement('canvas'); bn.width = Math.ceil(boxW); bn.height = boxH;\r\n    const bctx = bn.getContext('2d');\r\n    bctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\r\n    roundRect(bctx, 0, 0, boxW, boxH, 10); bctx.fill();\r\n    bctx.strokeStyle = '#d97706'; bctx.lineWidth = 2; bctx.stroke();\r\n    bctx.fillStyle = '#92400e';\r\n    bctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n    bctx.textAlign = 'center'; bctx.textBaseline = 'middle';\r\n    bctx.fillText(fullText, boxW / 2, boxH / 2);\r\n    BUFFERS.current.banner = bn;\r\n  };\r\n\r\n  // Prerender de capas city/hills para parallax\r\n  const rebuildParallaxLayers = () => {\r\n    const canvas = canvasRef.current; if (!canvas) return;\r\n    const width = canvas.width, height = canvas.height;\r\n    if (LAYERS.current.width === width && LAYERS.current.height === height && LAYERS.current.city && LAYERS.current.hills) return;\r\n    LAYERS.current.width = width; LAYERS.current.height = height;\r\n\r\n    // City layer\r\n    const city = document.createElement('canvas');\r\n    city.width = width + 200; city.height = height;\r\n    const cctx = city.getContext('2d');\r\n    cctx.fillStyle = '#c7d2fe';\r\n    const baseY = 180;\r\n    const steps = Math.ceil((city.width + 200) / 90);\r\n    for (let i = 0; i < steps; i++) {\r\n      const w = 40 + (i % 3) * 10;\r\n      const h = 30 + (i % 5) * 18;\r\n      const x = -100 + i * 90;\r\n      roundRect(cctx, x, baseY - h, w, h, 4);\r\n      cctx.fill();\r\n    }\r\n    LAYERS.current.city = city;\r\n\r\n    // Hills layer\r\n    const hills = document.createElement('canvas');\r\n    hills.width = width + 300; hills.height = height;\r\n    const hctx = hills.getContext('2d');\r\n    hctx.fillStyle = '#93c5fd';\r\n    const hSteps = Math.ceil((hills.width + 300) / 260);\r\n    for (let i = 0; i < hSteps; i++) {\r\n      const x = -150 + i * 260;\r\n      hctx.beginPath();\r\n      hctx.ellipse(x, 220, 180, 36, 0, 0, Math.PI * 2);\r\n      hctx.fill();\r\n    }\r\n    LAYERS.current.hills = hills;\r\n  };\r\n\r\n  // Redibujar buffers al redimensionar\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      const txt = currentStoryMoment || STORY_MOMENTS.current[0].text;\r\n      rebuildStoryBuffers(txt);\r\n      // forzar rebuild de layers\r\n      LAYERS.current.width = 0; LAYERS.current.height = 0;\r\n      rebuildParallaxLayers();\r\n    };\r\n    window.addEventListener('resize', onResize);\r\n    onResize();\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, [currentStoryMoment]);\r\n\r\n  // Reset limpio\r\n  const resetWorld = () => {\r\n    // Guarda defensiva: en algunos ciclos de montaje (StrictMode) el cierre puede aÃºn no exponer WORLD\r\n    if (typeof WORLD === 'undefined' || !WORLD?.current) {\r\n      console.warn('WORLD aÃºn no estÃ¡ listo para resetWorld');\r\n      return;\r\n    }\r\n\r\n    SCORE.current = 0;\r\n    TIMELEFT.current = GAME_DURATION;\r\n    STORY.current = { index: -1, bannerText: '', bannerAlpha: 0, bannerTimer: 0 };\r\n    setCurrentStoryMoment(null);\r\n\r\n    const w = WORLD.current;\r\n    w.worldX = 0;\r\n    w.lastTs = 0;\r\n    w.startTs = 0;\r\n    w.speed = 240;\r\n    w.spawnInterval = 1.3;\r\n    w.spawnTimer = 0.8;\r\n    w.obstacles = [];\r\n    w.parallax.skyShift = 0;\r\n    w.parallax.cityShift = 0;\r\n    w.parallax.hillShift = 0;\r\n    w.player = { x: 100, y: w.groundY - 48, w: 70, h: 48, vy: 0, onGround: true, crouching: false };\r\n  };\r\n\r\n  useEffect(() => {\r\n    resetWorld();\r\n    INTRO.current.offset = 320;\r\n  }, []);\r\n\r\n  // Bucle de juego\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    let rafId;\r\n    const loop = (ts) => {\r\n      const w = WORLD.current;\r\n      if (!w.lastTs) {\r\n        w.lastTs = ts;\r\n        if (!w.startTs && status === 'playing') w.startTs = ts;\r\n      }\r\n      const dt = Math.min(0.032, (ts - w.lastTs) / 1000);\r\n      w.lastTs = ts;\r\n\r\n      update(dt, ts);\r\n      render(ctx, canvas);\r\n      rafId = requestAnimationFrame(loop);\r\n    };\r\n\r\n    rafId = requestAnimationFrame(loop);\r\n    return () => cancelAnimationFrame(rafId);\r\n  }, [status]);\r\n\r\n  // Reiniciar intro al entrar\r\n  useEffect(() => {\r\n    if (status === 'intro') INTRO.current.offset = 320;\r\n  }, [status]);\r\n\r\n  // Entradas\r\n  useEffect(() => {\r\n    const onKeyDown = (e) => {\r\n      if (e.repeat) return;\r\n      if ((e.code === 'Space' || e.code === 'ArrowUp') && status === 'playing') jump();\r\n      if (e.code === 'ArrowDown' && status === 'playing') crouch(true);\r\n      if (e.code === 'KeyR' && (status === 'playing' || status === 'gameover' || status === 'win' || status === 'paused')) {\r\n        resetWorld();\r\n        setStatus('menu');\r\n      }\r\n      if (e.code === 'KeyP' && (status === 'playing' || status === 'paused')) togglePause();\r\n      if (e.code === 'Enter' && status === 'menu') handlePlayFullscreen();\r\n      if (e.code === 'Enter' && status === 'intro') startPlaying();\r\n    };\r\n    const onKeyUp = (e) => {\r\n      if (e.code === 'ArrowDown') crouch(false);\r\n    };\r\n\r\n    window.addEventListener('keydown', onKeyDown);\r\n    window.addEventListener('keyup', onKeyUp);\r\n    return () => {\r\n      window.removeEventListener('keydown', onKeyDown);\r\n      window.removeEventListener('keyup', onKeyUp);\r\n    };\r\n  }, [status]);\r\n\r\n  const togglePause = () => {\r\n    if (status === 'playing') setStatus('paused');\r\n    else if (status === 'paused') setStatus('playing');\r\n  };\r\n\r\n  const jump = () => {\r\n    const p = WORLD.current.player;\r\n    if (p.onGround) {\r\n      p.vy = -WORLD.current.jumpV;\r\n      p.onGround = false;\r\n    }\r\n  };\r\n\r\n  const crouch = (on) => {\r\n    const p = WORLD.current.player;\r\n    if (on) {\r\n      if (!p.onGround) p.vy += WORLD.current.fastFallBoost * 0.04; // caÃ­da rÃ¡pida\r\n      else if (!p.crouching) {\r\n        p.crouching = true;\r\n        const prevBottom = p.y + p.h;\r\n        p.h = 32; // reducir un poco la altura\r\n        p.y = prevBottom - p.h;\r\n      }\r\n    } else if (p.crouching) {\r\n      const prevBottom = p.y + p.h;\r\n      p.h = 48;\r\n      p.y = prevBottom - p.h;\r\n      p.crouching = false;\r\n    }\r\n  };\r\n\r\n  const handlePlayFullscreen = async () => {\r\n    try { if (containerRef.current?.requestFullscreen) await containerRef.current.requestFullscreen(); } catch {}\r\n    resetWorld();\r\n\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) { audioEl.currentTime = 0; audioEl.play(); audioEl.muted = muted; }\r\n\r\n    if (!INTRO_SHOWN.current) { setStatus('intro'); INTRO_SHOWN.current = true; }\r\n    else { startPlaying(); }\r\n  };\r\n\r\n  const startPlaying = () => {\r\n    const w = WORLD.current;\r\n    w.lastTs = 0;\r\n    w.startTs = 0;\r\n    // Mostrar primer momento inmediatamente\r\n    STORY.current.index = 0;\r\n    STORY.current.bannerText = STORY_MOMENTS.current[0].text;\r\n    STORY.current.bannerTimer = 4.2; // mostrar 4.2s\r\n    STORY.current.bannerAlpha = 0; // animar fade-in\r\n    setCurrentStoryMoment(STORY.current.bannerText);\r\n    // construir buffers y capas\r\n    rebuildStoryBuffers(STORY.current.bannerText);\r\n    rebuildParallaxLayers();\r\n    setStatus('playing');\r\n  };\r\n\r\n  const handleRetry = () => {\r\n    resetWorld();\r\n    setCurrentStoryMoment(null);\r\n    startPlaying();\r\n  };\r\n\r\n  const update = (dt, ts) => {\r\n    const w = WORLD.current;\r\n\r\n    if (status === 'menu') return;\r\n\r\n    if (status === 'intro') {\r\n      INTRO.current.offset -= INTRO.current.speed * dt;\r\n      if (INTRO.current.offset < -140) startPlaying();\r\n      return;\r\n    }\r\n\r\n    if (status === 'paused') return;\r\n    if (status !== 'playing') return;\r\n\r\n    // Tiempo de juego\r\n    if (w.startTs === 0) w.startTs = ts;\r\n    const elapsed = (ts - w.startTs) / 1000;\r\n    const remaining = Math.max(0, GAME_DURATION - elapsed);\r\n    TIMELEFT.current = remaining;\r\n\r\n    // Narrativa basada en tiempo -> Ã­ndice\r\n    const maxIndex = STORY_MOMENTS.current.length - 1;\r\n    const idx = Math.min(Math.floor(elapsed / 30), maxIndex);\r\n    if (idx !== STORY.current.index) {\r\n      STORY.current.index = idx;\r\n      STORY.current.bannerText = STORY_MOMENTS.current[idx].text;\r\n      STORY.current.bannerTimer = 4.2;\r\n      setCurrentStoryMoment(STORY.current.bannerText);\r\n      // reconstruir buffers en cada cambio de momento\r\n      rebuildStoryBuffers(STORY.current.bannerText);\r\n    }\r\n\r\n    // AnimaciÃ³n del banner (fade in/out)\r\n    if (STORY.current.bannerTimer > 0) {\r\n      STORY.current.bannerTimer -= dt;\r\n      STORY.current.bannerAlpha = Math.min(1, STORY.current.bannerAlpha + dt * 3);\r\n    } else {\r\n      STORY.current.bannerAlpha = Math.max(0, STORY.current.bannerAlpha - dt * 2);\r\n    }\r\n\r\n    if (remaining <= 0.01) { setStatus('win'); return; }\r\n\r\n    // ProgresiÃ³n de dificultad\r\n    const tFactor = Math.min(1, elapsed / GAME_DURATION);\r\n    w.speed = 240 + (w.maxSpeed - 240) * tFactor;\r\n    w.spawnInterval = 1.3 - 0.8 * tFactor;\r\n\r\n    // Parallax scrolling\r\n    w.parallax.skyShift += w.speed * 0.08 * dt;\r\n    w.parallax.cityShift += w.speed * 0.25 * dt;\r\n    w.parallax.hillShift += w.speed * 0.45 * dt;\r\n\r\n    // Avance mundo\r\n    w.worldX += w.speed * dt;\r\n\r\n    // FÃ­sica jugador\r\n    const p = w.player;\r\n    p.vy += w.gravity * dt;\r\n    p.y += p.vy * dt;\r\n    const groundY = w.groundY - p.h;\r\n    if (p.y >= groundY) { p.y = groundY; p.vy = 0; p.onGround = true; } else { p.onGround = false; }\r\n\r\n    // Spawn obstÃ¡culos\r\n    w.spawnTimer -= dt;\r\n    if (w.spawnTimer <= 0) {\r\n      spawnObstacle(w);\r\n      w.spawnTimer = w.spawnInterval * (0.9 + Math.random() * 0.4);\r\n    }\r\n\r\n    // Colisiones + puntuaciÃ³n\r\n    for (const o of w.obstacles) {\r\n      const sx = o.x - w.worldX + p.x;\r\n      o.screenX = sx;\r\n      if (!o.scored && sx + o.w < p.x) { o.scored = true; SCORE.current += 100; }\r\n      const collide = rectOverlap(p.x, p.y, p.w, p.h, sx, o.y, o.w, o.h);\r\n      if (collide) { setStatus('gameover'); break; }\r\n    }\r\n\r\n    // Limpiar\r\n    w.obstacles = w.obstacles.filter((o) => o.screenX > -140);\r\n    SCORE.current += Math.floor(w.speed * dt * 0.6);\r\n  };\r\n\r\n  const render = (ctx, canvas) => {\r\n    const w = WORLD.current;\r\n    const p = w.player;\r\n\r\n    // Asegurar capas\r\n    rebuildParallaxLayers();\r\n\r\n    // Fondo\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    if (status === 'intro') {\r\n      drawIntroBackground(ctx, canvas);\r\n      drawIntro(ctx, canvas, INTRO.current.lines, INTRO.current.offset);\r\n      drawSkipHint(ctx, canvas, 'Pulsa Enter para saltar');\r\n      return;\r\n    }\r\n\r\n    // Cielo (gradiente + nubes suaves)\r\n    drawSky(ctx, canvas, w.parallax.skyShift);\r\n    // Colinas y ciudad desde capas (tiled)\r\n    if (LAYERS.current.hills) drawLayerTiled(ctx, LAYERS.current.hills, w.parallax.hillShift);\r\n    if (LAYERS.current.city) drawLayerTiled(ctx, LAYERS.current.city, w.parallax.cityShift);\r\n\r\n    // Marca de agua narrativa sutil\r\n    const momentText = currentStoryMoment || STORY_MOMENTS.current[0].text;\r\n    if (BUFFERS.current.watermark) ctx.drawImage(BUFFERS.current.watermark, 0, 0);\r\n    else drawStoryWatermark(ctx, canvas, momentText);\r\n\r\n    // Suelo\r\n    ctx.fillStyle = '#bfe3ff';\r\n    ctx.fillRect(0, w.groundY + 12, canvas.width, 4);\r\n\r\n    // ObstÃ¡culos\r\n    for (const o of w.obstacles) {\r\n      if (o.screenX < -80 || o.screenX > canvas.width + 120) continue;\r\n      if (o.type === 'low') drawObstacleLow(ctx, o.screenX, o.y, o.w, o.h);\r\n      else drawObstacleHigh(ctx, o.screenX, o.y, o.w, o.h);\r\n    }\r\n\r\n    // Pareja (sticker conjunto)\r\n    drawCouple(ctx, p.x, p.y, p.w, p.h, !p.onGround, p.crouching);\r\n\r\n    // HUD\r\n    drawHUD(ctx, canvas, {\r\n      score: SCORE.current,\r\n      time: TIMELEFT.current,\r\n      status\r\n    });\r\n\r\n    // Banner de momento especial (animado)\r\n    if (STORY.current.bannerAlpha > 0) {\r\n      if (BUFFERS.current.banner) {\r\n        ctx.save();\r\n        ctx.globalAlpha = STORY.current.bannerAlpha;\r\n        const bx = (canvas.width - BUFFERS.current.banner.width) / 2;\r\n        const by = 6;\r\n        ctx.drawImage(BUFFERS.current.banner, bx, by);\r\n        ctx.restore();\r\n      } else {\r\n        drawStoryBanner(ctx, canvas, momentText, STORY.current.bannerAlpha);\r\n      }\r\n    }\r\n\r\n    if (status === 'paused') {\r\n      drawOverlay(ctx, canvas, 'Pausa â¸', 'Pulsa P para continuar');\r\n      return;\r\n    }\r\n\r\n    if (status === 'gameover') {\r\n      drawOverlay(ctx, canvas, 'Â¡Ups! Te has tropezado', 'Pulsa R para volver al menÃº');\r\n    } else if (status === 'win') {\r\n      drawOverlay(ctx, canvas, 'Â¡Llegaste a tiempo! ðŸ’’', `PuntuaciÃ³n: ${Math.floor(SCORE.current)} Â· Pulsa R para menÃº`);\r\n    }\r\n  };\r\n\r\n  const toggleMute = () => {\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) { audioEl.muted = !audioEl.muted; setMuted(audioEl.muted); }\r\n    else setMuted((m) => !m);\r\n  };\r\n\r\n  useEffect(() => () => {\r\n    const audioEl = document.getElementById('bg-music');\r\n    if (audioEl) audioEl.pause();\r\n  }, []);\r\n\r\n  return (\r\n    <div ref={containerRef} style={{ maxWidth: 980, margin: '0 auto', padding: '1rem', position: 'relative' }}>\r\n      <h2 style={{ textAlign: 'center', marginBottom: '.5rem' }}>Camino a la iglesia</h2>\r\n\r\n      {status === 'menu' && (\r\n        <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', background: 'linear-gradient(135deg, rgba(255,255,255,.95), rgba(238,242,255,.95))', zIndex: 5, borderRadius: 12 }}>\r\n          <div style={{ width: 'min(92%, 620px)', padding: '1.25rem', borderRadius: 12, boxShadow: '0 8px 28px rgba(0,0,0,.18)', background: 'white' }}>\r\n            <h3 style={{ marginTop: 0, textAlign: 'center' }}>Â¡AcompaÃ±a a Ana y Dani!</h3>\r\n            <p style={{ textAlign: 'center', color: '#64748b', marginTop: 4 }}>\r\n              Esquiva obstÃ¡culos durante 5 minutos. La historia de la pareja aparecerÃ¡ como momentos especiales cada 30s.\r\n            </p>\r\n            <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center', marginTop: '1rem' }}>\r\n              <button onClick={handlePlayFullscreen} style={primaryBtn}>â–¶ Jugar en pantalla completa</button>\r\n              <button onClick={() => { resetWorld(); startPlaying(); }} style={secondaryBtn}>â–· Jugar</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div style={{ borderRadius: 12, overflow: 'hidden', boxShadow: '0 6px 24px rgba(0,0,0,.12)', background: 'white', position: 'relative' }}>\r\n        <audio id=\"bg-music\" src=\"/musica-boda.mp3\" loop autoPlay={false} style={{ display: 'none' }} />\r\n        <button onClick={toggleMute} aria-label={muted ? 'Activar sonido' : 'Silenciar sonido'} style={{ position: 'absolute', right: 8, top: 8, zIndex: 8, background: 'rgba(0,0,0,.55)', color: '#fff', border: 0, borderRadius: 999, width: 36, height: 36, cursor: 'pointer' }}>{muted ? 'ðŸ”‡' : 'ðŸ”Š'}</button>\r\n        {(status === 'playing' || status === 'paused') && (\r\n          <button onClick={togglePause} style={{ position: 'absolute', right: 52, top: 8, zIndex: 8, background: 'rgba(0,0,0,.55)', color: '#fff', border: 0, borderRadius: 999, width: 36, height: 36, cursor: 'pointer' }}>{status === 'paused' ? 'â–¶' : 'â¸'}</button>\r\n        )}\r\n        {status === 'intro' && (\r\n          <button onClick={startPlaying} style={{ position: 'absolute', right: 8, bottom: 8, zIndex: 8, background: 'rgba(0,0,0,.55)', color: '#fff', border: 0, borderRadius: 8, padding: '.4rem .6rem', cursor: 'pointer' }}>Saltar intro</button>\r\n        )}\r\n        <canvas ref={canvasRef} width={900} height={280} style={{ width: '100%', display: 'block', background: status === 'intro' ? '#000' : 'linear-gradient(#eef2ff, #fff)' }} />\r\n\r\n        {/* Controles tÃ¡ctiles */}\r\n        {status === 'playing' && (\r\n          <div style={{ position: 'absolute', inset: 'auto 0 0 0', display: 'flex', justifyContent: 'space-between', padding: '8px 10px', pointerEvents: 'none' }}>\r\n            <button onMouseDown={jump} onTouchStart={jump} style={touchBtn}>â® Saltar</button>\r\n            <button onMouseDown={() => crouch(true)} onMouseUp={() => crouch(false)} onTouchStart={() => crouch(true)} onTouchEnd={() => crouch(false)} style={touchBtn}>â®Ÿ Agachar</button>\r\n          </div>\r\n        )}\r\n\r\n        {(status === 'gameover' || status === 'win') && (\r\n          <div style={{ position: 'absolute', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 7 }}>\r\n            <div style={{ background: 'rgba(17,24,39,.88)', color: '#fff', padding: '1rem 1.25rem', borderRadius: 12, boxShadow: '0 8px 28px rgba(0,0,0,.35)', textAlign: 'center' }}>\r\n              <div style={{ fontWeight: 700, fontSize: 18, marginBottom: 8 }}>\r\n                {status === 'win' ? 'Â¡Llegaste a tiempo! ðŸ’’' : 'Â¡Ups! Te has tropezado'}\r\n              </div>\r\n              <div style={{ fontSize: 14, opacity: .9, marginBottom: 12 }}>\r\n                PuntuaciÃ³n: {Math.floor(SCORE.current)}\r\n              </div>\r\n              <button onClick={handleRetry} style={{ background: '#22c55e', color: '#0b1a0f', border: 0, padding: '.5rem 1rem', borderRadius: 10, fontWeight: 700, cursor: 'pointer' }}>â†» Reintentar</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Estilos de botones\r\nconst primaryBtn = {\r\n  background: 'linear-gradient(135deg, #6366f1, #8b5cf6)',\r\n  color: 'white', border: 0, padding: '.75rem 1.25rem',\r\n  borderRadius: 10, fontWeight: 700, cursor: 'pointer',\r\n  boxShadow: '0 6px 18px rgba(99,102,241,.35)'\r\n};\r\nconst secondaryBtn = {\r\n  background: '#111827', color: 'white', border: 0,\r\n  padding: '.75rem 1.25rem', borderRadius: 10,\r\n  fontWeight: 700, cursor: 'pointer'\r\n};\r\nconst touchBtn = {\r\n  pointerEvents: 'auto',\r\n  background: 'rgba(0,0,0,.55)', color: '#fff', border: 0,\r\n  borderRadius: 10, padding: '.5rem .75rem', fontWeight: 700\r\n};\r\n\r\n// Utilidades\r\nfunction rectOverlap(ax, ay, aw, ah, bx, by, bw, bh) {\r\n  return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;\r\n}\r\nfunction formatTime(t) {\r\n  const s = Math.max(0, Math.floor(t));\r\n  const mm = String(Math.floor(s / 60)).padStart(2, '0');\r\n  const ss = String(s % 60).padStart(2, '0');\r\n  return `${mm}:${ss}`;\r\n}\r\nfunction wrapText(ctx, text, maxWidth) {\r\n  const words = text.split(' ');\r\n  let lines = [], current = '';\r\n  for (const w of words) {\r\n    const test = current ? current + ' ' + w : w;\r\n    if (ctx.measureText(test).width > maxWidth && current) { lines.push(current); current = w; }\r\n    else current = test;\r\n  }\r\n  if (current) lines.push(current);\r\n  return lines;\r\n}\r\n\r\nfunction spawnObstacle(w) {\r\n  const type = Math.random() < 0.55 ? 'low' : 'high';\r\n  if (type === 'low') {\r\n    const width = 28 + Math.random() * 18;\r\n    const height = 22 + Math.random() * 22;\r\n    const x = w.worldX + 900 + Math.random() * 120;\r\n    const y = w.groundY - height;\r\n    w.obstacles.push({ type, x, y, w: width, h: height, scored: false, screenX: 0 });\r\n  } else {\r\n    const width = 84 + Math.random() * 70;\r\n    const height = 18;\r\n    const x = w.worldX + 900 + Math.random() * 120;\r\n    const y = w.groundY - (48 + 12);\r\n    w.obstacles.push({ type, x, y, w: width, h: height, scored: false, screenX: 0 });\r\n  }\r\n}\r\n\r\n// Dibujo UI\r\nfunction drawHUD(ctx, canvas, { score, time, status }) {\r\n  ctx.save();\r\n  // Barra superior\r\n  ctx.globalAlpha = 0.9;\r\n  ctx.fillStyle = 'rgba(255,255,255,0.9)';\r\n  roundRect(ctx, 8, 8, canvas.width - 16, 34, 8);\r\n  ctx.fill();\r\n\r\n  // PuntuaciÃ³n\r\n  ctx.fillStyle = '#334155';\r\n  ctx.font = 'bold 12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'left';\r\n  ctx.fillText(`Puntos: ${Math.floor(score)}`, 16, 30);\r\n\r\n  // Tiempo restante + barra\r\n  ctx.textAlign = 'right';\r\n  ctx.fillText(`Tiempo: ${formatTime(time)}`, canvas.width - 16, 30);\r\n  const pct = Math.max(0, Math.min(1, time / 300));\r\n  const barW = (canvas.width - 16) * pct;\r\n  ctx.globalAlpha = 1;\r\n  ctx.fillStyle = '#22c55e';\r\n  roundRect(ctx, 8, 46, barW, 6, 3);\r\n  ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawIntroBackground(ctx, canvas) {\r\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n  g.addColorStop(0, '#000');\r\n  g.addColorStop(1, '#1f2937');\r\n  ctx.fillStyle = g;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n}\r\n\r\nfunction drawIntro(ctx, canvas, lines, offset) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#10b981';\r\n  ctx.textAlign = 'center';\r\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  const centerX = canvas.width / 2;\r\n  let y = canvas.height + offset;\r\n  for (let i = 0; i < lines.length; i++) {\r\n    const line = lines[i];\r\n    const scale = 1 - i * 0.05;\r\n    ctx.save();\r\n    ctx.translate(centerX, y);\r\n    ctx.scale(scale, scale);\r\n    ctx.fillText(line, 0, 0);\r\n    ctx.restore();\r\n    y += 36;\r\n  }\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawSkipHint(ctx, canvas, text) {\r\n  ctx.save();\r\n  ctx.fillStyle = 'rgba(255,255,255,0.2)';\r\n  roundRect(ctx, canvas.width - 165, canvas.height - 36, 156, 26, 8);\r\n  ctx.fill();\r\n  ctx.fillStyle = '#e5e7eb';\r\n  ctx.font = '12px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'right';\r\n  ctx.fillText(text, canvas.width - 12, canvas.height - 18);\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawSky(ctx, canvas, shift) {\r\n  const g = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n  g.addColorStop(0, '#e8f0ff');\r\n  g.addColorStop(1, '#ffffff');\r\n  ctx.fillStyle = g;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  // nubes suaves\r\n  ctx.save();\r\n  ctx.globalAlpha = 0.25;\r\n  ctx.fillStyle = '#ffffff';\r\n  for (let i = 0; i < 6; i++) {\r\n    const x = ((i * 180 - (shift * 0.3) % (canvas.width + 200)) + canvas.width + 200) % (canvas.width + 200) - 100;\r\n    ctx.beginPath();\r\n    ctx.ellipse(x, 60 + (i % 2) * 18, 70, 20, 0, 0, Math.PI * 2);\r\n    ctx.fill();\r\n  }\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawCity(ctx, canvas, shift) { /* deprecated by prerendered layers */ }\r\n\r\nfunction drawHills(ctx, canvas, shift) { /* deprecated by prerendered layers */ }\r\n\r\nfunction drawLayerTiled(ctx, layerCanvas, shift) {\r\n  const w = layerCanvas.width;\r\n  let offset = - (shift % w);\r\n  if (offset > 0) offset -= w;\r\n  ctx.drawImage(layerCanvas, offset, 0);\r\n  ctx.drawImage(layerCanvas, offset + w, 0);\r\n}\r\n\r\nfunction drawObstacleLow(ctx, x, y, w, h) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#94a3b8';\r\n  ctx.strokeStyle = '#475569';\r\n  ctx.lineWidth = 2;\r\n  roundRect(ctx, x, y, w, h, 6);\r\n  ctx.fill();\r\n  ctx.stroke();\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawObstacleHigh(ctx, x, y, w, h) {\r\n  ctx.save();\r\n  ctx.fillStyle = '#9ca3af';\r\n  roundRect(ctx, x, y + h - 30, 4, 30, 2);\r\n  roundRect(ctx, x + w - 4, y + h - 30, 4, 30, 2);\r\n  ctx.fill();\r\n  ctx.fillStyle = '#22c55e';\r\n  roundRect(ctx, x, y, w, h, 6);\r\n  ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\n// Sticker conjunto: novio + novia cogidos de la mano\r\nfunction drawCouple(ctx, x, y, w, h, jumping, crouching) {\r\n  ctx.save();\r\n  // Sombra\r\n  if (jumping) {\r\n    ctx.globalAlpha = 0.2;\r\n    ctx.fillStyle = '#000';\r\n    ctx.beginPath();\r\n    ctx.ellipse(x + w * 0.5, y + h + 10, w * 0.7, 5, 0, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.globalAlpha = 1;\r\n  }\r\n\r\n  // Novia (izquierda)\r\n  const nx = x - 16; const ny = y; const nw = Math.floor(w * 0.48); const nh = h;\r\n  ctx.fillStyle = '#f8fafc';\r\n  roundRect(ctx, nx - 2, ny + nh * 0.35, nw + 4, nh * 0.65, 10); // vestido\r\n  ctx.fill();\r\n  ctx.fillStyle = '#e5e7eb';\r\n  roundRect(ctx, nx, ny, nw, nh * 0.45, 8); // torso\r\n  ctx.fill();\r\n  ctx.fillStyle = '#fde68a';\r\n  ctx.beginPath();\r\n  ctx.arc(nx + nw / 2, crouching ? ny - 4 : ny - 6, 10, 0, Math.PI * 2); // cabeza\r\n  ctx.fill();\r\n  // velo\r\n  ctx.globalAlpha = 0.6; ctx.fillStyle = '#e0f2fe'; roundRect(ctx, nx - 6, ny - 6, nw + 12, 16, 8); ctx.fill(); ctx.globalAlpha = 1;\r\n\r\n  // Novio (derecha)\r\n  const gx = x + nw - 4; const gy = y; const gw = Math.floor(w * 0.52); const gh = h;\r\n  ctx.fillStyle = '#1f2937'; roundRect(ctx, gx, gy, gw, gh, 8); ctx.fill(); // traje\r\n  ctx.fillStyle = '#fde68a'; ctx.beginPath(); ctx.arc(gx + gw / 2, crouching ? gy - 4 : gy - 6, 10, 0, Math.PI * 2); ctx.fill(); // cabeza\r\n  ctx.fillStyle = '#ef4444'; ctx.fillRect(gx + gw / 2 - 3, gy + 10, 6, 10); // corbata\r\n\r\n  // Manos unidas (corazÃ³n pequeÃ±o)\r\n  ctx.fillStyle = '#ef4444';\r\n  ctx.beginPath();\r\n  const mx = gx - 4; const my = y + h * 0.48;\r\n  ctx.arc(mx - 3, my, 3, 0, Math.PI * 2);\r\n  ctx.arc(mx + 3, my, 3, 0, Math.PI * 2);\r\n  ctx.moveTo(mx - 6, my); ctx.lineTo(mx, my + 6); ctx.lineTo(mx + 6, my);\r\n  ctx.fill();\r\n\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawStoryWatermark(ctx, canvas, momentText) {\r\n  ctx.save();\r\n  ctx.globalAlpha = 0.12;\r\n  const gradient = ctx.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width * 0.9);\r\n  gradient.addColorStop(0, '#fbbf24');\r\n  gradient.addColorStop(0.5, '#f59e0b');\r\n  gradient.addColorStop(1, 'transparent');\r\n  ctx.fillStyle = gradient;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n  // Texto grande sutil\r\n  ctx.globalAlpha = 0.22;\r\n  ctx.fillStyle = '#92400e';\r\n  ctx.font = 'bold 34px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n\r\n  const words = momentText.split(' ');\r\n  let lines = []; let currentLine = '';\r\n  for (const word of words) {\r\n    const test = currentLine + (currentLine ? ' ' : '') + word;\r\n    if (ctx.measureText(test).width > canvas.width * 0.7 && currentLine) { lines.push(currentLine); currentLine = word; }\r\n    else currentLine = test;\r\n  }\r\n  if (currentLine) lines.push(currentLine);\r\n\r\n  const lineHeight = 40;\r\n  const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;\r\n  for (let i = 0; i < lines.length; i++) ctx.fillText(lines[i], canvas.width / 2, startY + i * lineHeight);\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawStoryBanner(ctx, canvas, text, alpha) {\r\n  ctx.save();\r\n  ctx.globalAlpha = Math.max(0, Math.min(1, alpha));\r\n  ctx.fillStyle = 'rgba(251, 191, 36, 0.95)';\r\n  const padding = 12;\r\n  ctx.font = 'bold 14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  const textW = ctx.measureText(text).width;\r\n  const boxW = Math.min(canvas.width - 24, textW + padding * 2 + 40);\r\n  const boxH = 42;\r\n  const boxX = (canvas.width - boxW) / 2;\r\n  const boxY = 6; // elevado\r\n  roundRect(ctx, boxX, boxY, boxW, boxH, 10);\r\n  ctx.fill();\r\n  ctx.strokeStyle = '#d97706'; ctx.lineWidth = 2; ctx.stroke();\r\n  ctx.fillStyle = '#92400e';\r\n  ctx.textAlign = 'center'; ctx.textBaseline = 'middle';\r\n  ctx.fillText('ðŸ’• ' + text + ' ðŸ’•', canvas.width / 2, boxY + boxH / 2);\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawOverlay(ctx, canvas, title, subtitle) {\r\n  ctx.save();\r\n  ctx.fillStyle = 'rgba(0,0,0,0.45)';\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  ctx.fillStyle = '#fff';\r\n  ctx.font = 'bold 22px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.textAlign = 'center';\r\n  ctx.fillText(title, canvas.width / 2, canvas.height / 2 - 6);\r\n  ctx.font = '14px Inter, system-ui, -apple-system, Segoe UI, Roboto';\r\n  ctx.fillText(subtitle, canvas.width / 2, canvas.height / 2 + 18);\r\n  ctx.restore();\r\n}\r\n\r\nfunction roundRect(ctx, x, y, w, h, r) {\r\n  ctx.beginPath();\r\n  ctx.moveTo(x + r, y);\r\n  ctx.arcTo(x + w, y, x + w, y + h, r);\r\n  ctx.arcTo(x + w, y + h, x, y + h, r);\r\n  ctx.arcTo(x, y + h, x, y, r);\r\n  ctx.arcTo(x, y, x + w, y, r);\r\n  ctx.closePath();\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}